/*! For license information please see pushly-sdk.min.js.LICENSE */
(()=>{var t={"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[1].use[1]!./node_modules/sass-loader/dist/cjs.js!./src/sdk/styles/app.scss":(s,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>n});var e=t("./node_modules/css-loader/dist/runtime/sourceMaps.js"),e=t.n(e),o=t("./node_modules/css-loader/dist/runtime/api.js"),t=t.n(o)()(e());t.push([s.id,"@media print {\n  .pushly-prompt-window,\n  .pushly_popover {\n    display: none !important;\n  }\n}\n.pushly-prompt-window,\n.pushly_popover {\n  left: 0;\n  right: 0;\n  pointer-events: none;\n  /* theme: normal */\n  /* theme: stacked */\n  /* desktop positioning */\n  /* mobile positioning */\n}\n.pushly-prompt-window:not(.managed),\n.pushly_popover:not(.managed) {\n  position: fixed;\n  z-index: 1000000;\n  transition: all 0.5s ease;\n}\n.pushly-prompt-window .pushly-prompt-slide,\n.pushly-prompt-window .pushly_popover-box,\n.pushly_popover .pushly-prompt-slide,\n.pushly_popover .pushly_popover-box {\n  pointer-events: all;\n  margin: 0px auto;\n  box-sizing: border-box;\n  display: flex;\n  width: 400px;\n  padding: 16px;\n}\n.pushly-prompt-window .pushly-prompt-slide.pushly-prompt-visible,\n.pushly-prompt-window .pushly_popover-box.pushly-prompt-visible,\n.pushly_popover .pushly-prompt-slide.pushly-prompt-visible,\n.pushly_popover .pushly_popover-box.pushly-prompt-visible {\n  top: 0;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-icon,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-first,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-icon,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-first,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-icon,\n.pushly_popover .pushly-prompt-slide .pushly_popover-first,\n.pushly_popover .pushly_popover-box .pushly-prompt-icon,\n.pushly_popover .pushly_popover-box .pushly_popover-first {\n  position: relative;\n  max-width: 80px;\n  height: 80px;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-icon img,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-first img,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-icon img,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-first img,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-icon img,\n.pushly_popover .pushly-prompt-slide .pushly_popover-first img,\n.pushly_popover .pushly_popover-box .pushly-prompt-icon img,\n.pushly_popover .pushly_popover-box .pushly_popover-first img {\n  width: 100%;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second,\n.pushly_popover .pushly_popover-box .pushly-prompt-content,\n.pushly_popover .pushly_popover-box .pushly_popover-second {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline {\n  font-size: 1em;\n  padding-top: 8px;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly_popover-message-subheadline {\n  font-size: 0.8em;\n  padding-top: 12px;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-actions,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly_popover-buttons,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly-prompt-actions,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly_popover-buttons,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly-prompt-actions,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly_popover-buttons,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly-prompt-actions,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly_popover-buttons,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-actions,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly_popover-buttons,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly-prompt-actions,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly_popover-buttons,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly-prompt-actions,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly_popover-buttons,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly-prompt-actions,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly_popover-buttons {\n  margin-top: 16px;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-actions button,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly_popover-buttons button,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly-prompt-actions button,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly_popover-buttons button,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly-prompt-actions button,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly_popover-buttons button,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly-prompt-actions button,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly_popover-buttons button,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-actions button,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly_popover-buttons button,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly-prompt-actions button,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly_popover-buttons button,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly-prompt-actions button,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly_popover-buttons button,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly-prompt-actions button,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly_popover-buttons button {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 16px;\n  padding-right: 16px;\n  border: none;\n  font-size: 0.8em;\n  border-radius: 3px;\n  background: none;\n  cursor: pointer;\n}\n.pushly-prompt-window.normal .pushly-prompt-slide,\n.pushly-prompt-window.normal .pushly_popover-box,\n.pushly_popover.normal .pushly-prompt-slide,\n.pushly_popover.normal .pushly_popover-box {\n  flex-direction: row;\n  justify-content: space-between;\n}\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second {\n  width: calc(100% - 80px);\n  padding-left: 16px;\n}\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline:first-child {\n  padding-top: 0 !important;\n}\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-actions,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content .pushly_popover-buttons,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second .pushly-prompt-actions,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second .pushly_popover-buttons,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content .pushly-prompt-actions,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content .pushly_popover-buttons,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second .pushly-prompt-actions,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second .pushly_popover-buttons,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-actions,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content .pushly_popover-buttons,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second .pushly-prompt-actions,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second .pushly_popover-buttons,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content .pushly-prompt-actions,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content .pushly_popover-buttons,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second .pushly-prompt-actions,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second .pushly_popover-buttons {\n  display: flex;\n  justify-content: flex-end;\n}\n.pushly-prompt-window.stacked .pushly-prompt-slide,\n.pushly-prompt-window.stacked .pushly_popover-box,\n.pushly_popover.stacked .pushly-prompt-slide,\n.pushly_popover.stacked .pushly_popover-box {\n  text-align: center;\n  flex-direction: column;\n  align-content: center;\n  align-items: center;\n}\n@media screen and (min-width: 768px) {\n  .pushly-prompt-window.d-top,\n  .pushly_popover.d-top {\n    top: -600px;\n    bottom: auto;\n  }\n  .pushly-prompt-window.d-top .pushly-prompt-slide,\n  .pushly-prompt-window.d-top .pushly_popover-box,\n  .pushly_popover.d-top .pushly-prompt-slide,\n  .pushly_popover.d-top .pushly_popover-box {\n    box-shadow: 0px 1px 1px #bbb;\n  }\n  .pushly-prompt-window.d-top.pushly-prompt-visible,\n  .pushly_popover.d-top.pushly-prompt-visible {\n    top: 0;\n  }\n  .pushly-prompt-window.d-bottom,\n  .pushly_popover.d-bottom {\n    bottom: -600px;\n    top: auto;\n  }\n  .pushly-prompt-window.d-bottom .pushly-prompt-slide,\n  .pushly-prompt-window.d-bottom .pushly_popover-box,\n  .pushly_popover.d-bottom .pushly-prompt-slide,\n  .pushly_popover.d-bottom .pushly_popover-box {\n    box-shadow: 0px -1px 1px #bbb;\n  }\n  .pushly-prompt-window.d-bottom.pushly-prompt-visible,\n  .pushly_popover.d-bottom.pushly-prompt-visible {\n    bottom: 0;\n  }\n  .pushly-prompt-window.d-disabled,\n  .pushly_popover.d-disabled {\n    display: none;\n  }\n}\n@media screen and (max-width: 768px) {\n  .pushly-prompt-window.m-top,\n  .pushly_popover.m-top {\n    top: -600px;\n    bottom: auto;\n  }\n  .pushly-prompt-window.m-top .pushly-prompt-slide,\n  .pushly-prompt-window.m-top .pushly_popover-box,\n  .pushly_popover.m-top .pushly-prompt-slide,\n  .pushly_popover.m-top .pushly_popover-box {\n    box-shadow: 0px 1px 1px #bbb;\n  }\n  .pushly-prompt-window.m-top.pushly-prompt-visible,\n  .pushly_popover.m-top.pushly-prompt-visible {\n    top: 0;\n  }\n  .pushly-prompt-window.m-bottom,\n  .pushly_popover.m-bottom {\n    bottom: -600px;\n    top: auto;\n  }\n  .pushly-prompt-window.m-bottom .pushly-prompt-slide,\n  .pushly-prompt-window.m-bottom .pushly_popover-box,\n  .pushly_popover.m-bottom .pushly-prompt-slide,\n  .pushly_popover.m-bottom .pushly_popover-box {\n    box-shadow: 0px -1px 1px #bbb;\n  }\n  .pushly-prompt-window.m-bottom.pushly-prompt-visible,\n  .pushly_popover.m-bottom.pushly-prompt-visible {\n    bottom: 0;\n  }\n  .pushly-prompt-window.m-disabled,\n  .pushly_popover.m-disabled {\n    display: none;\n  }\n}\n@media screen and (max-width: 480px) {\n  .pushly-prompt-window .pushly-prompt-slide,\n  .pushly-prompt-window .pushly_popover-box,\n  .pushly_popover .pushly-prompt-slide,\n  .pushly_popover .pushly_popover-box {\n    width: 100%;\n  }\n  .pushly-prompt-window .pushly-prompt-slide .pushly-prompt-icon,\n  .pushly-prompt-window .pushly-prompt-slide .pushly_popover-first,\n  .pushly-prompt-window .pushly_popover-box .pushly-prompt-icon,\n  .pushly-prompt-window .pushly_popover-box .pushly_popover-first,\n  .pushly_popover .pushly-prompt-slide .pushly-prompt-icon,\n  .pushly_popover .pushly-prompt-slide .pushly_popover-first,\n  .pushly_popover .pushly_popover-box .pushly-prompt-icon,\n  .pushly_popover .pushly_popover-box .pushly_popover-first {\n    max-width: calc(80px - 20px);\n    height: calc(80px - 20px);\n  }\n  .pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content,\n  .pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second,\n  .pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content,\n  .pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second,\n  .pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content,\n  .pushly_popover.normal .pushly-prompt-slide .pushly_popover-second,\n  .pushly_popover.normal .pushly_popover-box .pushly-prompt-content,\n  .pushly_popover.normal .pushly_popover-box .pushly_popover-second {\n    width: calc(100% - 80px + 20px);\n  }\n  .pushly-prompt-window.m-disabled,\n  .pushly_popover.m-disabled {\n    display: none;\n  }\n}\n\n@media print {\n  .pushly_bell {\n    display: none !important;\n  }\n}\n.pushly_bell {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  /* desktop positioning */\n  /* mobile positioning */\n}\n.pushly_bell:not(.managed) {\n  position: fixed;\n  z-index: 1000000;\n  transition: all 0.5s ease;\n}\n.pushly_bell.subscribed .pushly_bell-tooltip-notsubscribed {\n  display: none;\n}\n.pushly_bell.subscribed svg {\n  opacity: 0.7;\n}\n.pushly_bell:not(.subscribed) .pushly_bell-tooltip-subscribed {\n  display: none;\n}\n.pushly_bell.hover svg {\n  opacity: 0.7;\n}\n.pushly_bell.hover .pushly_bell-tooltip {\n  opacity: 1;\n}\n.pushly_bell svg {\n  z-index: 1;\n  transition: all 0.5s ease;\n  box-shadow: 0px 1px 3px #888;\n  border-radius: 1000px;\n  cursor: pointer;\n}\n.pushly_bell .pushly_bell-tooltip {\n  transition: all 0.5s ease;\n  position: relative;\n  opacity: 0;\n  pointer-events: none;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin-right: 7.5px;\n  margin-left: 7.5px;\n}\n.pushly_bell .pushly_bell-tooltip .pushly_bell-tooltip-text {\n  padding: 8px 16px;\n  border-radius: 3px;\n  font-size: 13px;\n}\n.pushly_bell .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n  position: relative;\n  width: 15px;\n  height: 15px;\n  border-radius: 1px;\n  transform: rotate(45deg);\n}\n@media screen and (min-width: 768px) {\n  .pushly_bell.d-top-left {\n    top: 40px;\n    left: -200px;\n  }\n  .pushly_bell.d-top-left.hover .pushly_bell-tooltip {\n    left: 0;\n  }\n  .pushly_bell.d-top-left .pushly_bell-tooltip {\n    left: -30px;\n  }\n  .pushly_bell.d-top-left .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    left: 7.5px;\n  }\n  .pushly_bell.d-top-left.pushly-prompt-visible {\n    left: 40px;\n  }\n  .pushly_bell.d-top-right {\n    top: 40px;\n    right: -200px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.d-top-right.hover .pushly_bell-tooltip {\n    right: 0;\n  }\n  .pushly_bell.d-top-right .pushly_bell-tooltip {\n    right: -30px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.d-top-right .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    right: 7.5px;\n  }\n  .pushly_bell.d-top-right.pushly-prompt-visible {\n    right: 40px;\n  }\n  .pushly_bell.d-bottom-left {\n    bottom: 40px;\n    left: -200px;\n  }\n  .pushly_bell.d-bottom-left.hover .pushly_bell-tooltip {\n    left: 0;\n  }\n  .pushly_bell.d-bottom-left .pushly_bell-tooltip {\n    left: -30px;\n  }\n  .pushly_bell.d-bottom-left .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    left: 7.5px;\n  }\n  .pushly_bell.d-bottom-left.pushly-prompt-visible {\n    left: 40px;\n  }\n  .pushly_bell.d-bottom-right {\n    bottom: 40px;\n    right: -200px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.d-bottom-right.hover .pushly_bell-tooltip {\n    right: 0;\n  }\n  .pushly_bell.d-bottom-right .pushly_bell-tooltip {\n    right: -30px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.d-bottom-right .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    right: 7.5px;\n  }\n  .pushly_bell.d-bottom-right.pushly-prompt-visible {\n    right: 40px;\n  }\n  .pushly_bell.d-disabled {\n    display: none;\n  }\n}\n@media screen and (max-width: 768px) {\n  .pushly_bell.m-top-left {\n    top: 40px;\n    left: -200px;\n  }\n  .pushly_bell.m-top-left.hover .pushly_bell-tooltip {\n    left: 0;\n  }\n  .pushly_bell.m-top-left .pushly_bell-tooltip {\n    left: -30px;\n  }\n  .pushly_bell.m-top-left .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    left: 7.5px;\n  }\n  .pushly_bell.m-top-left.pushly-prompt-visible {\n    left: 40px;\n  }\n  .pushly_bell.m-top-right {\n    top: 40px;\n    right: -200px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.m-top-right.hover .pushly_bell-tooltip {\n    right: 0;\n  }\n  .pushly_bell.m-top-right .pushly_bell-tooltip {\n    right: -30px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.m-top-right .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    right: 7.5px;\n  }\n  .pushly_bell.m-top-right.pushly-prompt-visible {\n    right: 40px;\n  }\n  .pushly_bell.m-bottom-left {\n    bottom: 40px;\n    left: -200px;\n  }\n  .pushly_bell.m-bottom-left.hover .pushly_bell-tooltip {\n    left: 0;\n  }\n  .pushly_bell.m-bottom-left .pushly_bell-tooltip {\n    left: -30px;\n  }\n  .pushly_bell.m-bottom-left .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    left: 7.5px;\n  }\n  .pushly_bell.m-bottom-left.pushly-prompt-visible {\n    left: 40px;\n  }\n  .pushly_bell.m-bottom-right {\n    bottom: 40px;\n    right: -200px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.m-bottom-right.hover .pushly_bell-tooltip {\n    right: 0;\n  }\n  .pushly_bell.m-bottom-right .pushly_bell-tooltip {\n    right: -30px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.m-bottom-right .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    right: 7.5px;\n  }\n  .pushly_bell.m-bottom-right.pushly-prompt-visible {\n    right: 40px;\n  }\n  .pushly_bell.m-disabled {\n    display: none;\n  }\n}","",{version:3,sources:["webpack://./src/sdk/styles/popover.scss","webpack://./src/sdk/styles/app.scss","webpack://./src/sdk/styles/bell.scss"],names:[],mappings:"AAMA;EACI;;IAEI,wBAAA;ECLN;AACF;ADQA;;EAQI,OAAA;EACA,QAAA;EACA,oBAAA;EAkEA,kBAAA;EAiCA,mBAAA;EAYA,wBAAA;EAoCA,uBAAA;AC3JJ;ADAI;;EACI,eAAA;EACA,gBAAA;EACA,yBAAA;ACGR;ADII;;;;EAEI,mBAAA;EACA,gBAAA;EACA,sBAAA;EACA,aAAA;EACA,YA7BA;EA8BA,aA5BE;AC4BV;ADEQ;;;;EACI,MAAA;ACGZ;ADAQ;;;;;;;;EAEI,kBAAA;EACA,eAtCA;EAuCA,YAvCA;AC+CZ;ADNY;;;;;;;;EACI,WAAA;ACehB;ADXQ;;;;;;;;EAEI,aAAA;EACA,sBAAA;EACA,8BAAA;ACmBZ;ADfgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAEI,cAAA;EACA,gBAAA;AC+CpB;AD5CgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAEI,gBAAA;EACA,iBAAA;AC4EpB;ADxEY;;;;;;;;;;;;;;;;EAEI,gBApEN;AC4JV;ADtFgB;;;;;;;;;;;;;;;;EACI,gBAAA;EACA,mBAAA;EACA,kBAAA;EACA,mBAAA;EACA,YAAA;EACA,gBAAA;EACA,kBAAA;EACA,gBAAA;EACA,eAAA;ACuGpB;AD9FQ;;;;EAEI,mBAAA;EACA,8BAAA;ACkGZ;ADhGY;;;;;;;;EAGI,wBAAA;EACA,kBAjGN;ACwMV;ADjGwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EACI,yBAAA;ACkI5B;AD7HgB;;;;;;;;;;;;;;;;EAEI,aAAA;EACA,yBAAA;AC6IpB;ADpIQ;;;;EAEI,kBAAA;EACA,sBAAA;EACA,qBAAA;EACA,mBAAA;ACwIZ;ADlII;EACI;;IACI,WAAA;IACA,YAAA;ECqIV;EDnIU;;;;IAEI,4BAAA;ECuId;EDpIU;;IACI,MAAA;ECuId;EDnIM;;IACI,cAAA;IACA,SAAA;ECsIV;EDpIU;;;;IAEI,6BAAA;ECwId;EDrIU;;IACI,SAAA;ECwId;EDpIM;;IACI,aAAA;ECuIV;AACF;ADlII;EACI;;IACI,WAAA;IACA,YAAA;ECqIV;EDnIU;;;;IAEI,4BAAA;ECuId;EDpIU;;IACI,MAAA;ECuId;EDnIM;;IACI,cAAA;IACA,SAAA;ECsIV;EDpIU;;;;IAEI,6BAAA;ECwId;EDrIU;;IACI,SAAA;ECwId;EDpIM;;IACI,aAAA;ECuIV;AACF;ADpII;EACI;;;;IAEI,WAAA;ECwIV;EDtIU;;;;;;;;IAEI,4BAAA;IACA,yBAAA;EC8Id;EDvIc;;;;;;;;IAEI,+BAAA;EC+IlB;ED1IM;;IACI,aAAA;EC6IV;AACF;;AC9WA;EACI;IACI,wBAAA;EDiXN;AACF;AC9WA;EACI,aAAA;EACA,mBAAA;EACA,mBAAA;EA4EA,wBAAA;EA0GA,uBAAA;AD4LJ;AChXI;EACI,eAAA;EACA,gBAAA;EACA,yBAAA;ADkXR;AC9WQ;EACI,aAAA;ADgXZ;AC7WQ;EACI,YAAA;AD+WZ;AC1WQ;EACI,aAAA;AD4WZ;ACvWQ;EACI,YAAA;ADyWZ;ACtWQ;EACI,UAAA;ADwWZ;ACpWI;EACI,UAAA;EACA,yBAAA;EACA,4BAAA;EACA,qBAAA;EACA,eAAA;ADsWR;ACnWI;EACI,yBAAA;EAEA,kBAAA;EAEA,UAAA;EACA,oBAAA;EAEA,aAAA;EACA,mBAAA;EACA,mBAAA;EAEA,mBAAA;EACA,kBAAA;ADiWR;AC/VQ;EACI,iBAAA;EACA,kBAAA;EAEA,eAAA;ADgWZ;AC7VQ;EACI,kBAAA;EAEA,WA/EA;EAgFA,YAhFA;EAkFA,kBAAA;EAEA,wBAAA;AD4VZ;ACtVI;EACI;IACI,SAAA;IACA,YAAA;EDwVV;ECrVc;IACI,OAAA;EDuVlB;ECnVU;IACI,WAAA;EDqVd;ECnVc;IACI,WAAA;EDqVlB;ECjVU;IACI,UAAA;EDmVd;EC/UM;IACI,SAAA;IACA,aAAA;IAEA,2BAAA;EDgVV;EC7Uc;IACI,QAAA;ED+UlB;EC3UU;IACI,YAAA;IACA,2BAAA;ED6Ud;EC3Uc;IACI,YAAA;ED6UlB;ECzUU;IACI,WAAA;ED2Ud;ECvUM;IACI,YAAA;IACA,YAAA;EDyUV;ECtUc;IACI,OAAA;EDwUlB;ECpUU;IACI,WAAA;EDsUd;ECpUc;IACI,WAAA;EDsUlB;EClUU;IACI,UAAA;EDoUd;EChUM;IACI,YAAA;IACA,aAAA;IAEA,2BAAA;EDiUV;EC9Tc;IACI,QAAA;EDgUlB;EC5TU;IACI,YAAA;IACA,2BAAA;ED8Td;EC5Tc;IACI,YAAA;ED8TlB;EC1TU;IACI,WAAA;ED4Td;ECxTM;IACI,aAAA;ED0TV;AACF;ACrTI;EACI;IACI,SAAA;IACA,YAAA;EDuTV;ECpTc;IACI,OAAA;EDsTlB;EClTU;IACI,WAAA;EDoTd;EClTc;IACI,WAAA;EDoTlB;EChTU;IACI,UAAA;EDkTd;EC9SM;IACI,SAAA;IACA,aAAA;IAEA,2BAAA;ED+SV;EC5Sc;IACI,QAAA;ED8SlB;EC1SU;IACI,YAAA;IACA,2BAAA;ED4Sd;EC1Sc;IACI,YAAA;ED4SlB;ECxSU;IACI,WAAA;ED0Sd;ECtSM;IACI,YAAA;IACA,YAAA;EDwSV;ECrSc;IACI,OAAA;EDuSlB;ECnSU;IACI,WAAA;EDqSd;ECnSc;IACI,WAAA;EDqSlB;ECjSU;IACI,UAAA;EDmSd;EC/RM;IACI,YAAA;IACA,aAAA;IAEA,2BAAA;EDgSV;EC7Rc;IACI,QAAA;ED+RlB;EC3RU;IACI,YAAA;IACA,2BAAA;ED6Rd;EC3Rc;IACI,YAAA;ED6RlB;ECzRU;IACI,WAAA;ED2Rd;ECvRM;IACI,aAAA;EDyRV;AACF",sourcesContent:['@import "variables";\n\n$width: 400px;\n$imageSize: 80px;\n$padding: 16px;\n\n@media print {\n    .pushly-prompt-window,\n    .pushly_popover {\n        display: none !important;\n    }\n}\n\n.pushly-prompt-window,\n.pushly_popover {\n    &:not(.managed) {\n        position: fixed;\n        z-index: 1000000;\n        transition: all 0.5s ease;\n    }\n\n    left: 0;\n    right: 0;\n    pointer-events: none;\n\n    .pushly-prompt-slide,\n    .pushly_popover-box {\n        pointer-events: all;\n        margin: 0px auto;\n        box-sizing: border-box;\n        display: flex;\n        width: $width;\n        padding: $padding;\n\n        &.pushly-prompt-visible {\n            top: 0;\n        }\n\n        .pushly-prompt-icon,\n        .pushly_popover-first {\n            position: relative;\n            max-width: $imageSize;\n            height: $imageSize;\n\n            img {\n                width: 100%;\n            }\n        }\n\n        .pushly-prompt-content,\n        .pushly_popover-second {\n            display: flex;\n            flex-direction: column;\n            justify-content: space-between;\n\n            .pushly-prompt-message,\n            .pushly_popover-message {\n                .pushly-prompt-message-headline,\n                .pushly_popover-message-headline {\n                    font-size: 1em;\n                    padding-top: 8px;\n                }\n\n                .pushly-prompt-message-subheadline,\n                .pushly_popover-message-subheadline {\n                    font-size: 0.8em;\n                    padding-top: 12px;\n                }\n            }\n\n            .pushly-prompt-actions,\n            .pushly_popover-buttons {\n                margin-top: $padding;\n\n                button {\n                    padding-top: 8px;\n                    padding-bottom: 8px;\n                    padding-left: 16px;\n                    padding-right: 16px;\n                    border: none;\n                    font-size: 0.8em;\n                    border-radius: 3px;\n                    background: none;\n                    cursor: pointer;\n                }\n            }\n        }\n    }\n\n    /* theme: normal */\n\n    &.normal {\n        .pushly-prompt-slide,\n        .pushly_popover-box {\n            flex-direction: row;\n            justify-content: space-between;\n\n            .pushly-prompt-content,\n            .pushly_popover-second {\n                //width: calc(#{$width} - #{$imageSize} - #{$padding*3});\n                width: calc(100% - #{$imageSize});\n                padding-left: $padding;\n\n                .pushly-prompt-message,\n                .pushly_popover-message {\n                    .pushly-prompt-message-headline,\n                    .pushly_popover-message-headline {\n                        &:first-child {\n                            padding-top: 0 !important;\n                        }\n                    }\n                }\n\n                .pushly-prompt-actions,\n                .pushly_popover-buttons {\n                    display: flex;\n                    justify-content: flex-end;\n                }\n            }\n        }\n    }\n\n    /* theme: stacked */\n\n    &.stacked {\n        .pushly-prompt-slide,\n        .pushly_popover-box {\n            text-align: center;\n            flex-direction: column;\n            align-content: center;\n            align-items: center;\n        }\n    }\n\n    /* desktop positioning */\n\n    @media screen and (min-width: $mobile-max-size) {\n        &.d-top {\n            top: -600px;\n            bottom: auto;\n\n            .pushly-prompt-slide,\n            .pushly_popover-box {\n                box-shadow: 0px 1px 1px #bbb;\n            }\n\n            &.pushly-prompt-visible {\n                top: 0;\n            }\n        }\n\n        &.d-bottom {\n            bottom: -600px;\n            top: auto;\n\n            .pushly-prompt-slide,\n            .pushly_popover-box {\n                box-shadow: 0px -1px 1px #bbb;\n            }\n\n            &.pushly-prompt-visible {\n                bottom: 0;\n            }\n        }\n\n        &.d-disabled {\n            display: none;\n        }\n    }\n\n    /* mobile positioning */\n\n    @media screen and (max-width: $mobile-max-size) {\n        &.m-top {\n            top: -600px;\n            bottom: auto;\n\n            .pushly-prompt-slide,\n            .pushly_popover-box {\n                box-shadow: 0px 1px 1px #bbb;\n            }\n\n            &.pushly-prompt-visible {\n                top: 0;\n            }\n        }\n\n        &.m-bottom {\n            bottom: -600px;\n            top: auto;\n\n            .pushly-prompt-slide,\n            .pushly_popover-box {\n                box-shadow: 0px -1px 1px #bbb;\n            }\n\n            &.pushly-prompt-visible {\n                bottom: 0;\n            }\n        }\n\n        &.m-disabled {\n            display: none;\n        }\n    }\n\n    @media screen and (max-width: $small-screen) {\n        .pushly-prompt-slide,\n        .pushly_popover-box {\n            width: 100%;\n\n            .pushly-prompt-icon,\n            .pushly_popover-first {\n                max-width: calc(#{$imageSize} - 20px);\n                height: calc(#{$imageSize} - 20px);\n            }\n        }\n\n        &.normal {\n            .pushly-prompt-slide,\n            .pushly_popover-box {\n                .pushly-prompt-content,\n                .pushly_popover-second {\n                    width: calc(100% - #{$imageSize} + 20px);\n                }\n            }\n        }\n\n        &.m-disabled {\n            display: none;\n        }\n    }\n}\n',"@media print {\n  .pushly-prompt-window,\n  .pushly_popover {\n    display: none !important;\n  }\n}\n.pushly-prompt-window,\n.pushly_popover {\n  left: 0;\n  right: 0;\n  pointer-events: none;\n  /* theme: normal */\n  /* theme: stacked */\n  /* desktop positioning */\n  /* mobile positioning */\n}\n.pushly-prompt-window:not(.managed),\n.pushly_popover:not(.managed) {\n  position: fixed;\n  z-index: 1000000;\n  transition: all 0.5s ease;\n}\n.pushly-prompt-window .pushly-prompt-slide,\n.pushly-prompt-window .pushly_popover-box,\n.pushly_popover .pushly-prompt-slide,\n.pushly_popover .pushly_popover-box {\n  pointer-events: all;\n  margin: 0px auto;\n  box-sizing: border-box;\n  display: flex;\n  width: 400px;\n  padding: 16px;\n}\n.pushly-prompt-window .pushly-prompt-slide.pushly-prompt-visible,\n.pushly-prompt-window .pushly_popover-box.pushly-prompt-visible,\n.pushly_popover .pushly-prompt-slide.pushly-prompt-visible,\n.pushly_popover .pushly_popover-box.pushly-prompt-visible {\n  top: 0;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-icon,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-first,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-icon,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-first,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-icon,\n.pushly_popover .pushly-prompt-slide .pushly_popover-first,\n.pushly_popover .pushly_popover-box .pushly-prompt-icon,\n.pushly_popover .pushly_popover-box .pushly_popover-first {\n  position: relative;\n  max-width: 80px;\n  height: 80px;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-icon img,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-first img,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-icon img,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-first img,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-icon img,\n.pushly_popover .pushly-prompt-slide .pushly_popover-first img,\n.pushly_popover .pushly_popover-box .pushly-prompt-icon img,\n.pushly_popover .pushly_popover-box .pushly_popover-first img {\n  width: 100%;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second,\n.pushly_popover .pushly_popover-box .pushly-prompt-content,\n.pushly_popover .pushly_popover-box .pushly_popover-second {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline {\n  font-size: 1em;\n  padding-top: 8px;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly_popover-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly-prompt-message-subheadline,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly_popover-message-subheadline {\n  font-size: 0.8em;\n  padding-top: 12px;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-actions,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly_popover-buttons,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly-prompt-actions,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly_popover-buttons,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly-prompt-actions,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly_popover-buttons,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly-prompt-actions,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly_popover-buttons,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-actions,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly_popover-buttons,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly-prompt-actions,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly_popover-buttons,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly-prompt-actions,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly_popover-buttons,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly-prompt-actions,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly_popover-buttons {\n  margin-top: 16px;\n}\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-actions button,\n.pushly-prompt-window .pushly-prompt-slide .pushly-prompt-content .pushly_popover-buttons button,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly-prompt-actions button,\n.pushly-prompt-window .pushly-prompt-slide .pushly_popover-second .pushly_popover-buttons button,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly-prompt-actions button,\n.pushly-prompt-window .pushly_popover-box .pushly-prompt-content .pushly_popover-buttons button,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly-prompt-actions button,\n.pushly-prompt-window .pushly_popover-box .pushly_popover-second .pushly_popover-buttons button,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-actions button,\n.pushly_popover .pushly-prompt-slide .pushly-prompt-content .pushly_popover-buttons button,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly-prompt-actions button,\n.pushly_popover .pushly-prompt-slide .pushly_popover-second .pushly_popover-buttons button,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly-prompt-actions button,\n.pushly_popover .pushly_popover-box .pushly-prompt-content .pushly_popover-buttons button,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly-prompt-actions button,\n.pushly_popover .pushly_popover-box .pushly_popover-second .pushly_popover-buttons button {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 16px;\n  padding-right: 16px;\n  border: none;\n  font-size: 0.8em;\n  border-radius: 3px;\n  background: none;\n  cursor: pointer;\n}\n.pushly-prompt-window.normal .pushly-prompt-slide,\n.pushly-prompt-window.normal .pushly_popover-box,\n.pushly_popover.normal .pushly-prompt-slide,\n.pushly_popover.normal .pushly_popover-box {\n  flex-direction: row;\n  justify-content: space-between;\n}\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second {\n  width: calc(100% - 80px);\n  padding-left: 16px;\n}\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content .pushly_popover-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second .pushly-prompt-message .pushly_popover-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly-prompt-message-headline:first-child,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second .pushly_popover-message .pushly_popover-message-headline:first-child {\n  padding-top: 0 !important;\n}\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-actions,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content .pushly_popover-buttons,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second .pushly-prompt-actions,\n.pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second .pushly_popover-buttons,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content .pushly-prompt-actions,\n.pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content .pushly_popover-buttons,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second .pushly-prompt-actions,\n.pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second .pushly_popover-buttons,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content .pushly-prompt-actions,\n.pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content .pushly_popover-buttons,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second .pushly-prompt-actions,\n.pushly_popover.normal .pushly-prompt-slide .pushly_popover-second .pushly_popover-buttons,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content .pushly-prompt-actions,\n.pushly_popover.normal .pushly_popover-box .pushly-prompt-content .pushly_popover-buttons,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second .pushly-prompt-actions,\n.pushly_popover.normal .pushly_popover-box .pushly_popover-second .pushly_popover-buttons {\n  display: flex;\n  justify-content: flex-end;\n}\n.pushly-prompt-window.stacked .pushly-prompt-slide,\n.pushly-prompt-window.stacked .pushly_popover-box,\n.pushly_popover.stacked .pushly-prompt-slide,\n.pushly_popover.stacked .pushly_popover-box {\n  text-align: center;\n  flex-direction: column;\n  align-content: center;\n  align-items: center;\n}\n@media screen and (min-width: 768px) {\n  .pushly-prompt-window.d-top,\n  .pushly_popover.d-top {\n    top: -600px;\n    bottom: auto;\n  }\n  .pushly-prompt-window.d-top .pushly-prompt-slide,\n  .pushly-prompt-window.d-top .pushly_popover-box,\n  .pushly_popover.d-top .pushly-prompt-slide,\n  .pushly_popover.d-top .pushly_popover-box {\n    box-shadow: 0px 1px 1px #bbb;\n  }\n  .pushly-prompt-window.d-top.pushly-prompt-visible,\n  .pushly_popover.d-top.pushly-prompt-visible {\n    top: 0;\n  }\n  .pushly-prompt-window.d-bottom,\n  .pushly_popover.d-bottom {\n    bottom: -600px;\n    top: auto;\n  }\n  .pushly-prompt-window.d-bottom .pushly-prompt-slide,\n  .pushly-prompt-window.d-bottom .pushly_popover-box,\n  .pushly_popover.d-bottom .pushly-prompt-slide,\n  .pushly_popover.d-bottom .pushly_popover-box {\n    box-shadow: 0px -1px 1px #bbb;\n  }\n  .pushly-prompt-window.d-bottom.pushly-prompt-visible,\n  .pushly_popover.d-bottom.pushly-prompt-visible {\n    bottom: 0;\n  }\n  .pushly-prompt-window.d-disabled,\n  .pushly_popover.d-disabled {\n    display: none;\n  }\n}\n@media screen and (max-width: 768px) {\n  .pushly-prompt-window.m-top,\n  .pushly_popover.m-top {\n    top: -600px;\n    bottom: auto;\n  }\n  .pushly-prompt-window.m-top .pushly-prompt-slide,\n  .pushly-prompt-window.m-top .pushly_popover-box,\n  .pushly_popover.m-top .pushly-prompt-slide,\n  .pushly_popover.m-top .pushly_popover-box {\n    box-shadow: 0px 1px 1px #bbb;\n  }\n  .pushly-prompt-window.m-top.pushly-prompt-visible,\n  .pushly_popover.m-top.pushly-prompt-visible {\n    top: 0;\n  }\n  .pushly-prompt-window.m-bottom,\n  .pushly_popover.m-bottom {\n    bottom: -600px;\n    top: auto;\n  }\n  .pushly-prompt-window.m-bottom .pushly-prompt-slide,\n  .pushly-prompt-window.m-bottom .pushly_popover-box,\n  .pushly_popover.m-bottom .pushly-prompt-slide,\n  .pushly_popover.m-bottom .pushly_popover-box {\n    box-shadow: 0px -1px 1px #bbb;\n  }\n  .pushly-prompt-window.m-bottom.pushly-prompt-visible,\n  .pushly_popover.m-bottom.pushly-prompt-visible {\n    bottom: 0;\n  }\n  .pushly-prompt-window.m-disabled,\n  .pushly_popover.m-disabled {\n    display: none;\n  }\n}\n@media screen and (max-width: 480px) {\n  .pushly-prompt-window .pushly-prompt-slide,\n  .pushly-prompt-window .pushly_popover-box,\n  .pushly_popover .pushly-prompt-slide,\n  .pushly_popover .pushly_popover-box {\n    width: 100%;\n  }\n  .pushly-prompt-window .pushly-prompt-slide .pushly-prompt-icon,\n  .pushly-prompt-window .pushly-prompt-slide .pushly_popover-first,\n  .pushly-prompt-window .pushly_popover-box .pushly-prompt-icon,\n  .pushly-prompt-window .pushly_popover-box .pushly_popover-first,\n  .pushly_popover .pushly-prompt-slide .pushly-prompt-icon,\n  .pushly_popover .pushly-prompt-slide .pushly_popover-first,\n  .pushly_popover .pushly_popover-box .pushly-prompt-icon,\n  .pushly_popover .pushly_popover-box .pushly_popover-first {\n    max-width: calc(80px - 20px);\n    height: calc(80px - 20px);\n  }\n  .pushly-prompt-window.normal .pushly-prompt-slide .pushly-prompt-content,\n  .pushly-prompt-window.normal .pushly-prompt-slide .pushly_popover-second,\n  .pushly-prompt-window.normal .pushly_popover-box .pushly-prompt-content,\n  .pushly-prompt-window.normal .pushly_popover-box .pushly_popover-second,\n  .pushly_popover.normal .pushly-prompt-slide .pushly-prompt-content,\n  .pushly_popover.normal .pushly-prompt-slide .pushly_popover-second,\n  .pushly_popover.normal .pushly_popover-box .pushly-prompt-content,\n  .pushly_popover.normal .pushly_popover-box .pushly_popover-second {\n    width: calc(100% - 80px + 20px);\n  }\n  .pushly-prompt-window.m-disabled,\n  .pushly_popover.m-disabled {\n    display: none;\n  }\n}\n\n@media print {\n  .pushly_bell {\n    display: none !important;\n  }\n}\n.pushly_bell {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  /* desktop positioning */\n  /* mobile positioning */\n}\n.pushly_bell:not(.managed) {\n  position: fixed;\n  z-index: 1000000;\n  transition: all 0.5s ease;\n}\n.pushly_bell.subscribed .pushly_bell-tooltip-notsubscribed {\n  display: none;\n}\n.pushly_bell.subscribed svg {\n  opacity: 0.7;\n}\n.pushly_bell:not(.subscribed) .pushly_bell-tooltip-subscribed {\n  display: none;\n}\n.pushly_bell.hover svg {\n  opacity: 0.7;\n}\n.pushly_bell.hover .pushly_bell-tooltip {\n  opacity: 1;\n}\n.pushly_bell svg {\n  z-index: 1;\n  transition: all 0.5s ease;\n  box-shadow: 0px 1px 3px #888;\n  border-radius: 1000px;\n  cursor: pointer;\n}\n.pushly_bell .pushly_bell-tooltip {\n  transition: all 0.5s ease;\n  position: relative;\n  opacity: 0;\n  pointer-events: none;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin-right: 7.5px;\n  margin-left: 7.5px;\n}\n.pushly_bell .pushly_bell-tooltip .pushly_bell-tooltip-text {\n  padding: 8px 16px;\n  border-radius: 3px;\n  font-size: 13px;\n}\n.pushly_bell .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n  position: relative;\n  width: 15px;\n  height: 15px;\n  border-radius: 1px;\n  transform: rotate(45deg);\n}\n@media screen and (min-width: 768px) {\n  .pushly_bell.d-top-left {\n    top: 40px;\n    left: -200px;\n  }\n  .pushly_bell.d-top-left.hover .pushly_bell-tooltip {\n    left: 0;\n  }\n  .pushly_bell.d-top-left .pushly_bell-tooltip {\n    left: -30px;\n  }\n  .pushly_bell.d-top-left .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    left: 7.5px;\n  }\n  .pushly_bell.d-top-left.pushly-prompt-visible {\n    left: 40px;\n  }\n  .pushly_bell.d-top-right {\n    top: 40px;\n    right: -200px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.d-top-right.hover .pushly_bell-tooltip {\n    right: 0;\n  }\n  .pushly_bell.d-top-right .pushly_bell-tooltip {\n    right: -30px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.d-top-right .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    right: 7.5px;\n  }\n  .pushly_bell.d-top-right.pushly-prompt-visible {\n    right: 40px;\n  }\n  .pushly_bell.d-bottom-left {\n    bottom: 40px;\n    left: -200px;\n  }\n  .pushly_bell.d-bottom-left.hover .pushly_bell-tooltip {\n    left: 0;\n  }\n  .pushly_bell.d-bottom-left .pushly_bell-tooltip {\n    left: -30px;\n  }\n  .pushly_bell.d-bottom-left .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    left: 7.5px;\n  }\n  .pushly_bell.d-bottom-left.pushly-prompt-visible {\n    left: 40px;\n  }\n  .pushly_bell.d-bottom-right {\n    bottom: 40px;\n    right: -200px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.d-bottom-right.hover .pushly_bell-tooltip {\n    right: 0;\n  }\n  .pushly_bell.d-bottom-right .pushly_bell-tooltip {\n    right: -30px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.d-bottom-right .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    right: 7.5px;\n  }\n  .pushly_bell.d-bottom-right.pushly-prompt-visible {\n    right: 40px;\n  }\n  .pushly_bell.d-disabled {\n    display: none;\n  }\n}\n@media screen and (max-width: 768px) {\n  .pushly_bell.m-top-left {\n    top: 40px;\n    left: -200px;\n  }\n  .pushly_bell.m-top-left.hover .pushly_bell-tooltip {\n    left: 0;\n  }\n  .pushly_bell.m-top-left .pushly_bell-tooltip {\n    left: -30px;\n  }\n  .pushly_bell.m-top-left .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    left: 7.5px;\n  }\n  .pushly_bell.m-top-left.pushly-prompt-visible {\n    left: 40px;\n  }\n  .pushly_bell.m-top-right {\n    top: 40px;\n    right: -200px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.m-top-right.hover .pushly_bell-tooltip {\n    right: 0;\n  }\n  .pushly_bell.m-top-right .pushly_bell-tooltip {\n    right: -30px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.m-top-right .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    right: 7.5px;\n  }\n  .pushly_bell.m-top-right.pushly-prompt-visible {\n    right: 40px;\n  }\n  .pushly_bell.m-bottom-left {\n    bottom: 40px;\n    left: -200px;\n  }\n  .pushly_bell.m-bottom-left.hover .pushly_bell-tooltip {\n    left: 0;\n  }\n  .pushly_bell.m-bottom-left .pushly_bell-tooltip {\n    left: -30px;\n  }\n  .pushly_bell.m-bottom-left .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    left: 7.5px;\n  }\n  .pushly_bell.m-bottom-left.pushly-prompt-visible {\n    left: 40px;\n  }\n  .pushly_bell.m-bottom-right {\n    bottom: 40px;\n    right: -200px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.m-bottom-right.hover .pushly_bell-tooltip {\n    right: 0;\n  }\n  .pushly_bell.m-bottom-right .pushly_bell-tooltip {\n    right: -30px;\n    flex-direction: row-reverse;\n  }\n  .pushly_bell.m-bottom-right .pushly_bell-tooltip .pushly_bell-tooltip-arrow {\n    right: 7.5px;\n  }\n  .pushly_bell.m-bottom-right.pushly-prompt-visible {\n    right: 40px;\n  }\n  .pushly_bell.m-disabled {\n    display: none;\n  }\n}",'@import "variables";\n\n$arrowSize: 15px;\n$tooltipAnimationDisplacement: 30px;\n\n@media print {\n    .pushly_bell {\n        display: none !important;\n    }\n}\n\n.pushly_bell {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n\n    &:not(.managed) {\n        position: fixed;\n        z-index: 1000000;\n        transition: all 0.5s ease;\n    }\n\n    &.subscribed {\n        .pushly_bell-tooltip-notsubscribed {\n            display: none;\n        }\n\n        svg {\n            opacity: 0.7;\n        }\n    }\n\n    &:not(.subscribed) {\n        .pushly_bell-tooltip-subscribed {\n            display: none;\n        }\n    }\n\n    &.hover {\n        svg {\n            opacity: 0.7;\n        }\n\n        .pushly_bell-tooltip {\n            opacity: 1;\n        }\n    }\n\n    svg {\n        z-index: 1;\n        transition: all 0.5s ease;\n        box-shadow: 0px 1px 3px #888;\n        border-radius: 1000px;\n        cursor: pointer;\n    }\n\n    .pushly_bell-tooltip {\n        transition: all 0.5s ease;\n\n        position: relative;\n\n        opacity: 0;\n        pointer-events: none;\n\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n\n        margin-right: calc($arrowSize/2);\n        margin-left: calc($arrowSize/2);\n\n        .pushly_bell-tooltip-text {\n            padding: 8px 16px;\n            border-radius: 3px;\n\n            font-size: 13px;\n        }\n\n        .pushly_bell-tooltip-arrow {\n            position: relative;\n\n            width: $arrowSize;\n            height: $arrowSize;\n\n            border-radius: 1px;\n\n            transform: rotate(45deg);\n        }\n    }\n\n    /* desktop positioning */\n\n    @media screen and (min-width: $mobile-max-size) {\n        &.d-top-left {\n            top: 40px;\n            left: -200px;\n\n            &.hover {\n                .pushly_bell-tooltip {\n                    left: 0;\n                }\n            }\n\n            .pushly_bell-tooltip {\n                left: -$tooltipAnimationDisplacement;\n\n                .pushly_bell-tooltip-arrow {\n                    left: calc($arrowSize/2);\n                }\n            }\n\n            &.pushly-prompt-visible {\n                left: 40px;\n            }\n        }\n\n        &.d-top-right {\n            top: 40px;\n            right: -200px;\n\n            flex-direction: row-reverse;\n\n            &.hover {\n                .pushly_bell-tooltip {\n                    right: 0;\n                }\n            }\n\n            .pushly_bell-tooltip {\n                right: -$tooltipAnimationDisplacement;\n                flex-direction: row-reverse;\n\n                .pushly_bell-tooltip-arrow {\n                    right: calc($arrowSize/2);\n                }\n            }\n\n            &.pushly-prompt-visible {\n                right: 40px;\n            }\n        }\n\n        &.d-bottom-left {\n            bottom: 40px;\n            left: -200px;\n\n            &.hover {\n                .pushly_bell-tooltip {\n                    left: 0;\n                }\n            }\n\n            .pushly_bell-tooltip {\n                left: -$tooltipAnimationDisplacement;\n\n                .pushly_bell-tooltip-arrow {\n                    left: calc($arrowSize/2);\n                }\n            }\n\n            &.pushly-prompt-visible {\n                left: 40px;\n            }\n        }\n\n        &.d-bottom-right {\n            bottom: 40px;\n            right: -200px;\n\n            flex-direction: row-reverse;\n\n            &.hover {\n                .pushly_bell-tooltip {\n                    right: 0;\n                }\n            }\n\n            .pushly_bell-tooltip {\n                right: -$tooltipAnimationDisplacement;\n                flex-direction: row-reverse;\n\n                .pushly_bell-tooltip-arrow {\n                    right: calc($arrowSize/2);\n                }\n            }\n\n            &.pushly-prompt-visible {\n                right: 40px;\n            }\n        }\n\n        &.d-disabled {\n            display: none;\n        }\n    }\n\n    /* mobile positioning */\n\n    @media screen and (max-width: $mobile-max-size) {\n        &.m-top-left {\n            top: 40px;\n            left: -200px;\n\n            &.hover {\n                .pushly_bell-tooltip {\n                    left: 0;\n                }\n            }\n\n            .pushly_bell-tooltip {\n                left: -$tooltipAnimationDisplacement;\n\n                .pushly_bell-tooltip-arrow {\n                    left: calc($arrowSize/2);\n                }\n            }\n\n            &.pushly-prompt-visible {\n                left: 40px;\n            }\n        }\n\n        &.m-top-right {\n            top: 40px;\n            right: -200px;\n\n            flex-direction: row-reverse;\n\n            &.hover {\n                .pushly_bell-tooltip {\n                    right: 0;\n                }\n            }\n\n            .pushly_bell-tooltip {\n                right: -$tooltipAnimationDisplacement;\n                flex-direction: row-reverse;\n\n                .pushly_bell-tooltip-arrow {\n                    right: calc($arrowSize/2);\n                }\n            }\n\n            &.pushly-prompt-visible {\n                right: 40px;\n            }\n        }\n\n        &.m-bottom-left {\n            bottom: 40px;\n            left: -200px;\n\n            &.hover {\n                .pushly_bell-tooltip {\n                    left: 0;\n                }\n            }\n\n            .pushly_bell-tooltip {\n                left: -$tooltipAnimationDisplacement;\n\n                .pushly_bell-tooltip-arrow {\n                    left: calc($arrowSize/2);\n                }\n            }\n\n            &.pushly-prompt-visible {\n                left: 40px;\n            }\n        }\n\n        &.m-bottom-right {\n            bottom: 40px;\n            right: -200px;\n\n            flex-direction: row-reverse;\n\n            &.hover {\n                .pushly_bell-tooltip {\n                    right: 0;\n                }\n            }\n\n            .pushly_bell-tooltip {\n                right: -$tooltipAnimationDisplacement;\n                flex-direction: row-reverse;\n\n                .pushly_bell-tooltip-arrow {\n                    right: calc($arrowSize/2);\n                }\n            }\n\n            &.pushly-prompt-visible {\n                right: 40px;\n            }\n        }\n\n        &.m-disabled {\n            display: none;\n        }\n    }\n}\n'],sourceRoot:""}]);const n=t},"./node_modules/css-loader/dist/runtime/api.js":s=>{"use strict";s.exports=function(o){var h=[];return h.toString=function(){return this.map(function(s){var e="",t=void 0!==s[5];return s[4]&&(e+="@supports (".concat(s[4],") {")),s[2]&&(e+="@media ".concat(s[2]," {")),t&&(e+="@layer".concat(0<s[5].length?" ".concat(s[5]):""," {")),e+=o(s),t&&(e+="}"),s[2]&&(e+="}"),s[4]&&(e+="}"),e}).join("")},h.i=function(s,e,t,o,n){"string"==typeof s&&(s=[[null,s,void 0]]);var i={};if(t)for(var p=0;p<this.length;p++){var r=this[p][0];null!=r&&(i[r]=!0)}for(var l=0;l<s.length;l++){var u=[].concat(s[l]);t&&i[u[0]]||(void 0!==n&&(void 0!==u[5]&&(u[1]="@layer".concat(0<u[5].length?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=n),e&&(u[2]&&(u[1]="@media ".concat(u[2]," {").concat(u[1],"}")),u[2]=e),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),h.push(u))}},h}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":s=>{"use strict";s.exports=function(s){var e,t=s[1],o=s[3];return o?"function"==typeof btoa?(s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),s="/*# ".concat(s," */"),e=o.sources.map(function(s){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(s," */")}),[t].concat(e).concat([s]).join("\n")):[t].join("\n"):t}},"./node_modules/error-stack-parser/error-stack-parser.js":function(e,t,o){var n,i;!function(s){"use strict";i=[o("./node_modules/stackframe/stackframe.js")],void 0!==(i="function"==typeof(n=s)?n.apply(t,i):n)&&(e.exports=i)}(function(r){"use strict";var e=/(^|@)\S+:\d+/,t=/^\s*at .*(\S+:\d+|\(native\))/m,o=/^(eval@)?(\[native code])?$/;return{parse:function(s){if(void 0!==s.stacktrace||void 0!==s["opera#sourceloc"])return this.parseOpera(s);if(s.stack&&s.stack.match(t))return this.parseV8OrIE(s);if(s.stack)return this.parseFFOrSafari(s);throw new Error("Cannot parse given Error object")},extractLocation:function(s){if(-1===s.indexOf(":"))return[s];s=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(s.replace(/[()]/g,""));return[s[1],s[2]||void 0,s[3]||void 0]},parseV8OrIE:function(s){return s.stack.split("\n").filter(function(s){return!!s.match(t)},this).map(function(s){var e=(t=(s=-1<s.indexOf("(eval ")?s.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""):s).replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,"")).match(/ (\(.+\)$)/),t=e?t.replace(e[0],""):t,o=this.extractLocation(e?e[1]:t),e=e&&t||void 0,t=-1<["eval","<anonymous>"].indexOf(o[0])?void 0:o[0];return new r({functionName:e,fileName:t,lineNumber:o[1],columnNumber:o[2],source:s})},this)},parseFFOrSafari:function(s){return s.stack.split("\n").filter(function(s){return!s.match(o)},this).map(function(s){var e,t;return-1===(s=-1<s.indexOf(" > eval")?s.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1"):s).indexOf("@")&&-1===s.indexOf(":")?new r({functionName:s}):(e=(e=s.match(t=/((.*".+"[^@]*)?[^@]*)(?:@)/))&&e[1]?e[1]:void 0,t=this.extractLocation(s.replace(t,"")),new r({functionName:e,fileName:t[0],lineNumber:t[1],columnNumber:t[2],source:s}))},this)},parseOpera:function(s){return!s.stacktrace||-1<s.message.indexOf("\n")&&s.message.split("\n").length>s.stacktrace.split("\n").length?this.parseOpera9(s):s.stack?this.parseOpera11(s):this.parseOpera10(s)},parseOpera9:function(s){for(var e=/Line (\d+).*script (?:in )?(\S+)/i,t=s.message.split("\n"),o=[],n=2,i=t.length;n<i;n+=2){var p=e.exec(t[n]);p&&o.push(new r({fileName:p[2],lineNumber:p[1],source:t[n]}))}return o},parseOpera10:function(s){for(var e=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,t=s.stacktrace.split("\n"),o=[],n=0,i=t.length;n<i;n+=2){var p=e.exec(t[n]);p&&o.push(new r({functionName:p[3]||void 0,fileName:p[2],lineNumber:p[1],source:t[n]}))}return o},parseOpera11:function(s){return s.stack.split("\n").filter(function(s){return!!s.match(e)&&!s.match(/^Error created at/)},this).map(function(s){var e,t=s.split("@"),o=this.extractLocation(t.pop()),t=t.shift()||"",n=t.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,t=void 0===(e=t.match(/\(([^)]*)\)/)?t.replace(/^[^(]+\(([^)]*)\)$/,"$1"):e)||"[arguments not available]"===e?void 0:e.split(",");return new r({functionName:n,args:t,fileName:o[0],lineNumber:o[1],columnNumber:o[2],source:s})},this)}}})},"./node_modules/stackframe/stackframe.js":function(s,e){var t,o;!function(){"use strict";o=[],void 0!==(o="function"==typeof(t=function(){"use strict";function t(s){return!isNaN(parseFloat(s))&&isFinite(s)}function o(s){return s.charAt(0).toUpperCase()+s.substring(1)}function s(s){return function(){return this[s]}}var e=["isConstructor","isEval","isNative","isToplevel"],n=["columnNumber","lineNumber"],i=["fileName","functionName","source"],p,r,l=e.concat(n,i,["args"],["evalOrigin"]);function d(s){if(!s)return;for(var e=0;e<l.length;e++)if(s[l[e]]!==undefined)this["set"+o(l[e])](s[l[e]])}d.prototype={getArgs:function(){return this.args},setArgs:function(s){if(Object.prototype.toString.call(s)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=s},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(s){if(s instanceof d)this.evalOrigin=s;else if(s instanceof Object)this.evalOrigin=new d(s);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var s=this.getFileName()||"";var e=this.getLineNumber()||"";var t=this.getColumnNumber()||"";var o=this.getFunctionName()||"";if(this.getIsEval()){if(s)return"[eval] ("+s+":"+e+":"+t+")";return"[eval]:"+e+":"+t}if(o)return o+" ("+s+":"+e+":"+t+")";return s+":"+e+":"+t}},d.fromString=function s(e){var t=e.indexOf("(");var o=e.lastIndexOf(")");var n=e.substring(0,t);var i=e.substring(t+1,o).split(",");var p=e.substring(o+1);if(p.indexOf("@")===0){var r=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(p,"");var l=r[1];var u=r[2];var h=r[3]}return new d({functionName:n,args:i||undefined,fileName:l,lineNumber:u||undefined,columnNumber:h||undefined})};for(var u=0;u<e.length;u++){d.prototype["get"+o(e[u])]=s(e[u]);d.prototype["set"+o(e[u])]=function(e){return function(s){this[e]=Boolean(s)}}(e[u])}for(var h=0;h<n.length;h++){d.prototype["get"+o(n[h])]=s(n[h]);d.prototype["set"+o(n[h])]=function(e){return function(s){if(!t(s))throw new TypeError(e+" must be a Number");this[e]=Number(s)}}(n[h])}for(var c=0;c<i.length;c++){d.prototype["get"+o(i[c])]=s(i[c]);d.prototype["set"+o(i[c])]=function(e){return function(s){this[e]=String(s)}}(i[c])}return d})?t.apply(e,o):t)&&(s.exports=o)}()},"./src/sdk/styles/app.scss":(s,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>u});var e=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),e=t.n(e),o=t("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),o=t.n(o),n=t("./node_modules/style-loader/dist/runtime/insertBySelector.js"),n=t.n(n),i=t("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),i=t.n(i),p=t("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),p=t.n(p),r=t("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),r=t.n(r),t=t("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[1].use[1]!./node_modules/sass-loader/dist/cjs.js!./src/sdk/styles/app.scss"),l={};l.styleTagTransform=r(),l.setAttributes=i(),l.insert=n().bind(null,"head"),l.domAPI=o(),l.insertStyleElement=p(),e()(t.default,l);const u=t.default&&t.default.locals?t.default.locals:void 0},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":s=>{"use strict";var u=[];function h(s){for(var e=-1,t=0;t<u.length;t++)if(u[t].identifier===s){e=t;break}return e}function r(s,e){for(var t={},o=[],n=0;n<s.length;n++){var i=s[n],p=e.base?i[0]+e.base:i[0],r=t[p]||0,l="".concat(p," ").concat(r),p=(t[p]=r+1,h(l)),r={css:i[1],media:i[2],sourceMap:i[3],supports:i[4],layer:i[5]};-1!==p?(u[p].references++,u[p].updater(r)):(i=function(e,s){var t=s.domAPI(s);return t.update(e),function(s){s?s.css===e.css&&s.media===e.media&&s.sourceMap===e.sourceMap&&s.supports===e.supports&&s.layer===e.layer||t.update(e=s):t.remove()}}(r,e),e.byIndex=n,u.splice(n,0,{identifier:l,updater:i,references:1})),o.push(l)}return o}s.exports=function(s,i){var p=r(s=s||[],i=i||{});return function(s){s=s||[];for(var e=0;e<p.length;e++){var t=h(p[e]);u[t].references--}for(var s=r(s,i),o=0;o<p.length;o++){var n=h(p[o]);0===u[n].references&&(u[n].updater(),u.splice(n,1))}p=s}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":s=>{"use strict";var t={};s.exports=function(s,e){if(!(s=function(s){if(void 0===t[s]){var e=document.querySelector(s);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(s){e=null}t[s]=e}return t[s]}(s)))throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":s=>{"use strict";s.exports=function(s){var e=document.createElement("style");return s.setAttributes(e,s.attributes),s.insert(e,s.options),e}},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":(s,e,t)=>{"use strict";s.exports=function(s){var e=t.nc;e&&s.setAttribute("nonce",e)}},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":s=>{"use strict";s.exports=function(i){var p=i.insertStyleElement(i);return{update:function(s){var e,t,o,n;e=p,t=i,o="",(s=s).supports&&(o+="@supports (".concat(s.supports,") {")),s.media&&(o+="@media ".concat(s.media," {")),(n=void 0!==s.layer)&&(o+="@layer".concat(0<s.layer.length?" ".concat(s.layer):""," {")),o+=s.css,n&&(o+="}"),s.media&&(o+="}"),s.supports&&(o+="}"),(n=s.sourceMap)&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),t.styleTagTransform(o,e,t.options)},remove:function(){var s;null!==(s=p).parentNode&&s.parentNode.removeChild(s)}}}},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":s=>{"use strict";s.exports=function(s,e){if(e.styleSheet)e.styleSheet.cssText=s;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(s))}}},"./src/_utils/base-64.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.arrayBufferToBase64=e.base64ToArrayBuffer=void 0;const o=t("./src/sdk/utils.ts");e.base64ToArrayBuffer=function(s){s=(s+"=".repeat((4-s.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/");const e=(0,o.atobShim)(s),t=new Uint8Array(e.length);for(let s=0;s<e.length;++s)t[s]=e.charCodeAt(s);return t},e.arrayBufferToBase64=function(s){return s=new Uint8Array(s),window.btoa(String.fromCharCode.apply(null,s)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}},"./src/_utils/consent.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.buildSdkConsentEventData=e.buildSdkConsentContext=void 0;const o=t("./src/sdk/enums/consent.enum.ts");e.buildSdkConsentContext=function(s,e=!1){return{required:s=s.consentRequired||!1,status:s&&e?o.ConsentStatus.CONFIRMED:o.ConsentStatus.UNCONFIRMED}},e.buildSdkConsentEventData=function(s){return{[o.ConsentEventKeys.CONSENT_REQUIRED]:s.consent.required,[o.ConsentEventKeys.CONSENT_STATUS]:s.consent.status}}},"./src/_utils/domain-matching.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.domainMatchPredicate=void 0;const i=t("./src/_utils/global-env.ts");e.domainMatchPredicate=function(s){var e=(o=(0,i.getLocation)()).protocol+"//"+o.hostname,t=o.protocol+"//"+o.host,o=o.href;/^\*/.test(s)&&(s="."+s);const n=new RegExp(`^(http[s]?://)?${s}$`,"i");return n.test(e)||n.test(t)||n.test(o)}},"./src/_utils/global-env.ts":(s,e)=>{"use strict";function t(){return"WorkerGlobalScope"in self}function o(){return window.self!==window.top&&window.frameElement&&"about:blank"===window.frameElement.src}function n(){return o()?top:t()?self:window}Object.defineProperty(e,"__esModule",{value:!0}),e.getDocument=e.getNavigator=e.getLocation=e.getSelf=e.inSourcelessIFrameScope=e.inWorkerGlobalScope=void 0,e.inWorkerGlobalScope=t,e.inSourcelessIFrameScope=o,e.getSelf=n,e.getLocation=function(){return n().location||{}},e.getNavigator=function(){return n().navigator||{}},e.getDocument=function(){return n().document||{}}},"./src/_utils/permissions.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.getNotificationPermissions=void 0;const r=t("./src/_utils/global-env.ts");e.getNotificationPermissions=function(p){return o(this,void 0,void 0,function*(){const e=r.getSelf(),s=r.getNavigator();var t={permission:"default"};let o=t;var n,i=navigator.vendor.match(/apple/i)&&!navigator.userAgent.match(/crios/i)&&!navigator.userAgent.match(/fxios/i)&&!navigator.userAgent.match(/Opera|OPT\//);if(!i||"PushManager"in e)if(i)o.permission=e.Notification.permission;else try{"permissions"in s&&"query"in s.permissions?(n=yield s.permissions.query({name:"notifications"}),o.permission="prompt"===n.state?"default":n.state):o.permission=e.Notification.permission}catch(s){o.permission=e.Notification.permission}else{if(!p||!p.websitePushId)throw new Error("websitePushId must be provided for Safari permission check.");o=e.safari.pushNotification.permission(p.websitePushId)}return o=o||t})}},"./src/_utils/service-worker-registration.ts":function(s,e,t){"use strict";var n=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.createPushSubscription=e.getPushSubscription=e.getPushlyServiceWorkerRegistration=e.getServiceWorkerRegistrations=e.getPushlyWorkerConfig=void 0;const p=t("./src/_utils/base-64.ts"),r=t("./src/_utils/permissions.ts"),u=t("./src/sdk/services/logging.service.ts"),h=t("./src/sdk/exceptions/worker-registration.exception.ts"),d=t("./src/_utils/global-env.ts");function c(s){var e=(0,d.getLocation)();const t=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"");let o=s.app.loadConfig.sw?s.app.loadConfig.sw.replace(/^\//,""):null,n=(o&&!o.includes(t)&&(o="/"+o),s.app.loadConfig.swScope?s.app.loadConfig.swScope.replace(/^\//,""):null),i=(n&&!n.includes(t)&&(n="/"+n),o||"/pushly-sdk-worker.js");var e=i.substr(0,i.lastIndexOf("/")+1)||"/",p=s.domain.hasFlag("USE_ROOT_SW_SCOPE");let r=e;n?r=n:p&&(r="/");e=r.includes(t)?r:""+t.replace(/\/$/,"")+r,p=!s.domain.hasFlag("SW_NO_DOMAIN_KEY_PARAM");return{scope:e,installationPath:i=p?`${i}${i.includes("?")?"&":"?"}domain_key=`+s.domainKey:i}}function a(e){return n(this,void 0,void 0,function*(){let s=[];return s=e.env.isPushManagerInScope()?yield(0,d.getSelf)().navigator.serviceWorker.getRegistrations():s})}function m(t,s){var e=new Promise(s=>{let e=setTimeout(()=>{clearTimeout(e),s(null)},t)});return Promise.race([s,e])}function o(l){return n(this,void 0,void 0,function*(){var s,e=(0,d.getSelf)();let t=null;if(l.env.isPushManagerInScope()){const p=c(l);for(s of yield a(l)){yield m(50,e.navigator.serviceWorker.ready);var o=s.scope;const r=(s.active||{}).scriptURL||"";var n=o===p.scope,i=-1!==r.indexOf(p.installationPath.split("?")[0]);if(n&&i){if(t=s,!l.domain.shouldUnregisterNonPushlyWorkers())break}else if(!n&&l.domain.shouldUnregisterNonPushlyWorkers()&&(yield s.unregister(),u.Logger.info("removed worker: "+JSON.stringify({scope:o,path:r}))),n&&!i&&!l.domain.shouldReplaceExistingWorkerInPushlyScope())throw new h.WorkerRegistrationException(new Error(`Implementation Error. An existing, non-push, service worker was found at scope: ${p.scope}.`))}}return t})}e.getPushlyWorkerConfig=c,e.getServiceWorkerRegistrations=a,e.getPushlyServiceWorkerRegistration=o,e.getPushSubscription=function(i){return n(this,void 0,void 0,function*(){let e=null;if(i.env.isPushManagerInScope()&&"granted"===(yield(0,r.getNotificationPermissions)()).permission){const n=yield o(i);if(n)try{e=yield new Promise((e,t)=>{const o=setTimeout(t,5e3);n.pushManager.getSubscription().then(s=>{clearTimeout(o),s?e(s):n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:(0,p.base64ToArrayBuffer)(i.domain.vapidPublicKey)}).then(s=>{e(s)}).catch(s=>{t(s),clearTimeout(o)})}).catch(s=>{t(s),clearTimeout(o)})})}catch(s){try{e=yield n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:(0,p.base64ToArrayBuffer)(i.domain.vapidPublicKey)})}catch(s){u.Logger.warn(s)}}}return e})},e.createPushSubscription=function(t,o){return n(this,void 0,void 0,function*(){let s=null;var e=(0,d.getSelf)();return t.env.isPushManagerInScope()&&o&&"granted"===(yield(0,r.getNotificationPermissions)()).permission&&(yield m(50,e.navigator.serviceWorker.ready),s=yield o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:(0,p.base64ToArrayBuffer)(t.domain.vapidPublicKey)})),s})}},"./src/_utils/validate-only-instance-of-sdk.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateOnlyInstanceOfSdk=void 0;const o=t("./src/sdk/enums/exception-message.enum.ts"),n=t("./src/sdk/exceptions/exit.exception.ts");e.validateOnlyInstanceOfSdk=s=>{var e=window.PushlySDK;if(e&&"object"==typeof e&&void 0!==e.iid&&e.iid!==s.iid)throw new n.ExitException(o.ExceptionMessage.DUPLICATE_SDK_INSTANCE);if(s.context.app&&s.context.app.isLoaded)throw new n.ExitException(o.ExceptionMessage.SDK_ALREADY_LOADED)}},"./src/common/constants.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EVENT_JITTER_MAX_MILLISECONDS=void 0,e.EVENT_JITTER_MAX_MILLISECONDS=7e3},"./src/common/data-providers/api.data-provider.ts":function(s,e,t){"use strict";var r=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.ApiDataProvider=void 0;const l=t("./src/common/utils.ts"),u=t("./src/common/constants.ts");e.ApiDataProvider=class{static get(s,e){return r(this,void 0,void 0,function*(){return this.exec(s,"GET",{},void 0,e)})}static post(s,e={},t){return r(this,void 0,void 0,function*(){return this.exec(s,"POST",{"content-type":"text/plain"},e,t)})}static exec(t,o,n,i,p){return r(this,void 0,void 0,function*(){let e=null;try{if(p){let s=0;s="object"==typeof p&&"ms"in p?p.ms:u.EVENT_JITTER_MAX_MILLISECONDS,yield l.delayRandom(s)}const s={method:o,headers:n};if("GET"!==o&&i&&(s.body="string"!=typeof i?JSON.stringify(i):i),(e=yield l.retryFetch(t,s)).ok){let s;try{s=yield e.json()}catch(s){}return s}throw new Error("Endpoint returned with status "+e.statusText)}catch(s){throw(s=s||{}).response=e,s}})}}},"./src/common/md5.ts":(s,e)=>{"use strict";function i(s,e){var t=p(s[0],i=s[1],n=s[2],o=s[3],e[0],7,-680876936),o=p(o,t,i,n,e[1],12,-389564586),n=p(n,o,t,i,e[2],17,606105819),i=p(i,n,o,t,e[3],22,-1044525330);t=p(t,i,n,o,e[4],7,-176418897),o=p(o,t,i,n,e[5],12,1200080426),n=p(n,o,t,i,e[6],17,-1473231341),i=p(i,n,o,t,e[7],22,-45705983),t=p(t,i,n,o,e[8],7,1770035416),o=p(o,t,i,n,e[9],12,-1958414417),n=p(n,o,t,i,e[10],17,-42063),i=p(i,n,o,t,e[11],22,-1990404162),t=p(t,i,n,o,e[12],7,1804603682),o=p(o,t,i,n,e[13],12,-40341101),n=p(n,o,t,i,e[14],17,-1502002290),t=l(t,i=p(i,n,o,t,e[15],22,1236535329),n,o,e[1],5,-165796510),o=l(o,t,i,n,e[6],9,-1069501632),n=l(n,o,t,i,e[11],14,643717713),i=l(i,n,o,t,e[0],20,-373897302),t=l(t,i,n,o,e[5],5,-701558691),o=l(o,t,i,n,e[10],9,38016083),n=l(n,o,t,i,e[15],14,-660478335),i=l(i,n,o,t,e[4],20,-405537848),t=l(t,i,n,o,e[9],5,568446438),o=l(o,t,i,n,e[14],9,-1019803690),n=l(n,o,t,i,e[3],14,-187363961),i=l(i,n,o,t,e[8],20,1163531501),t=l(t,i,n,o,e[13],5,-1444681467),o=l(o,t,i,n,e[2],9,-51403784),n=l(n,o,t,i,e[7],14,1735328473),t=u(t,i=l(i,n,o,t,e[12],20,-1926607734),n,o,e[5],4,-378558),o=u(o,t,i,n,e[8],11,-2022574463),n=u(n,o,t,i,e[11],16,1839030562),i=u(i,n,o,t,e[14],23,-35309556),t=u(t,i,n,o,e[1],4,-1530992060),o=u(o,t,i,n,e[4],11,1272893353),n=u(n,o,t,i,e[7],16,-155497632),i=u(i,n,o,t,e[10],23,-1094730640),t=u(t,i,n,o,e[13],4,681279174),o=u(o,t,i,n,e[0],11,-358537222),n=u(n,o,t,i,e[3],16,-722521979),i=u(i,n,o,t,e[6],23,76029189),t=u(t,i,n,o,e[9],4,-640364487),o=u(o,t,i,n,e[12],11,-421815835),n=u(n,o,t,i,e[15],16,530742520),t=h(t,i=u(i,n,o,t,e[2],23,-995338651),n,o,e[0],6,-198630844),o=h(o,t,i,n,e[7],10,1126891415),n=h(n,o,t,i,e[14],15,-1416354905),i=h(i,n,o,t,e[5],21,-57434055),t=h(t,i,n,o,e[12],6,1700485571),o=h(o,t,i,n,e[3],10,-1894986606),n=h(n,o,t,i,e[10],15,-1051523),i=h(i,n,o,t,e[1],21,-2054922799),t=h(t,i,n,o,e[8],6,1873313359),o=h(o,t,i,n,e[15],10,-30611744),n=h(n,o,t,i,e[6],15,-1560198380),i=h(i,n,o,t,e[13],21,1309151649),t=h(t,i,n,o,e[4],6,-145523070),o=h(o,t,i,n,e[11],10,-1120210379),n=h(n,o,t,i,e[2],15,718787259),i=h(i,n,o,t,e[9],21,-343485551),s[0]=c(t,s[0]),s[1]=c(i,s[1]),s[2]=c(n,s[2]),s[3]=c(o,s[3])}function r(s,e,t,o,n,i){return e=c(c(e,s),c(o,i)),c(e<<n|e>>>32-n,t)}function p(s,e,t,o,n,i,p){return r(e&t|~e&o,s,e,n,i,p)}function l(s,e,t,o,n,i,p){return r(e&o|t&~o,s,e,n,i,p)}function u(s,e,t,o,n,i,p){return r(e^t^o,s,e,n,i,p)}function h(s,e,t,o,n,i,p){return r(t^(e|~o),s,e,n,i,p)}function t(s){for(var e=s.length,t=[1732584193,-271733879,-1732584194,271733878],o=64;o<=s.length;o+=64)i(t,function(s){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=s.charCodeAt(e)+(s.charCodeAt(e+1)<<8)+(s.charCodeAt(e+2)<<16)+(s.charCodeAt(e+3)<<24);return t}(s.substring(o-64,o)));s=s.substring(o-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(o=0;o<s.length;o++)n[o>>2]|=s.charCodeAt(o)<<(o%4<<3);if(n[o>>2]|=128<<(o%4<<3),55<o)for(i(t,n),o=0;o<16;o++)n[o]=0;return n[14]=8*e,i(t,n),t}Object.defineProperty(e,"__esModule",{value:!0}),e.MD5=void 0;var o="0123456789abcdef".split("");function n(s){for(var e=0;e<s.length;e++)s[e]=function(s){for(var e="",t=0;t<4;t++)e+=o[s>>8*t+4&15]+o[s>>8*t&15];return e}(s[e]);return s.join("")}function d(s){return n(t(s))}e.MD5=d;let c=(s,e)=>s+e&4294967295;"5d41402abc4b2a76b9719d911017c592"!=d("hello")&&(c=(s,e)=>{var t=(65535&s)+(65535&e);return(s>>16)+(e>>16)+(t>>16)<<16|65535&t})},"./src/common/utils.ts":function(s,u){"use strict";var h=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(u,"__esModule",{value:!0}),u.retryFetch=u.delayRandom=u.delay=u.awaitUntil=u.buildRegexFromArray=u.tryParseInt=u.randomString=void 0,u.randomString=(e=32)=>{var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let o="";for(let s=0;s<e;s++)o+=t[Math.floor(Math.random()*t.length)];return/undefined/i.test(o)&&"crypto"in self&&"getRandomValues"in crypto&&"Uint32Array"in self&&(o=crypto.getRandomValues(new Uint32Array(4)).join("")),o=/undefined/i.test(o)?"INVALID_RANDOM_STRING":o},u.tryParseInt=s=>{s=String(s);let e;try{isNaN(s)||(e=parseInt(s,10))}catch(s){}return e},u.buildRegexFromArray=s=>new RegExp(s.map(s=>`(${s})`).join("|"),"i"),u.awaitUntil=(n,i,p)=>h(void 0,void 0,void 0,function*(){return new Promise((e,s)=>{let t=!1;const o=setTimeout(()=>{t=!0,void 0!==p?e(p):s()},i);n.then(s=>{clearTimeout(o),t||e(s)})})}),u.delay=(t=0)=>h(void 0,void 0,void 0,function*(){return new Promise((s,e)=>{setTimeout(()=>s(),t)})});u.delayRandom=(s=0)=>h(void 0,void 0,void 0,function*(){return void 0!==s&&0<s&&(s=Math.round(Math.random()*s)),yield(0,u.delay)(s),s}),u.retryFetch=function o(n,i,p,r=8,l=800){return h(this,void 0,void 0,function*(){let s=null;var e,t=e=>h(this,void 0,void 0,function*(){var s=r-1;if(s<=0)throw e instanceof Error?e:new Error(e);return yield(0,u.delay)(l),p&&p(s),o(n,i,p,s,2*l)});try{return(s=yield fetch(n,i)).ok?s:(e=yield s.text(),t(`Retry fetch failed, ${s.status}, on url: ${n}. response object: `+e))}catch(s){return t(s)}})}},"./src/sdk/constants.ts":function(s,e,t){"use strict";var o=this&&this.__createBinding||(Object.create?function(s,e,t,o){void 0===o&&(o=t);var n=Object.getOwnPropertyDescriptor(e,t);n&&("get"in n?e.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,o,n)}:function(s,e,t,o){s[o=void 0===o?t:o]=e[t]}),n=this&&this.__exportStar||function(s,e){for(var t in s)"default"===t||Object.prototype.hasOwnProperty.call(e,t)||o(e,s,t)};Object.defineProperty(e,"__esModule",{value:!0}),e.UNCAUGHT_ERROR_BLACKLIST=e.DEFAULT_CLASSNAME_PROMPT_BTN_DISMISS=e.DEFAULT_CLASSNAME_PROMPT_BTN_ALLOW=e.DEFAULT_CLASSNAME_PROMPT_CUSTOM=e.DEFAULT_CLASSNAME_PROMPT_VISIBLE=e.DEFAULT_CLASSNAME_PROMPT_ELIGIBLE=e.DEFAULT_CLASSNAME_PROMPT_INELIGIBLE=e.DEFAULT_CLASSNAME_SUBSCRIPTION_DISMISSED=e.DEFAULT_CLASSNAME_SUBSCRIPTION_DENIED=e.DEFAULT_CLASSNAME_SUBSCRIPTION_FALSE=e.DEFAULT_CLASSNAME_SUBSCRIPTION_TRUE=e.DEFAULT_CLASSNAME_SUBSCRIPTION_NONE=e.DEFAULT_CLASSNAME_WEB_PUSH_SUPPORTED=e.DEFAULT_CLASSNAME_WEB_PUSH_UNSUPPORTED=e.MOBILE_MAX_SIZE=e.ENV_NAME_PRODUCTION=e.ENV_NAME_STAGING=e.ENV_NAME_DEV=e.ENV_NAME_LOCAL_PRODUCTION=e.ENV_NAME_LOCAL=e.PUSHLY_SETTINGS_CACHED_COOKIE_TIMEOUT=e.PUSHLY_STORE_NAME=e.PUSHLY_DB_NAME=e.PUSHLY_PROMPT_ID_QS=e.PUSHLY_SUBSCRIBED_URL_QS=e.PUSHLY_DOMAIN_KEY_QS=e.PUSHLY_PROMPT_DISMISSED_COOKIE_TIMEOUT=e.PUSHLY_UNIQUE_USER_FIRST_APPEARANCE_QS=e.PUSHLY_UNIQUE_USER_ID_QS=e.PUSHLY_SDK_APPLICATION_NAME=e.INJECTED_DOMAIN_SETTINGS=e.DOMAIN_SETTINGS_INJECTION_FAILED=e.APNS_URL=e.PROXY_URL=e.SW_DEPENDENCY_URL=e.ALLOW_ENDPOINT=e.SETTINGS_ENDPOINT=e.EVENTS_ENDPOINT=e.PUSHLY_APPLICATION_VERSION=e.ENV_NAME=void 0,e.ENV_NAME="production",e.PUSHLY_APPLICATION_VERSION="1ca8a332ba5c275f51e19efdb605befc103d1a10",e.EVENTS_ENDPOINT="https://k.p-n.io/event-stream",e.SETTINGS_ENDPOINT="https://cdn.p-n.io/domain-settings",e.ALLOW_ENDPOINT="https://k.p-n.io/allow",e.SW_DEPENDENCY_URL="https://cdn.p-n.io/pushly-sw.min.js",e.PROXY_URL="https://notifications.p-n.io",e.APNS_URL="https://cdn.p-n.io/apns",e.DOMAIN_SETTINGS_INJECTION_FAILED=/{{INJECTED_DOMAIN_SETTINGS}}/i,e.INJECTED_DOMAIN_SETTINGS={"domain": {"id": 12149, "name": "forbes.com", "domain_key": "qmhdz0KFKfsfhQQeCP5Js1NFta1P8jkwbf05", "integration_type": "direct", "custom_allow_domain": null, "frequency_caps": {"prompt": {"occurrences": 1, "fcap_seconds": 604800, "display_metric": "days"}}, "global_prompt_settings": null, "flags": ["FEAT_CUSTOM_VAPID", "FEAT_VAPID_ONLY", "REPLACE_EXISTING_WORKERS", "USE_ROOT_SW_SCOPE", "FEAT_NATIVE_ANDROID_NOTIFICATIONS_FG_DISPLAY", "FEAT_NATIVE_IOS_NOTIFICATIONS_FG_DISPLAY"], "custom_sdk_package_name": null, "vapid_public_key": "BJdOWbKbyFwt3bOoHlyU0RJE1sLzBYI16hOgmKUTirAIT1F-ReJDqNjrVmit429UYrDUjA0If_2FTwDPNEj-y3U", "additional_subscription_data": null, "whitelist_domains": ["www.forbes.com"], "sdk_event_only_domains": [], "apns_configuration": {"is_active": false, "push_package": null}, "domain_integrations": null}, "prompts": [{"id": 29955, "domain_id": 12149, "style": "NATIVE", "config": {"behavior": {"cookie_length_seconds": 604800}}, "is_auto_show": false, "weight": 50, "conditions_json": {"visitor": {"time_on_page_seconds": 8}}, "prompt_group_id": 31858, "name": "8 Seconds"}, {"id": 29956, "domain_id": 12149, "style": "NATIVE", "config": {"behavior": {"cookie_length_seconds": 604800}}, "is_auto_show": false, "weight": 25, "conditions_json": {"visitor": {"time_on_page_seconds": 10}}, "prompt_group_id": 31858, "name": "10 Seconds"}, {"id": 29957, "domain_id": 12149, "style": "NATIVE", "config": {"behavior": {"cookie_length_seconds": 604800}}, "is_auto_show": false, "weight": 25, "conditions_json": {"visitor": {"time_on_page_seconds": 4}}, "prompt_group_id": 31858, "name": "4 Seconds"}], "prompt_groups": [{"id": 31858, "domain_id": 12149, "name": "AB Test 6-27", "is_active": true, "priority": 0, "display_to_pct": 100, "conditions_json": {"display": {"mobile": "enabled", "desktop": "enabled"}}}]},n(t("./src/common/constants.ts"),e),e.PUSHLY_SDK_APPLICATION_NAME="pushly-sdk",e.PUSHLY_UNIQUE_USER_ID_QS="pushly_unique_user_id",e.PUSHLY_UNIQUE_USER_FIRST_APPEARANCE_QS="pushly_unique_user_first_appearance",e.PUSHLY_PROMPT_DISMISSED_COOKIE_TIMEOUT=7,e.PUSHLY_DOMAIN_KEY_QS="pushly_domain_key",e.PUSHLY_SUBSCRIBED_URL_QS="pushly_subscribed_url",e.PUSHLY_PROMPT_ID_QS="pushly_prompt_id",e.PUSHLY_DB_NAME="pushly_db",e.PUSHLY_STORE_NAME="pushly_store",e.PUSHLY_SETTINGS_CACHED_COOKIE_TIMEOUT=1/24/12,e.ENV_NAME_LOCAL="local",e.ENV_NAME_LOCAL_PRODUCTION="local-production",e.ENV_NAME_DEV="dev",e.ENV_NAME_STAGING="staging",e.ENV_NAME_PRODUCTION="production",e.MOBILE_MAX_SIZE=768,e.DEFAULT_CLASSNAME_WEB_PUSH_UNSUPPORTED="pushly-web-push-unsupported",e.DEFAULT_CLASSNAME_WEB_PUSH_SUPPORTED="pushly-web-push-supported",e.DEFAULT_CLASSNAME_SUBSCRIPTION_NONE="pushly-subscription-none",e.DEFAULT_CLASSNAME_SUBSCRIPTION_TRUE="pushly-subscription-subscribed",e.DEFAULT_CLASSNAME_SUBSCRIPTION_FALSE="pushly-subscription-unsubscribed",e.DEFAULT_CLASSNAME_SUBSCRIPTION_DENIED="pushly-subscription-denied",e.DEFAULT_CLASSNAME_SUBSCRIPTION_DISMISSED="pushly-subscription-dismissed",e.DEFAULT_CLASSNAME_PROMPT_INELIGIBLE="pushly-prompt-ineligible",e.DEFAULT_CLASSNAME_PROMPT_ELIGIBLE="pushly-prompt-eligible",e.DEFAULT_CLASSNAME_PROMPT_VISIBLE="pushly-prompt-visible",e.DEFAULT_CLASSNAME_PROMPT_CUSTOM="pushly-prompt-custom",e.DEFAULT_CLASSNAME_PROMPT_BTN_ALLOW="pushly-prompt-buttons-allow",e.DEFAULT_CLASSNAME_PROMPT_BTN_DISMISS="pushly-prompt-buttons-dismiss",e.UNCAUGHT_ERROR_BLACKLIST=["^UnknownError","^NotAllowedError$","^AbortError$","^QuotaExceededError$","Only secure origins are allowed"]},"./src/sdk/cross-frame-messenger/base-messenger.ts":function(s,e,t){"use strict";var p=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.BaseMessenger=void 0;const r=t("./src/sdk/models/events/event.model.ts"),l=t("./src/sdk/services/logging.service.ts");class o extends t("./src/sdk/models/events/eventable.model.ts").EventableModel{constructor(){super(),this.portListeners={}}sendToPort(e,t,o=null,n=null,i=!1){try{var p=n||crypto.getRandomValues(new Uint8Array(10)).join("");e.postMessage({id:p,topic:t,data:o,isReply:i});let s=new Promise(s=>s());if(!i){let e=void 0;s=new Promise(s=>e=s),this.portListeners[p]=e}return s}catch(s){l.Logger.error(s)}}listenToPort(e){e.onmessage=s=>{this.handleMessageEvent(s,e)}}handleMessageEvent(s,e){const t=s.ports[0]||e;try{if(s.data&&s.data.topic){const n=s.data.topic;var o=s.data.data;const i=s.data.id;i in this.portListeners?(this.portListeners[i](o),delete this.portListeners[i]):this.dispatch(new r.EventModel(n,{port:t,data:o,reply:s=>p(this,void 0,void 0,function*(){yield this.sendToPort(t,n,s,i,!0)})}))}}catch(s){l.Logger.warn(s)}}}e.BaseMessenger=o},"./src/sdk/cross-frame-messenger/messenger-client-connection-pool.ts":function(s,e,t){"use strict";var i=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.MessengerClientConnectionPool=void 0;const p=t("./src/sdk/cross-frame-messenger/models/connection-pool-record.ts"),r=t("./src/sdk/cross-frame-messenger/messenger-client.ts"),l=t("./src/sdk/services/logging.service.ts");class u{checkout(n){return i(this,void 0,void 0,function*(){l.Logger.debug("MessengerClientConnectionPool checking out "+n);let o;return n in u.connections?(l.Logger.debug("Returning existing connection"),o=u.connections[n]):(l.Logger.debug("Creating new connection"),(o=new p.ConnectionPoolRecord).checkouts=0,o.messengerClient=new Promise((e,t)=>i(this,void 0,void 0,function*(){const s=new r.MessengerClient;try{o.close=yield s.connectUrl(n),e(s)}catch(s){l.Logger.warn(s),delete u.connections[n],t(s)}})),u.connections[n]=o),o.checkouts+=1,o.messengerClient})}release(t){return i(this,void 0,void 0,function*(){for(const s in u.connections){const e=u.connections[s];if((yield e.messengerClient)===t){l.Logger.debug("MessengerClientConnectionPool releasing connection to "+s),--e.checkouts,e.checkouts<1&&(l.Logger.debug("MessengerClientConnectionPool closing connection to "+s),e.close(),delete u.connections[s]);break}}})}}(e.MessengerClientConnectionPool=u).connections={}},"./src/sdk/cross-frame-messenger/messenger-client.ts":function(s,e,t){"use strict";var p=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.MessengerClient=void 0,t("./src/sdk/cross-frame-messenger/base-messenger.ts"));const h=t("./src/common/utils.ts"),d=t("./src/sdk/enums/messenger-topic.enum.ts"),r=t("./src/sdk/exceptions/no-connection.exception.ts"),c=t("./src/sdk/exceptions/no-response.exception.ts"),a=t("./src/sdk/services/logging.service.ts");class n extends o.BaseMessenger{connect(l,u=3){return p(this,void 0,void 0,function*(){this.port&&(a.Logger.warn("ClientMessenger reused. Existing port closed."),this.close());let s,t=null,o=1,n=!1;do{s&&s.close();var i=new MessageChannel,p=((s=i.port1).onmessage=this.handleMessageEvent.bind(this),crypto.getRandomValues(new Uint8Array(10)).join(""));let e=void 0;var r=new Promise(s=>e=s);this.portListeners[p]=e,l.postMessage({id:p,topic:d.MessengerTopic.CONNECT_HANDSHAKE},"*",[i.port2]),u&&(t=yield(0,h.awaitUntil)(r,500*o,null),o+=1,n=!t&&o<=u)}while(n);if(!t&&u)throw new c.NoResponseException(new Error("Failed to connect"));return this.port=s,this.close.bind(this)})}connectUrl(n,i=3){return p(this,void 0,void 0,function*(){const o=document.createElement("div");return o.setAttribute("style","display:none;position:absolute;overflow:hidden;width:1px;height:1px;bottom:0;left:0"),new Promise((e,t)=>p(this,void 0,void 0,function*(){try{a.Logger.info("Creating iframe "+n);const s=document.createElement("iframe");if(s.width="1px",s.height="1px",s.setAttribute("style","width:1px;height:1px;display:none;"),s.src=n,o.appendChild(s),document.body.appendChild(o),yield(0,h.delay)(300),s.contentWindow)try{e(yield this.connect(s.contentWindow,i)),this.connectedHost=new URL(n).hostname,this.connectedElement=o}catch(s){t(s)}else t(new r.NoConnectionException(new Error("iframe failed to load "+n)))}catch(s){throw document.body.removeChild(o),s}}))})}close(){this.port.close(),this.connectedElement&&document.body.removeChild(this.connectedElement),this.connectedHost=null,this.connectedElement=null,this.port=null}send(e,t=null){return p(this,void 0,void 0,function*(){if(!this.port)throw new r.NoConnectionException(new Error("MessengerClient::send called before connection opened."));var s=(0,h.randomString)();return this.sendToPort(this.port,e,t,s,!1)})}sendTimeout(s,e=null,t){return p(this,void 0,void 0,function*(){return(0,h.awaitUntil)(this.send(s,e),t)})}}e.MessengerClient=n},"./src/sdk/cross-frame-messenger/messenger-server.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.MessengerServer=void 0,t("./src/sdk/cross-frame-messenger/base-messenger.ts"));const i=t("./src/sdk/enums/messenger-topic.enum.ts"),p=t("./src/sdk/data-providers/event.data-provider.ts"),r=t("./src/sdk/enums/event-type.enum.ts"),l=t("./src/sdk/services/logging.service.ts");class u extends n.BaseMessenger{constructor(){super(),this.ready=new Promise((s,e)=>{p.EventManager.once(r.EventType.APPLICATION_READY,()=>{l.Logger.info("Application is ready"),s()})})}accept(){window.addEventListener("message",this.handleMessageEvent.bind(this)),this.watch(i.MessengerTopic.CONNECT_HANDSHAKE,this.handleHandshakeEvent.bind(this))}handleHandshakeEvent(s){return o(this,void 0,void 0,function*(){return this.listenToPort(s.port),yield this.ready,s.reply(!0)})}}(e.MessengerServer=u).global=new u},"./src/sdk/cross-frame-messenger/models/connection-pool-record.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionPoolRecord=void 0;e.ConnectionPoolRecord=class{constructor(){this.checkouts=0}}},"./src/sdk/data-providers/abstract-permission.data-provider.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractPermissionDataProvider=void 0;const n=t("./src/_utils/base-64.ts"),i=t("./src/_utils/service-worker-registration.ts"),p=t("./src/_utils/global-env.ts");e.AbstractPermissionDataProvider=class{constructor(s){this.context=s,this.context=s}getLocalPermissions(){return o(this,void 0,void 0,function*(){let e={permission:"default",host:(0,p.getSelf)().location.hostname,subscription:null,applicationServerKey:null,deviceToken:null};if(this.context.env.isSafari()&&!this.context.env.isPushManagerInScope()){if(!this.context.domain.getWebsitePushId())throw new Error("websitePushId must be provided for Safari permission check.");e=self.safari.pushNotification.permission(this.context.domain.getWebsitePushId())||e}else if(this.context.env.isSafari())e.permission=(0,p.getSelf)().Notification?(0,p.getSelf)().Notification.permission.toString():e.permission;else try{let s=(yield navigator.permissions.query({name:"notifications"})).state;"prompt"===s&&(s="default"),e.permission=s}catch(s){e.permission=(0,p.getSelf)().Notification?(0,p.getSelf)().Notification.permission.toString():e.permission}if("granted"===e.permission&&this.context.env.isPushManagerInScope()){const s=yield(0,i.getPushSubscription)(this.context);s&&(e.subscription=s.toJSON(),e.applicationServerKey=(0,n.arrayBufferToBase64)(s.options.applicationServerKey))}return e})}unregisterWorker(){return o(this,void 0,void 0,function*(){let s=!1;if(this.context.env.isPushManagerInScope())try{const e=yield(0,i.getPushlyServiceWorkerRegistration)(this.context);e&&(s=yield e.unregister())}catch(s){}return s})}isSafari(){return navigator.vendor.match(/apple/i)&&!navigator.userAgent.match(/crios/i)&&!navigator.userAgent.match(/fxios/i)&&!navigator.userAgent.match(/Opera|OPT\//)}}},"./src/sdk/data-providers/abstract-session.data-provider.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractSessionDataProvider=void 0;e.AbstractSessionDataProvider=class{}},"./src/sdk/data-providers/brokered-permission.data-provider.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.BrokeredPermissionDataProvider=void 0,t("./src/sdk/data-providers/abstract-permission.data-provider.ts"));const l=t("./src/sdk/data-providers/cookie.data-provider.ts"),i=t("./src/common/utils.ts"),p=t("./src/sdk/cross-frame-messenger/messenger-client-connection-pool.ts"),u=t("./src/_utils/global-env.ts"),r=t("./src/sdk/enums/messenger-topic.enum.ts"),h=t("./src/sdk/exceptions/no-response.exception.ts"),d=t("./src/sdk/services/logging.service.ts"),c=t("./src/sdk/enums/permission-broker-topic.enum.ts");class a extends n.AbstractPermissionDataProvider{constructor(s){super(s),this.messengerClientConnectionPool=new p.MessengerClientConnectionPool}getPushPermission(){return o(this,void 0,void 0,function*(){const s=[(0,u.getSelf)().location.hostname];var e=yield this.getLocalPermissions();let t;if("default"===e.permission&&(d.Logger.info("BrokeredPermissionDataProvider: Local permissions are: "+e.permission),this.messengerClient&&(s.push(this.messengerClient.connectedHost),t=yield a.getCalculatedPermissions(this.messengerClient)),!t||"default"===t.permission)){var o,n=l.CookieDataProvider.get("_pnpds");if(n&&-1===s.indexOf(n)&&(s.push(n),o=this.context.app.getBrokeredFrameMessengerPath(n),yield this.messengerClientConnectionPool.release(this.messengerClient),this.messengerClient=yield this.messengerClientConnectionPool.checkout(o),t=(yield a.getCalculatedPermissions(this.messengerClient))||t,d.Logger.info(`BrokeredPermissionDataProvider: ${n} permissions are: `+t.permission)),!t||"default"===t.permission)for(const r of this.context.domain.whitelistDomains)if(l.CookieDataProvider.getDomain(r)===l.CookieDataProvider.getDomain()&&-1===s.indexOf(r)){var i=this.context.app.getBrokeredFrameMessengerPath(r);if(yield this.messengerClientConnectionPool.release(this.messengerClient),this.messengerClient=yield this.messengerClientConnectionPool.checkout(i),t=(yield a.getCalculatedPermissions(this.messengerClient))||t,d.Logger.info(`BrokeredPermissionDataProvider: ${r} permissions are: `+t.permission),"default"!==t.permission)break}}let p;return t&&"default"!==t.permission?(p=t,l.CookieDataProvider.set("_pnpds",t.host)):p=e,d.Logger.info("BrokeredPermissionDataProvider: Calculated permissions are: "+p.permission),p})}removeRegistration(){return o(this,void 0,void 0,function*(){const s=[(0,u.getSelf)().location.hostname];let e=yield this.unregisterWorker();if(!e&&(this.messengerClient&&(s.push(this.messengerClient.connectedHost),e=yield a.sendUnregisterRequest(this.messengerClient)),!e)){var t=l.CookieDataProvider.get("_pnpds");if(t&&-1===s.indexOf(t)&&(s.push(t),t=this.context.app.getBrokeredFrameMessengerPath(t),yield this.messengerClientConnectionPool.release(this.messengerClient),this.messengerClient=yield this.messengerClientConnectionPool.checkout(t),e=(yield a.sendUnregisterRequest(this.messengerClient))||e),!e)for(const n of this.context.domain.whitelistDomains)if(l.CookieDataProvider.getDomain(n)===l.CookieDataProvider.getDomain()&&-1===s.indexOf(n)){var o=this.context.app.getBrokeredFrameMessengerPath(n);if(yield this.messengerClientConnectionPool.release(this.messengerClient),this.messengerClient=yield this.messengerClientConnectionPool.checkout(o),e=(yield a.sendUnregisterRequest(this.messengerClient))||e)break}}return d.Logger.info("BrokeredPermissionDataProvider: Registration removed "+e),e})}static getCalculatedPermissions(e){return o(this,void 0,void 0,function*(){try{const s=yield(0,i.awaitUntil)(e.send(c.PermissionBrokerTopic.PERMISSION_GET_PUSH_PERMISSION),500);return s&&"denied"===s.permission&&"blocked"!==l.CookieDataProvider.get("_pnss")&&(s.permission="default"),s}catch(s){throw new h.NoResponseException(new Error("Failed to get calculated permissions due to timeout."))}})}static sendUnregisterRequest(e){return o(this,void 0,void 0,function*(){let s=!1;try{s=yield(0,i.awaitUntil)(e.send(r.MessengerTopic.SERVICE_WORKER_UNREGISTER),500)}catch(s){}return s})}}e.BrokeredPermissionDataProvider=a},"./src/sdk/data-providers/brokered-session.data-provider.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.BrokeredSessionDataProvider=void 0,t("./src/sdk/data-providers/abstract-session.data-provider.ts"));const i=t("./src/sdk/enums/session-broker-topic.enum.ts");class p extends n.AbstractSessionDataProvider{constructor(s){super(),this.messengerClient=s}set(s,e){return o(this,void 0,void 0,function*(){return this.messengerClient.send(i.SessionBrokerTopic.SESSION_SET,[s,e])})}get(s){return o(this,void 0,void 0,function*(){return this.messengerClient.send(i.SessionBrokerTopic.SESSION_GET,[s])})}remove(s){return o(this,void 0,void 0,function*(){return this.messengerClient.send(i.SessionBrokerTopic.SESSION_REMOVE,[s])})}getCurrentPageViews(){return o(this,void 0,void 0,function*(){return this.messengerClient.send(i.SessionBrokerTopic.SESSION_GET_CURRENT_PAGE_VIEWS)})}getCurrentTotalPageViews(){return o(this,void 0,void 0,function*(){return this.messengerClient.send(i.SessionBrokerTopic.SESSION_GET_CURRENT_TOTAL_PAGE_VIEWS)})}setRootDomainPermissionData(s){return o(this,void 0,void 0,function*(){return this.messengerClient.send(i.SessionBrokerTopic.SESSION_SET,["rdpData",s])})}getRootDomainPermissionData(){return o(this,void 0,void 0,function*(){return this.messengerClient.send(i.SessionBrokerTopic.SESSION_GET,["rdpData"])})}clearRootDomainPermissionData(){return o(this,void 0,void 0,function*(){return this.messengerClient.send(i.SessionBrokerTopic.SESSION_REMOVE,["rdpData"])})}getCurrentSession(){return o(this,void 0,void 0,function*(){return this.messengerClient.send(i.SessionBrokerTopic.SESSION_GET_CURRENT_SESSION)})}}e.BrokeredSessionDataProvider=p},"./src/sdk/data-providers/cookie.data-provider.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CookieDataProvider=void 0;const p=t("./src/_utils/global-env.ts"),n=t("./src/sdk/services/logging.service.ts");function r(){return!("WorkerGlobalScope"in self)}e.CookieDataProvider=class{static get isIsolatedMode(){return!!this.domain&&this.domain.hasFlag("USE_ISOLATED_COOKIE_STORAGE_LOCATION")}static get document(){return(0,p.getDocument)()}static get location(){return(0,p.getLocation)()}static getDomain(s){let e=s||(0,p.getSelf)().location.hostname;return this.isIsolatedMode||(e=this.domain.whitelistDomains&&1==this.domain.whitelistDomains.length?this.domain.whitelistDomains[0]:(s=>{const e=(0,p.getDocument)();let t,o,n="_sw_tld_check=cookie",i=(s||e.location.hostname).split(".");for(t=i.length-2;0<=t;t--)if(o=i.slice(t).join("."),e.cookie=n+";domain=."+o+";SameSite=strict;",-1<e.cookie.indexOf(n))return e.cookie=n.split("=")[0]+"=;domain=."+o+";SameSite=strict;expires=Thu, 01 Jan 1970 00:00:01 GMT;",o})(s))||"localhost"!==(e=(0,p.getSelf)().location.hostname)&&(e="."+e.split(".").splice(-2).join(".")),e}static set(e,t,o=730,n="d"){if(r()){null==t&&(o=-1);try{const p=new Date;var i=this.getDomain();let s=1;switch(n){case"d":case"days":s=86400;break;case"h":case"hours":s=3600;break;case"m":case"minutes":s=60}return p.setTime(p.getTime()+o*s*1e3),this.document.cookie=`${this.buildName(e)}=${t};expires=${p.toUTCString()};path=/;domain=${i};SameSite=Strict`,t}catch(s){}}}static setWithRawExpires(s,e,t){if(r())try{var o=this.getDomain();return this.document.cookie=this.buildName(s)+`=${e};expires=${t};path=/;domain=${o};SameSite=Strict`,e}catch(s){n.Logger.warn(s)}}static get(o,s=null){if(r()){var n=this.document.cookie.split(";");for(let t=0;t<n.length;t++){let s=n[t],e=s.split("=");if(e[0].trim()===this.buildName(o))return e[1].trim()}return s}}static getmv(s,e=null,t=null){let o=this.get(s,null);return null===o&&null!==t&&this.has(t)&&(o=this.get(t,e),this.clear(t),null!==o&&this.set(s,o)),o||e}static clear(s){return this.set(s,null,-1)}static has(s){return null!==this.get(s)}static buildName(s){return this.isIsolatedMode?s+"_"+this.domain.domainKey.substr(-8):s}}},"./src/sdk/data-providers/event.data-provider.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.EventManager=e.EventDataProvider=void 0;const n=t("./src/sdk/enums/messenger-topic.enum.ts"),i=t("./src/sdk/enums/amp-message-topic.enum.ts"),p=t("./src/sdk/enums/event-type.enum.ts"),r=t("./src/sdk/exceptions/invalid-event.exception.ts"),l=t("./src/sdk/enums/session-broker-topic.enum.ts"),u=t("./src/sdk/enums/permission-broker-topic.enum.ts"),h=t("./src/sdk/utils.ts");class d{constructor(){this.listeners={}}on(s,e){var t;const o=[];for(t of Array.isArray(s)?s:[s]){t=t.trim(),this.validateEventType(t);let s=(0,h.randomString)();var n=t.split(".");n&&2===n.length&&(t=n[0],s=n[1]),this.listeners[t]=this.listeners[t]||{},this.listeners[t][s]=e,o.push(this.unregisterCallback(t,s))}return Array.isArray(s)?o:o[0]}once(s,t){const e=Array.isArray(s)?s:[s],o=[];return e.forEach(s=>{s=s.trim();this.validateEventType(s);let e;e=this.on(s,s=>{null!=s?t(s):t(),e()}),o.push(e)}),Array.isArray(s)?o:o[0]}dispatch(i){return o(this,void 0,void 0,function*(){this.validateEventType(i.type);var s,e,t=this.listeners[i.type]||{};const o=[];for(s of Object.keys(t)){const n=t[s];null!=i.data?(e=Array.isArray(i.data)?i.data:[i.data],o.push(n(...e))):o.push(n())}yield Promise.all(o)})}unregisterCallback(s,e){return()=>{this.listeners[s][e]&&delete this.listeners[s][e]}}validateEventType(s){const e=[].concat(Object.keys(p.EventType).map(s=>p.EventType[s]),Object.keys(n.MessengerTopic).map(s=>n.MessengerTopic[s]),Object.keys(i.AmpMessageTopic).map(s=>i.AmpMessageTopic[s]),Object.keys(l.SessionBrokerTopic).map(s=>l.SessionBrokerTopic[s]),Object.keys(u.PermissionBrokerTopic).map(s=>u.PermissionBrokerTopic[s]));if(-1===e.indexOf(s))throw new r.InvalidEventException(s)}}e.EventDataProvider=d,e.EventManager=new d},"./src/sdk/data-providers/local-permission.data-provider.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},t=(Object.defineProperty(e,"__esModule",{value:!0}),e.LocalPermissionDataProvider=void 0,t("./src/sdk/data-providers/abstract-permission.data-provider.ts"));class n extends t.AbstractPermissionDataProvider{getPushPermission(){return o(this,void 0,void 0,function*(){return this.getLocalPermissions()})}removeRegistration(){return o(this,void 0,void 0,function*(){return this.unregisterWorker()})}}e.LocalPermissionDataProvider=n},"./src/sdk/data-providers/local-session.data-provider.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.LocalSessionDataProvider=void 0,t("./src/sdk/data-providers/abstract-session.data-provider.ts"));const i=t("./src/_utils/global-env.ts"),p=t("./src/sdk/services/logging.service.ts"),r="pushly-session";class l extends n.AbstractSessionDataProvider{set(e,t){return o(this,void 0,void 0,function*(){const s=yield this.getCurrentSession();s[e]=t,l.store.setItem(r,JSON.stringify(s))})}get(s){return o(this,void 0,void 0,function*(){return(yield this.getCurrentSession())[s]})}remove(s){return o(this,void 0,void 0,function*(){return l.store.removeItem(s)})}getCurrentTotalPageViews(){return o(this,void 0,void 0,function*(){return((yield this.getCurrentSession()).pageViews||[]).length})}setRootDomainPermissionData(s){return o(this,void 0,void 0,function*(){yield this.set("rdpData",s)})}getRootDomainPermissionData(){return o(this,void 0,void 0,function*(){return this.get("rdpData")})}clearRootDomainPermissionData(){return o(this,void 0,void 0,function*(){yield this.remove("rdpData")})}getCurrentPageViews(){return o(this,void 0,void 0,function*(){return(yield this.getCurrentSession()).pageViews})}getCurrentSession(){return o(this,void 0,void 0,function*(){var e={sessionStart:Date.now(),pageViews:[]};const t=l.store;let o=t.getItem(r);if(o)try{o=JSON.parse(o)}catch(s){p.Logger.warn("Corrupt session encountered. Resetting current session."),o=Object.assign({},e),t.setItem(r,JSON.stringify(o))}else o=Object.assign({},e),t.setItem(r,JSON.stringify(o));return o.sessionStart||(p.Logger.warn("Corrupt session encountered. Resetting current session."),o=Object.assign({},e),t.setItem(r,JSON.stringify(o))),o})}static get store(){return(0,i.getSelf)().sessionStorage}}e.LocalSessionDataProvider=l},"./src/sdk/enums/amp-message-topic.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AmpMessageTopic=void 0,(e=e.AmpMessageTopic||(e.AmpMessageTopic={})).CONNECT_HANDSHAKE="topic-connect-handshake",e.NOTIFICATION_PERMISSION_STATE="topic-notification-permission-state",e.SERVICE_WORKER_STATE="topic-service-worker-state",e.SERVICE_WORKER_REGISTRATION="topic-service-worker-registration",e.SERVICE_WORKER_QUERY="topic-service-worker-query",e.STORAGE_GET="topic-storage-get"},"./src/sdk/enums/amp-worker-message-topic.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AmpWorkerMessageTopic=void 0,(e=e.AmpWorkerMessageTopic||(e.AmpWorkerMessageTopic={})).AMP_SUBSCRIPTION_STATE="amp-web-push-subscription-state",e.AMP_SUBSCRIBE="amp-web-push-subscribe",e.AMP_UNSUBSCRIBE="amp-web-push-unsubscribe"},"./src/sdk/enums/bell-prompt-display-behavior.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BellPromptDisplayBehavior=void 0,(e=e.BellPromptDisplayBehavior||(e.BellPromptDisplayBehavior={})).ALWAYS="ALWAYS",e.PRE_SUBSCRIPTION="PRE_SUBSCRIPTION",e.POST_SUBSCRIPTION="POST_SUBSCRIPTION"},"./src/sdk/enums/consent.enum.ts":(s,e)=>{"use strict";var t;Object.defineProperty(e,"__esModule",{value:!0}),e.ConsentStatus=e.ConsentEventKeys=void 0,(t=e.ConsentEventKeys||(e.ConsentEventKeys={})).CONSENT_REQUIRED="ca_rq",t.CONSENT_STATUS="ca_st",(t=e.ConsentStatus||(e.ConsentStatus={}))[t.UNCONFIRMED=0]="UNCONFIRMED",t[t.CONFIRMED=1]="CONFIRMED"},"./src/sdk/enums/debug-cookie-code.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DebugCookieCode=void 0,(e=e.DebugCookieCode||(e.DebugCookieCode={})).sdk_impression="si",e.load_failed="lf",e.web_push_unsupported="unsp",e.mixed_integration="mxi",e.apns_not_configured="apl0",e.apns_not_enabled="apl1",e.apns_invalid_config="apl2",e.host_not_whitelisted="wlx",e.no_eligible_prompts="prx",e.platform_disabled_mobile="pldm",e.platform_disabled_desktop="pldd",e.prompt_ineligible_fcap="prif",e.user_permission_denied="updn",e.user_permission_dismissed="updm",e.user_permission_granted="upgr",e.user_ineligible="ui",e.referrer_allow="rfa",e.referrer_ignore="rfi",e.referrer_block="rfb"},"./src/sdk/enums/event-priority.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventPriority=void 0,(e=e.EventPriority||(e.EventPriority={}))[e.QUEUED=0]="QUEUED",e[e.IMMEDIATE=1]="IMMEDIATE"},"./src/sdk/enums/event-type.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventType=void 0,(e=e.EventType||(e.EventType={})).CONFIRM_CONSENT="confirm_consent",e.EXISTING_SUBSCRIPTION_DETECTED="existing_subscription_detected",e.APPLICATION_LOAD="load",e.APPLICATION_LOADED="loaded",e.APPLICATION_LOAD_ERROR="load_error",e.APPLICATION_LOAD_FAILED="load_failed",e.APPLICATION_READY="ready",e.APPLICATION_ERROR="error",e.EXIT_PERMISSIONS_DISMISSED="permission_previously_dismissed",e.EXIT_PERMISSIONS_DENIED="permission_previousy_denied",e.WEB_PUSH_SUPPORTED="web_push_supported",e.WEB_PUSH_NOT_SUPPORTED="web_push_unsupported",e.WEB_PUSH_NOT_CONFIGURED="web_push_not_configured",e.REQUEST_USER_DELETION="request_user_deletion",e.REVERT_USER_DELETION="revert_user_deletion",e.USER_DELETION_REQUEST="user_deletion_request",e.DOMAIN_APNS_NOT_CONFIGURED="apns_not_configured",e.DOMAIN_APNS_NOT_ENABLED="apns_not_enabled",e.DOMAIN_APNS_INVALID_CONFIG="apns_invalid_config",e.PROFILE_UPDATE="profile",e.PROFILE_UPDATE_EXTERNAL_ID="external_id",e.PROFILE_UPDATE_TAGS="tag",e.PROFILE_UPDATE_USER_EVENT="event",e.PROFILE_APPEND="profile_append",e.PROFILE_REMOVE="profile_remove",e.PAGE_TAG_VISIT="page_tag_visit",e.PROXY_PERMISSION_DIALOG_LOAD="proxy_permission_dialog",e.PROXY_FRAME_HELPER_LOAD="proxy_frame_helper",e.AMP_FRAME_HELPER_LOAD="amp_frame_helper",e.AMP_PERMISSION_DIALOG_LOAD="amp_permission_dialog",e.AMP_HANDSHAKE="handshake",e.AMP_CONNECT="connect",e.FLOW_LOADED="flow_loaded",e.BROKERED_DATA_SERVER_LOAD="brokered_data_server",e.NO_ELIGIBLE_PROMPTS="no_eligible_prompts",e.PROMPT_ELIGIBLE="prompt_eligible",e.PROMPT_INELIGIBLE="prompt_ineligible",e.PROMPT_SHOW="show_prompt",e.PROMPT_SHOWN="prompt_shown",e.PROMPT_ALLOWED="prompt_allowed",e.PROMPT_DISMISSED="prompt_dismissed",e.PROMPT_HIDE="prompt_hide",e.PROMPT_DISABLED="prompt_disabled",e.FOLLOW_SHOWN="prompt_shown",e.FOLLOWED="followed",e.SW_INSTALLED="sw_installed",e.SW_SETUP_COMPLETE="sw_setup_complete",e.REGISTRATION_ATTEMPT="attempt_registration",e.REGISTRATION_SUBSCRIBED="subscribed",e.REGISTRATION_UNSUBSCRIBED="unsubscribed",e.REGISTRATION_MIGRATED="migrated",e.LEGACY_PERMISSION_DIALOG_SHOWN="permission_prompted",e.PERMISSION_DIALOG_SHOWN="permission_shown",e.LEGACY_PERMISSION_GRANTED="permission_accepted",e.PERMISSION_GRANTED="permission_allowed",e.PERMISSION_DISMISSED="permission_dismissed",e.PERMISSION_DENIED="permission_denied",e.FCM_TOKEN_REFRESH="token_refreshed",e.VIEW_ITEM="view_item",e.SAVE_ITEM="save_item",e.ADD_TO_CART="add_to_cart",e.UPDATE_CART_ITEM="update_cart_item",e.PURCHASE="purchase"},"./src/sdk/enums/exception-message.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExceptionMessage=void 0,(e=e.ExceptionMessage||(e.ExceptionMessage={})).ENV_NOT_SUPPORTED="Environment is not supported.",e.USER_ABORT_REQUESTED="Aborting execution due to user request.",e.FLOW_NOT_SUPPORTED_IN_EVENT_MODE="Current flow is not supported in event only mode.",e.SDK_ALREADY_LOADED="SDK has already been loaded.",e.DUPLICATE_SDK_INSTANCE="Another instance of the Pushly SDK is already running.",e.WORKER_LOAD_FAILED="ServiceWorker could not be loaded.",e.MIGRATION_FAILED="Pushly data migration failed.",e.DOMAIN_KEY_NOT_SPECIFIED="Domain key must be specified",e.DOMAIN_UNABLE_TO_LOAD="Domain settings could not be loaded.",e.DOMAIN_APNS_NOT_CONFIGURED="Domain is not configured for use with Safari.",e.DOMAIN_APNS_NOT_ENABLED="Domain is currently disabled on Safari.",e.DOMAIN_APNS_INVALID_CONFIG="Domain configuration is invalid.",e.MIXED_INTEGRATION="Domain was configured to use both a proxy integration and native prompt.",e.HOST_NOT_WHITELISTED="Current host is not whitelisted for use",e.EXISTING_SUBSCRIPTION_DETECTED="An existing Pushly subscription has been detected",e.DIRECT_INTEGRATION_NOT_SECURE="Environment is not secure. The ServiceWorker cannot be loaded.",e.USER_UNABLE_TO_LOAD="User could not be initialized.",e.USER_INVALID_PUSH_PACKAGE="Subscription state cannot be determined.",e.USER_STATE_DENIED="Subscription state is currently set to denied.",e.USER_STATE_DISMISSED="Subscription state is currently set to dismissed.",e.USER_STATE_UNSUBBED="Subscription state is currently set to unsubscribed.",e.FAILED_TO_GET_GRANTED_TOKEN="Failed to fetch token from subscription endpoint after permission was granted. Exiting flow.",e.APNS_FAILED_TO_GET_GRANTED_TOKEN="Failed to fetch token from APNS after permission was granted. Exiting flow.",e.INVALID_TOKEN_TYPE="Token is not a valid string"},"./src/sdk/enums/integration-type.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IntegrationType=void 0,(e=e.IntegrationType||(e.IntegrationType={})).DIRECT="direct",e.PROXY="proxy"},"./src/sdk/enums/messenger-topic.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MessengerTopic=void 0,(e=e.MessengerTopic||(e.MessengerTopic={})).CONNECT_HANDSHAKE="topic-connect-handshake",e.SERVICE_WORKER_UNREGISTER="topic-service-worker-unregister"},"./src/sdk/enums/notification-permission-state.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NotificationPermissionState=void 0,(e=e.NotificationPermissionState||(e.NotificationPermissionState={})).DEFAULT="default",e.GRANTED="granted",e.DENIED="denied"},"./src/sdk/enums/permission-broker-topic.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PermissionBrokerTopic=void 0,(e.PermissionBrokerTopic||(e.PermissionBrokerTopic={})).PERMISSION_GET_PUSH_PERMISSION="permission-get-push-permission"},"./src/sdk/enums/prompt-referrer-condition.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PromptReferrerCondition=void 0,(e=e.PromptReferrerCondition||(e.PromptReferrerCondition={})).ALLOW="allow",e.IGNORE="ignore",e.BLOCK="block"},"./src/sdk/enums/prompt-style.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PromptStyle=void 0,(e=e.PromptStyle||(e.PromptStyle={})).Native="NATIVE",e.Custom="PUBLISHER_CUSTOM",e.Slide="SLIDE",e.Bell="BELL"},"./src/sdk/enums/runtime-environment.enum.ts":(s,e)=>{"use strict";var t,o;Object.defineProperty(e,"__esModule",{value:!0}),e.RuntimeEnvironmentName=e.RuntimeEnvironment=void 0,(o=t=e.RuntimeEnvironment||(e.RuntimeEnvironment={}))[o.DIRECT=100]="DIRECT",o[o.PROXY=200]="PROXY",o[o.PROXY_PERMISSION_DIALOG=201]="PROXY_PERMISSION_DIALOG",o[o.PROXY_FRAME_HELPER=202]="PROXY_FRAME_HELPER",o[o.AMP=300]="AMP",o[o.AMP_PERMISSION_DIALOG=301]="AMP_PERMISSION_DIALOG",o[o.AMP_FRAME_HELPER=302]="AMP_FRAME_HELPER",o[o.BROKERED_DATA_SERVER=400]="BROKERED_DATA_SERVER",o[o.SERVICE_WORKER=1e3]="SERVICE_WORKER",e.RuntimeEnvironmentName={[t.DIRECT]:"Direct",[t.PROXY]:"Proxy",[t.PROXY_PERMISSION_DIALOG]:"Proxy Permission Dialog",[t.PROXY_FRAME_HELPER]:"Proxy Frame Helper",[t.AMP]:"AMP",[t.AMP_PERMISSION_DIALOG]:"AMP Permission Dialog",[t.AMP_FRAME_HELPER]:"AMP Frame Helper",[t.BROKERED_DATA_SERVER]:"Brokered Data Server",[t.SERVICE_WORKER]:"Service Worker"}},"./src/sdk/enums/session-broker-topic.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SessionBrokerTopic=void 0,(e=e.SessionBrokerTopic||(e.SessionBrokerTopic={})).SESSION_GET="session-get",e.SESSION_SET="session-set",e.SESSION_REMOVE="session-remove",e.SESSION_GET_CURRENT_PAGE_VIEWS="session-get-current-page-views",e.SESSION_GET_CURRENT_TOTAL_PAGE_VIEWS="session-get-current-total-page-views",e.SESSION_GET_CURRENT_SESSION="session-get-current-session"},"./src/sdk/enums/steamable-event-type.enum.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StreamableEventType=void 0,(e=e.StreamableEventType||(e.StreamableEventType={})).ERROR="error",e.UDR="udr",e.ANONYMOUS_PAGE_VIEW="anonymous_view_page",e.PAGE_VIEW="view_page",e.PAGE_TAG_VISITS="page_tag_visit",e.PROMPT_SHOWN="prompt_shown",e.PROMPT_ALLOWED="prompt_allow",e.PROMPT_DISMISSED="prompt_dismiss",e.PROMPT_NOT_SHOWN="prompt_not_shown",e.FOLLOW_SHOWN="follow_shown",e.FOLLOWED="follow",e.PERMISSION_PROMPTED="permission_prompted",e.PERMISSION_ACCEPTED="permission_accepted",e.PERMISSION_DENIED="permission_denied",e.PERMISSION_DISMISSED="permission_dismissed",e.SUBSCRIBED="subscribed",e.MIGRATED="migrated",e.SUBSCRIPTION_CHANGED="subscription_changed",e.TOKEN_REFRESHED="token_refreshed",e.UNSUBSCRIBED="unsubscribed",e.MANUAL_UNSUBSCRIBED="manual_unsubscribed",e.PROXY_WINDOW_BLOCKED="proxy_window_blocked",e.PROXY_WINDOW_OPENED="proxy_window_opened",e.PROXY_WINDOW_CLOSED="proxy_window_closed",e.PROFILE_UPDATE="profile",e.PROFILE_APPEND="profile_append",e.PROFILE_REMOVE="profile_remove",e.SDK_IMPRESSION="sdk_impression",e.VIEW_ITEM="view_item",e.SAVE_ITEM="save_item",e.ADD_TO_CART="add_to_cart",e.UPDATE_CART_ITEM="update_cart_item",e.PURCHASE="purchase"},"./src/sdk/exceptions/domain-load.exception.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DomainLoadException=void 0;var o=t("./src/sdk/exceptions/pushly.exception.ts");const n=t("./src/sdk/enums/exception-message.enum.ts"),i=["Failed to Fetch","Retry fetch failed","NetworkError when attempting to fetch","Network request failed","The internet connection appears to be offline","A server with the specified hostname could not be found"];class p extends o.PushlyException{constructor(s){super(s,n.ExceptionMessage.DOMAIN_UNABLE_TO_LOAD,p),this.blacklistedErrors=i,this.name="DomainLoadException"}}e.DomainLoadException=p},"./src/sdk/exceptions/exit.exception.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExitException=void 0;class o extends t("./src/sdk/exceptions/pushly.exception.ts").PushlyException{constructor(s,e){"string"==typeof s&&(e=s,s=null),super(s,e,o),this.name="ExitException"}}e.ExitException=o},"./src/sdk/exceptions/fail.exception.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FailException=void 0;class o extends t("./src/sdk/exceptions/pushly.exception.ts").PushlyException{constructor(s,e){"string"==typeof s&&(e=s,s=null),super(s,e,o),this.name="FailException"}}e.FailException=o},"./src/sdk/exceptions/invalid-event.exception.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InvalidEventException=void 0;class o extends t("./src/sdk/exceptions/pushly.exception.ts").PushlyException{constructor(s){super(null,`Invalid event '${s}' specified.`,o),this.name="InvalidEventException"}}e.InvalidEventException=o},"./src/sdk/exceptions/no-connection.exception.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoConnectionException=void 0;class o extends t("./src/sdk/exceptions/pushly.exception.ts").PushlyException{constructor(s){super(s),this.name="NoConnectionException"}}e.NoConnectionException=o},"./src/sdk/exceptions/no-response.exception.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NoResponseException=void 0;class o extends t("./src/sdk/exceptions/pushly.exception.ts").PushlyException{constructor(s){super(s),this.name="NoResponseException"}}e.NoResponseException=o},"./src/sdk/exceptions/profile.exception.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProfileException=void 0;class o extends t("./src/sdk/exceptions/pushly.exception.ts").PushlyException{constructor(s,e){"string"==typeof s&&(e=s,s=null),super(s,e,o),this.name="ProfileException"}}e.ProfileException=o},"./src/sdk/exceptions/pushly.exception.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PushlyException=void 0;const n=t("./src/common/utils.ts"),i=["Invalid argument","無効な引数です","参数无效","Недопустимый аргумент","Ungültiges Argument","Nieprawidłowy argument","Ongeldig argument","Ogiltigt argument","Argumento inválido","Argomento non valido","Virheellinen argumentti","Argument non valide"];class o extends Error{constructor(s,e,t=o){super(e||s.message),this.isPushlyException=!0,this.suppressed=!1,this.blacklistedErrors=[],this.name="PushlyException",this.originError=s;try{Object.setPrototypeOf(this,t.prototype)}catch(s){}}shouldSuppress(){if(this.suppressed)return!0;let s=this.suppressed;var e=this.originError||this;if(!s&&0<this.blacklistedErrors.length){const t=(0,n.buildRegexFromArray)(this.blacklistedErrors);s=t.test(this.name)||t.test(this.message)||t.test(e.name)||t.test(e.message)}if(!s){const o=(0,n.buildRegexFromArray)(i);s=o.test(this.name)||o.test(this.message)||o.test(e.name)||o.test(e.message)}return s}}e.PushlyException=o},"./src/sdk/exceptions/worker-registration.exception.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WorkerRegistrationException=void 0;var o=t("./src/sdk/exceptions/pushly.exception.ts");const n=t("./src/sdk/enums/exception-message.enum.ts"),i=["ServiceWorker script evaluation failed","An unknown error occurred when fetching the script","Encountered an error during installation","Operation has been aborted","Operation was aborted","ServiceWorker cannot be started","Timed out while trying to start the service worker","Worker system has shutdown","Could not find a renderer process to run a service worker","The user denied permission to use Service Worker","An attempt was made to use an object that is not, or is no longer, usable","Request to fetch the script was interrupted","HTTP response code .?(4|5)[\\d]{2}.? was received","An SSL certificate error occurred","An SSL error has occurred","SecurityError","Please ensure that .messagingSenderId. is set correctly","The expression cannot be converted to return the specified type"];class p extends o.PushlyException{constructor(s){super(s,n.ExceptionMessage.WORKER_LOAD_FAILED,p),this.blacklistedErrors=i,this.name="WorkerRegistrationException"}}e.WorkerRegistrationException=p},"./src/sdk/factories/data-provider-factory.ts":function(s,e,t){"use strict";var r=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.DataProviderFactory=void 0;const o=t("./src/sdk/data-providers/local-session.data-provider.ts"),l=t("./src/sdk/data-providers/brokered-session.data-provider.ts"),n=t("./src/sdk/data-providers/brokered-permission.data-provider.ts"),i=t("./src/sdk/data-providers/local-permission.data-provider.ts"),u=t("./src/sdk/cross-frame-messenger/messenger-client-connection-pool.ts"),h=t("./src/_utils/global-env.ts"),d=t("./src/sdk/enums/runtime-environment.enum.ts"),c=t("./src/sdk/services/logging.service.ts");class p{static getSessionDataProvider(p){return r(this,void 0,void 0,function*(){if(!this.sessionDataProvider){const i=p.domain.whitelistDomains?p.domain.whitelistDomains[0]:(0,h.getSelf)().location.hostname;p.runtimeEnvironment!==d.RuntimeEnvironment.BROKERED_DATA_SERVER&&p.domain.hasFlag("FEAT_USE_DATA_BROKER")&&i!==(0,h.getSelf)().location.hostname?(c.Logger.info("Using BrokeredSessionDataProvider"),this.sessionDataProvider=new Promise((o,n)=>r(this,void 0,void 0,function*(){var s=p.app.getBrokeredFrameMessengerPath(i);try{const t=new u.MessengerClientConnectionPool;var e=yield t.checkout(s);o(new l.BrokeredSessionDataProvider(e))}catch(s){n(s)}}))):(c.Logger.info("Using LocalSessionDataProvider"),this.sessionDataProvider=Promise.resolve(new o.LocalSessionDataProvider))}return this.sessionDataProvider})}static getPermissionDataProvider(t){return r(this,void 0,void 0,function*(){return this.permissionDataProvider||(t.runtimeEnvironment!==d.RuntimeEnvironment.BROKERED_DATA_SERVER&&t.domain.hasFlag("FEAT_USE_DATA_BROKER")&&!t.env.isSafari()?(c.Logger.info("Using BrokeredPermissionDataProvider"),this.permissionDataProvider=new Promise((s,e)=>r(this,void 0,void 0,function*(){s(new n.BrokeredPermissionDataProvider(t))}))):(c.Logger.info("Using LocalPermissionDataProvider"),this.permissionDataProvider=Promise.resolve(new i.LocalPermissionDataProvider(t)))),this.permissionDataProvider})}}(e.DataProviderFactory=p).permissionDataProvider=null,p.sessionDataProvider=null},"./src/sdk/factories/flow.factory.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FlowFactory=void 0;const n=t("./src/sdk/flows/proxy.flow.ts"),i=t("./src/sdk/flows/amp-frame-helper.flow.ts"),p=t("./src/sdk/enums/exception-message.enum.ts"),r=t("./src/sdk/enums/runtime-environment.enum.ts"),l=t("./src/sdk/flows/direct.flow.ts"),u=t("./src/sdk/flows/brokered-data-server.flow.ts"),h=t("./src/sdk/flows/proxy-permission-dialog.flow.ts"),d=t("./src/sdk/exceptions/exit.exception.ts"),c=t("./src/sdk/flows/amp-permission-dialog.flow.ts");e.FlowFactory=class{static getFlow(s){let e=s.env.primaryRuntimeEnvironment;var t=s.env.subRuntimeEnvironment;t&&(e=t);const o={[r.RuntimeEnvironment.DIRECT]:l.DirectFlow,[r.RuntimeEnvironment.PROXY]:n.ProxyFlow,[r.RuntimeEnvironment.PROXY_PERMISSION_DIALOG]:h.ProxyPermissionDialogFlow,[r.RuntimeEnvironment.AMP_PERMISSION_DIALOG]:c.AmpPermissionDialogFlow,[r.RuntimeEnvironment.AMP_FRAME_HELPER]:i.AmpFrameHelperFlow,[r.RuntimeEnvironment.BROKERED_DATA_SERVER]:u.BrokeredDataServerFlow}[e];if(s.domain.isEventOnlyMode()&&o!==l.DirectFlow)throw new d.ExitException(p.ExceptionMessage.FLOW_NOT_SUPPORTED_IN_EVENT_MODE);return new o(s)}}},"./src/sdk/factories/prompt.factory.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PromptFactory=void 0;const d=t("./src/sdk/enums/prompt-style.enum.ts"),o=t("./src/sdk/prompts/native.prompt.ts"),n=t("./src/sdk/prompts/custom.prompt.ts"),c=t("./src/sdk/services/logging.service.ts");var i=t("./src/sdk/models/events/eventable.model.ts");const p=t("./src/sdk/prompts/slide.prompt.ts"),r=t("./src/sdk/prompts/bell.prompt.ts");class l extends i.EventableModel{static getPrompts(t,s={}){const o=[],e=this._selectEligiblePrompts(t,s);return 0<e.length?e.forEach(s=>{const e=this._selectPromptClass(s.prompt.style);o.push(new e(t,s))}):(this.debugPromptNotShown(t,"no_eligible_prompts"),c.Logger.info("No eligible prompts found")),o}static getPromptById(s,e){const t={};let o;if(t.prompt=s.domain.prompts.find(s=>s.id.toString()===e.toString()),t.prompt&&(t.group=s.domain.promptGroups.find(s=>s.id.toString()===t.prompt.prompt_group_id.toString())),t.group){const n=this._selectPromptClass(t.prompt.style);o=new n(s,t)}return o}static _selectPromptClass(s){return{[d.PromptStyle.Native]:o.NativePrompt,[d.PromptStyle.Slide]:p.SlidePrompt,[d.PromptStyle.Bell]:r.BellPrompt,[d.PromptStyle.Custom]:n.CustomPrompt}[s]}static _selectEligiblePrompts(i,s=0){const p=[],r=i.user.env.location.href||"",l=i.user.env.getCurrentMetaKeywords(),u=i.user.env.getDeviceType(),e=i.domain.promptGroups,h=i.domain.prompts,t=e.sort((s,e)=>s.priority>e.priority?1:s.priority<e.priority?-1:0);t.some(t=>{let s=!1,o=(i.env.requires2Step()&&(s=!0,c.Logger.info("Browser requiring 2-step detected. Filtering prompts for 2-Step experience.")),h.filter(s=>s.prompt_group_id===t.id));if(0<(o=s?o.filter(s=>s.style!==d.PromptStyle.Native):o).length){let s=!0,e;var n;return(s=t.conditions_json&&!(e=this._validatePromptConditions(i,t,u,r,l)).matched?!1:s)?(n=1===o.length?o[0]:this._pickWeightedRandomPrompt(o),p.push({group:t,prompt:n}),!0):!(!e||!e.stopEvaluation)||void 0}});let o;var n;return(o=(o=0<p.length?p[0]:o)&&o.group&&void 0!==o.group.display_to_pct&&(n=o.group.display_to_pct)<100&&n<Math.floor(100*Math.random())?void 0:o)?[o]:[]}static _validatePromptConditions(s,e,t,o,n){let i={matched:!0,stopEvaluation:!1};var p;return e.conditions_json&&(p=e.conditions_json.display||{},e=e.conditions_json.page||{},(i=this._validateDisplayConditions(p,t)).matched&&(p=this._validateMetaKeywordConditions(e,n),i.matched=p.matched),i.matched&&(t=this._validatePageUrlConditions(e,o),i.matched=t.matched)),i.stopEvaluation&&i.stopEvaluationReason&&this.debugPromptNotShown(s,i.stopEvaluationReason),i}static _validateDisplayConditions(s,e){const t={matched:!0,stopEvaluation:!1};return(s.mobile||s.desktop)&&(!(e="desktop"===e)&&t.matched&&s.mobile&&("pass"===s.mobile&&(t.matched=!1),"disabled"===s.mobile&&(t.matched=!1,t.stopEvaluation=!0,t.stopEvaluationReason="platform_disabled_mobile")),e&&t.matched&&s.desktop&&("pass"===s.desktop&&(t.matched=!1),"disabled"===s.desktop&&(t.matched=!1,t.stopEvaluation=!0,t.stopEvaluationReason="platform_disabled_desktop"))),t}static _validateMetaKeywordConditions(s,t){const o={matched:!0,stopEvaluation:!1};if(o.matched&&Array.isArray(s.keywords))if(0===t.length)o.matched=!1;else{let e=!1;s.keywords.some(s=>{if(-1!==t.indexOf(s))return e=!0}),o.matched=e}return o}static _validatePageUrlConditions(s,o){const e={matched:!0,stopEvaluation:!1};if(e.matched&&s.excluded_page_urls){let t=!1;Array.isArray(s.excluded_page_urls)&&0<s.excluded_page_urls.length&&s.excluded_page_urls.some(s=>{const e=new RegExp(this._prepareRgxUrl(s),"i");if(e.test(o))return t=!0}),e.matched=!t}if(e.matched&&s.page_urls){let t=!1;Array.isArray(s.page_urls)&&0<s.page_urls.length?s.page_urls.some(s=>{const e=new RegExp(this._prepareRgxUrl(s),"i");if(e.test(o))return t=!0}):t=!0,e.matched=t}return e}static _prepareRgxUrl(s){return s.replace(/\?/g,"\\?").replace(/\+|%20/g,"(?:\\+|%20)")}static _pickWeightedRandomPrompt(s){const e=[];for(var t of s)for(let s=0;s<t.weight;s++)e.push(t);return e[Math.floor(Math.random()*e.length)]}}e.PromptFactory=l},"./src/sdk/flows/amp-frame-helper.flow.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.AmpFrameHelperFlow=void 0;const n=t("./src/sdk/message-servers/amp-frame-helper-server.ts");var i=t("./src/sdk/flows/base.flow.ts");const p=t("./src/sdk/models/events/event.model.ts"),r=t("./src/sdk/enums/event-type.enum.ts"),l=t("./src/sdk/services/worker.service.ts");class u extends i.BaseFlow{constructor(s){super(s,!1)}_wireEvents(){this.ampFrameHelperServer=new n.AmpFrameHelperServer(this.context)}run(){return o(this,void 0,void 0,function*(){yield l.WorkerService.registerWorker(this.context),yield this.dispatch(new p.EventModel(r.EventType.FLOW_LOADED))})}}e.AmpFrameHelperFlow=u},"./src/sdk/flows/amp-permission-dialog.flow.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.AmpPermissionDialogFlow=void 0;const n=t("./src/sdk/constants.ts");var i=t("./src/sdk/flows/base.flow.ts");const p=t("./src/sdk/cross-frame-messenger/messenger-client.ts"),r=t("./src/common/utils.ts"),l=t("./src/sdk/models/events/event.model.ts"),u=t("./src/sdk/enums/amp-message-topic.enum.ts"),h=t("./src/sdk/enums/event-type.enum.ts"),d=t("./src/sdk/enums/notification-permission-state.enum.ts"),c=t("./src/sdk/services/registration.service.ts"),a=t("./src/sdk/services/logging.service.ts"),m=t("./src/sdk/services/worker.service.ts");class y extends i.BaseFlow{_wireEvents(){var s=this.handlePermissionGranted.bind(this),e=this.handlePermissionDenied.bind(this);this.watch(h.EventType.REGISTRATION_SUBSCRIBED,s),this.watch(h.EventType.PERMISSION_DENIED,e),this.watch(h.EventType.PERMISSION_DISMISSED,e)}run(){return o(this,void 0,void 0,function*(){this.messengerClient=new p.MessengerClient,yield this.messengerClient.connect(window.opener,0),yield m.WorkerService.registerWorker(this.context),this.loadLanternShark(),yield this.dispatch(new l.EventModel(h.EventType.FLOW_LOADED))})}loadLanternShark(){var s=this.context.domain.domainKey;const e=document.createElement("iframe");s=n.PROXY_URL+`/amp/${s}?pushly_domain_key=`+s;e.addEventListener("load",()=>o(this,void 0,void 0,function*(){try{this.initializeDialogContent(e.contentWindow),yield c.RegistrationService.performManualRegistrationAttempt(this.context,999)}catch(s){a.Logger.error(this.context,s)}})),e.setAttribute("src",s),e.setAttribute("frame-border","0"),e.setAttribute("style","width: 100vw; height: 100vh; border: none;"),document.body.appendChild(e)}initializeDialogContent(s){s.postMessage({action:"lite-reboot",data:{context:this.context}},"*")}handlePermissionGranted(){return o(this,void 0,void 0,function*(){try{yield(0,r.awaitUntil)(this.messengerClient.send(u.AmpMessageTopic.NOTIFICATION_PERMISSION_STATE,d.NotificationPermissionState.GRANTED),500)}catch(s){}window.close()})}handlePermissionDenied(){return o(this,void 0,void 0,function*(){try{yield(0,r.awaitUntil)(this.messengerClient.send(u.AmpMessageTopic.NOTIFICATION_PERMISSION_STATE,d.NotificationPermissionState.DENIED),500)}catch(s){}window.close()})}}e.AmpPermissionDialogFlow=y},"./src/sdk/flows/base.flow.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.BaseFlow=void 0;const r=t("./src/sdk/utils.ts"),n=t("./src/sdk/models/events/subscriber-streamable-event.model.ts"),i=t("./src/sdk/models/events/base-streamable-event.model.ts"),p=t("./src/sdk/enums/steamable-event-type.enum.ts"),l=t("./src/sdk/factories/data-provider-factory.ts");class u extends t("./src/sdk/models/events/eventable.model.ts").EventableModel{constructor(s,e=!0){super(),this.context=s,this.isPromptableFlow=e,this._wireEvents()}_startPageChangeTracker(e){let t;const s=()=>o(this,void 0,void 0,function*(){var s=this.context.env.location.href;s!=t&&(this._logSessionPageView(s),(yield this.context.user.isSubscribed(this.context))?this.post(new n.SubscriberStreamableEventModel(p.StreamableEventType.PAGE_VIEW,{meta:{subscription_data:e}},this.context)):-1!==this.context.domain.flags.indexOf("FEAT_INFORMED_CONTENT")&&this.post(new i.BaseStreamableEventModel(p.StreamableEventType.ANONYMOUS_PAGE_VIEW,{meta:{page_url:s}},this.context))),t=s});setInterval(()=>s(),100),s()}_logSessionPageView(p){return o(this,void 0,void 0,function*(){try{const i=yield l.DataProviderFactory.getSessionDataProvider(this.context);var s,e=(0,r.hashFromString)(p),t=(yield i.getCurrentSession()).pageViews||[],o=0===t.length,n=!o&&t[t.length-1]!==e;(o||n)&&(s=[...t,e],yield i.set("pageViews",s))}catch(s){}})}}e.BaseFlow=u},"./src/sdk/flows/brokered-data-server.flow.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.BrokeredDataServerFlow=void 0,t("./src/sdk/flows/base.flow.ts"));const i=t("./src/sdk/message-servers/brokered-session-server.ts"),p=t("./src/sdk/message-servers/brokered-permission-server.ts"),r=t("./src/sdk/models/events/event.model.ts"),l=t("./src/sdk/enums/event-type.enum.ts"),u=t("./src/sdk/cross-frame-messenger/messenger-server.ts"),h=t("./src/sdk/services/registration.service.ts");class d extends n.BaseFlow{constructor(s){super(s,!1)}_wireEvents(){this.brokeredSessionServer=new i.BrokeredSessionServer(u.MessengerServer.global),this.brokeredPermissionServer=new p.BrokeredPermissionServer(this.context,u.MessengerServer.global)}run(){return o(this,void 0,void 0,function*(){yield h.RegistrationService.tryMigration(this.context,!1),yield this.dispatch(new r.EventModel(l.EventType.FLOW_LOADED))})}}e.BrokeredDataServerFlow=d},"./src/sdk/flows/direct.flow.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.DirectFlow=void 0,t("./src/sdk/flows/base.flow.ts"));const i=t("./src/_utils/global-env.ts"),p=t("./src/sdk/models/events/event.model.ts"),r=t("./src/sdk/enums/exception-message.enum.ts"),l=t("./src/sdk/enums/runtime-environment.enum.ts"),u=t("./src/sdk/enums/event-type.enum.ts"),h=t("./src/sdk/services/registration.service.ts"),d=t("./src/sdk/exceptions/exit.exception.ts"),c=t("./src/sdk/services/worker.service.ts");class a extends n.BaseFlow{_wireEvents(){}run(){return o(this,void 0,void 0,function*(){var s=yield this.context.user.getComputedPushPermission(this.context);if(!this.context.domain.isEventOnlyMode()&&this.context.env.primaryRuntimeEnvironment!==l.RuntimeEnvironment.PROXY){if(this.context.env.isPushManagerInScope()){if(!this.context.env.isHTTPS()&&!this.context.env.isDevMode())throw new d.ExitException(r.ExceptionMessage.DIRECT_INTEGRATION_NOT_SECURE);this.context.domain.shouldUseVapid()&&!(yield this.context.user.isSubscribed(this.context))||s.host===(0,i.getSelf)().location.hostname&&(yield c.WorkerService.registerWorker(this.context))}yield h.RegistrationService.tryMigration(this.context)}this._startPageChangeTracker(s.subscription),yield this.dispatch(new p.EventModel(u.EventType.FLOW_LOADED))})}}e.DirectFlow=a},"./src/sdk/flows/proxy-permission-dialog.flow.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.ProxyPermissionDialogFlow=void 0,t("./src/sdk/flows/base.flow.ts"));const i=t("./src/sdk/models/events/event.model.ts"),p=t("./src/sdk/enums/event-type.enum.ts"),r=t("./src/sdk/services/logging.service.ts"),l=t("./src/sdk/services/worker.service.ts");class u extends n.BaseFlow{_wireEvents(){var s=this._handlePermissionPrompted.bind(this),e=this._handlePermissionGranted.bind(this),t=this._handlePermissionDismissed.bind(this),o=this._handlePermissionDenied.bind(this);this.watch(p.EventType.PERMISSION_DIALOG_SHOWN,s),this.watch(p.EventType.REGISTRATION_SUBSCRIBED,e),this.watch(p.EventType.PERMISSION_DISMISSED,t),this.watch(p.EventType.PERMISSION_DENIED,o)}run(){return o(this,void 0,void 0,function*(){this.context.env.isPushManagerInScope()&&(yield l.WorkerService.registerWorker(this.context)),yield this.dispatch(new i.EventModel(p.EventType.FLOW_LOADED))})}_handlePermissionPrompted(){return o(this,void 0,void 0,function*(){this._postMessage(p.EventType.PERMISSION_DIALOG_SHOWN,void 0,!1)})}_handlePermissionGranted(s){return o(this,void 0,void 0,function*(){this._postMessage(p.EventType.REGISTRATION_SUBSCRIBED,s)})}_handlePermissionDismissed(){return o(this,void 0,void 0,function*(){this._postMessage(p.EventType.PERMISSION_DISMISSED)})}_handlePermissionDenied(){return o(this,void 0,void 0,function*(){this._postMessage(p.EventType.PERMISSION_DENIED)})}_postMessage(s,e,t=!0){try{window.opener.postMessage({action:s,data:e},"*")}catch(s){r.Logger.warn(s)}finally{t&&this._closeWindow()}}_closeWindow(){setTimeout(()=>{window.close()})}}e.ProxyPermissionDialogFlow=u},"./src/sdk/flows/proxy.flow.ts":function(s,e,t){"use strict";var n=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.ProxyFlow=void 0,t("./src/sdk/flows/direct.flow.ts"));const i=t("./src/sdk/models/events/event.model.ts"),p=t("./src/sdk/services/user.service.ts"),r=t("./src/sdk/enums/event-type.enum.ts"),l=t("./src/sdk/services/logging.service.ts");class u extends o.DirectFlow{_wireEvents(){var s=this._handleWindowMessage.bind(this);window.addEventListener("message",s)}run(){const s=Object.create(null,{run:{get:()=>super.run}});return n(this,void 0,void 0,function*(){yield p.UserService.reloadUserWithCachePriority(this.context.user),yield s.run.call(this)})}_handleWindowMessage(o){return n(this,void 0,void 0,function*(){try{var s=this.context.domain;if(-1!==o.origin.indexOf(s.customAllowDomain)){var e=o.data.action,t=o.data.data;switch(l.Logger.info("Got message from proxy window: "+e),e){case r.EventType.PERMISSION_DIALOG_SHOWN:yield this._handlePermissionPrompted();break;case r.EventType.REGISTRATION_SUBSCRIBED:yield this._handlePermissionAccepted(t);break;case r.EventType.PERMISSION_DISMISSED:yield this._handlePermissionDismissed();break;case r.EventType.PERMISSION_DENIED:yield this._handlePermissionDenied()}yield this.dispatch(new i.EventModel(e,t))}}catch(s){l.Logger.error(this.context,s)}})}_handlePermissionPrompted(){return n(this,void 0,void 0,function*(){this.dispatch(new i.EventModel(r.EventType.PERMISSION_DIALOG_SHOWN,this._buildClientFeedbackEventPack(this.context.user.lastSeenPromptId)))})}_handlePermissionAccepted(s){return n(this,void 0,void 0,function*(){this.dispatch(new i.EventModel(r.EventType.PERMISSION_GRANTED,this._buildClientFeedbackEventPack(this.context.user.lastSeenPromptId))),yield p.UserService.setSubscriptionState(this.context.user,"subscribed",s)})}_handlePermissionDismissed(){return n(this,void 0,void 0,function*(){this.dispatch(new i.EventModel(r.EventType.PERMISSION_DISMISSED,this._buildClientFeedbackEventPack(this.context.user.lastSeenPromptId))),yield p.UserService.setSubscriptionState(this.context.user,"dismissed")})}_handlePermissionDenied(){return n(this,void 0,void 0,function*(){this.dispatch(new i.EventModel(r.EventType.PERMISSION_DENIED,this._buildClientFeedbackEventPack(this.context.user.lastSeenPromptId))),yield p.UserService.setSubscriptionState(this.context.user,"blocked")})}_buildClientFeedbackEventPack(s=null,e=[]){return{prompt:{id:s,keywords:e}}}}e.ProxyFlow=u},"./src/sdk/message-servers/abstract-message-server.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractMessageServer=void 0;const o=t("./src/sdk/services/logging.service.ts");class n extends t("./src/sdk/models/events/eventable.model.ts").EventableModel{andReply(s){return e=>{s(e.data).then(s=>{e.reply(s)}).catch(s=>{o.Logger.warn("MessageServerError encountered:",s)})}}}e.AbstractMessageServer=n},"./src/sdk/message-servers/amp-frame-helper-server.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.AmpFrameHelperServer=void 0,t("./src/sdk/message-servers/abstract-message-server.ts"));const i=t("./src/sdk/cross-frame-messenger/messenger-server.ts"),p=t("./src/sdk/enums/amp-message-topic.enum.ts"),r=t("./src/sdk/models/events/event.model.ts"),l=t("./src/sdk/enums/amp-worker-message-topic.enum.ts"),u=t("./src/sdk/services/user.service.ts"),h=t("./src/sdk/enums/event-type.enum.ts"),d=t("./src/sdk/enums/notification-permission-state.enum.ts"),c=t("./src/sdk/services/registration.service.ts");class a extends n.AbstractMessageServer{constructor(s){super(),this.context=s,this.bindEvents()}bindEvents(){i.MessengerServer.global.watch(p.AmpMessageTopic.NOTIFICATION_PERMISSION_STATE,this.andReply(this.handlePermissionStateMessage.bind(this))),i.MessengerServer.global.watch(p.AmpMessageTopic.SERVICE_WORKER_STATE,this.andReply(this.handleWorkerStateMessage.bind(this))),i.MessengerServer.global.watch(p.AmpMessageTopic.SERVICE_WORKER_REGISTRATION,this.andReply(this.handleWorkerRegistrationMessage.bind(this))),i.MessengerServer.global.watch(p.AmpMessageTopic.SERVICE_WORKER_QUERY,this.andReply(this.handleWorkerQueryMessage.bind(this))),i.MessengerServer.global.watch(p.AmpMessageTopic.STORAGE_GET,this.andReply(this.handleStorageGetMessage.bind(this)))}handlePermissionStateMessage(){return o(this,void 0,void 0,function*(){return{success:!0,result:!0}})}handleWorkerStateMessage(){return o(this,void 0,void 0,function*(){return{success:!0,result:{isControllingFrame:!!window.navigator.serviceWorker.controller,url:window.navigator.serviceWorker.controller?window.navigator.serviceWorker.controller.scriptURL.split("?")[0]:null,state:window.navigator.serviceWorker.controller?window.navigator.serviceWorker.controller.state:null}}})}handleWorkerRegistrationMessage(){return o(this,void 0,void 0,function*(){return{success:!0,result:null}})}handleWorkerQueryMessage(t){return o(this,void 0,void 0,function*(){const s=this.context.user;let e=null;switch(t.topic){case l.AmpWorkerMessageTopic.AMP_SUBSCRIPTION_STATE:e=yield s.isSubscribed(this.context);break;case l.AmpWorkerMessageTopic.AMP_UNSUBSCRIBE:yield c.RegistrationService.unsubscribe(this.context);break;case l.AmpWorkerMessageTopic.AMP_SUBSCRIBE:}return{success:!0,result:e}})}handleStorageGetMessage(){return o(this,void 0,void 0,function*(){const s=this.context.user;let e=d.NotificationPermissionState.DEFAULT;return(yield s.isSubscribed(this.context))&&(e=d.NotificationPermissionState.GRANTED,"subscribed"!==s.subscriberState&&(yield u.UserService.reloadUserWithCachePriority(s),yield this.dispatch(new r.EventModel(h.EventType.REGISTRATION_SUBSCRIBED,s.token)))),(s.isBlocked()||s.isDismissed())&&(e=d.NotificationPermissionState.DENIED,"none"===s.subscriberState&&(yield this.dispatch(new r.EventModel(h.EventType.PERMISSION_DENIED)))),{success:!0,result:e}})}}e.AmpFrameHelperServer=a},"./src/sdk/message-servers/brokered-permission-server.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BrokeredPermissionServer=void 0;const o=t("./src/sdk/data-providers/local-permission.data-provider.ts");var n=t("./src/sdk/message-servers/abstract-message-server.ts");const i=t("./src/sdk/enums/messenger-topic.enum.ts"),p=t("./src/sdk/enums/permission-broker-topic.enum.ts");class r extends n.AbstractMessageServer{constructor(s,e){super(),this.context=s,this.messengerServer=e,this.dataProvider=new o.LocalPermissionDataProvider(s),this.bindEvents()}bindEvents(){this.messengerServer.watch(p.PermissionBrokerTopic.PERMISSION_GET_PUSH_PERMISSION,this.andReply(this.dataProvider.getPushPermission.bind(this.dataProvider))),this.messengerServer.watch(i.MessengerTopic.SERVICE_WORKER_UNREGISTER,this.andReply(this.dataProvider.removeRegistration.bind(this.dataProvider)))}}e.BrokeredPermissionServer=r},"./src/sdk/message-servers/brokered-session-server.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.BrokeredSessionServer=void 0,t("./src/sdk/message-servers/abstract-message-server.ts"));const i=t("./src/sdk/data-providers/local-session.data-provider.ts"),p=t("./src/sdk/enums/session-broker-topic.enum.ts");class r extends n.AbstractMessageServer{constructor(s){super(),this.messengerServer=s,this.dataProvider=new i.LocalSessionDataProvider,this.bindEvents()}bindEvents(){this.messengerServer.watch(p.SessionBrokerTopic.SESSION_GET,this.andReply(this.dataProvider.get.bind(this.dataProvider))),this.messengerServer.watch(p.SessionBrokerTopic.SESSION_REMOVE,this.andReply(this.dataProvider.remove.bind(this.dataProvider))),this.messengerServer.watch(p.SessionBrokerTopic.SESSION_GET_CURRENT_PAGE_VIEWS,this.andReply(this.dataProvider.getCurrentPageViews.bind(this.dataProvider))),this.messengerServer.watch(p.SessionBrokerTopic.SESSION_GET_CURRENT_TOTAL_PAGE_VIEWS,this.andReply(this.dataProvider.getCurrentTotalPageViews.bind(this.dataProvider))),this.messengerServer.watch(p.SessionBrokerTopic.SESSION_GET_CURRENT_SESSION,this.andReply(this.dataProvider.getCurrentSession.bind(this.dataProvider))),this.messengerServer.watch(p.SessionBrokerTopic.SESSION_SET,this.andReply(s=>o(this,void 0,void 0,function*(){return this.dataProvider.set(s[0],s[1])})))}}e.BrokeredSessionServer=r},"./src/sdk/models/application/app.model.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AppModel=void 0;const o=t("./src/sdk/constants.ts");e.AppModel=class{constructor(){this.env=o.ENV_NAME,this.version=o.PUSHLY_APPLICATION_VERSION,this.classNames={},this.isLoaded=!1,this.isReady=!1,this.isDisabled=!1,this.isVisibleLoggingEnabled=!1,this.isEventOnlyMode=!1,this.mode="production"}getBrokeredFrameMessengerPath(s){return this.loadConfig.frameMessenger?"https://"+s+this.loadConfig.frameMessenger:this.loadConfig.sw?`https://${s}${this.loadConfig.sw.substr(0,this.loadConfig.sw.lastIndexOf("/"))}/pushly-frame-messenger.html`:`https://${s}/pn-brokered-data-server.html`}}},"./src/sdk/models/application/environment.model.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.EnvironmentModel=void 0;const n=t("./src/sdk/data-providers/local-permission.data-provider.ts"),i=t("./src/_utils/global-env.ts"),p=t("./src/sdk/utils.ts"),r=t("./src/sdk/factories/data-provider-factory.ts");e.EnvironmentModel=class{constructor(){this.mode="production"}get scope(){return(0,i.getSelf)()}get navigator(){return(0,i.getNavigator)()}get location(){return(0,i.getLocation)()}get document(){return(0,i.getDocument)()}get referrer(){return(0,i.getDocument)().referrer}get userAgent(){return(0,i.getNavigator)().userAgent}getDeviceType(){let s;return s=navigator.userAgentData?navigator.userAgentData.mobile?"mobile":"desktop":/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?"mobile":"desktop"}getCurrentMetaTags(){let s;const e=this.document;return s=e?e.getElementsByTagName("meta"):s}getCurrentMetaKeywords(){let s=[];var e=this.getCurrentMetaTags();if(e&&e.keywords){const t=e.keywords;e=t.content.split(",").map(s=>s.toString().trim().toLowerCase());e&&0<e.length&&(s=e)}return s}getQueryString(){return(0,p.parseQueryString)(this.location.search)}getGlobalScope(){return this.inSourcelessIFrame()?top:this.inWorkerGlobalScope()?self:window}inWorkerGlobalScope(){return"WorkerGlobalScope"in self}inSourcelessIFrame(){return window.self!==window.top&&window.frameElement&&"about:blank"===window.frameElement.src}requires2Step(){if(this.isSafari())return!0;if(!navigator.userAgentData)return!0;for(const s of navigator.userAgentData.brands){if(/firefox/i.test(s.brand))return!0;if("Microsoft Edge"===s.brand)return!0}return!1}isSafari(){return navigator.vendor.match(/apple/i)&&!navigator.userAgent.match(/crios/i)&&!navigator.userAgent.match(/fxios/i)&&!navigator.userAgent.match(/Opera|OPT\//)}isSafariPushCapable(){return this.isSafari()&&"object"==typeof this.scope.safari&&"pushNotification"in this.scope.safari}isPushManagerInScope(){return"PushManager"in this.scope}isArrayFullySupported(){return"Array"in this.scope&&"from"in Array&&"some"in[]}isDevMode(){return"development"===this.mode}isHTTPS(){return"https:"===this.location.protocol}isLocal(){return"localhost"===this.location.hostname||"127.0.0.1"===this.location.hostname}getLocalPushPermission(e){return o(this,void 0,void 0,function*(){const s=yield new n.LocalPermissionDataProvider(e);return yield s.getPushPermission()})}getComputedPushPermission(e){return o(this,void 0,void 0,function*(){const s=yield r.DataProviderFactory.getPermissionDataProvider(e);return yield s.getPushPermission()})}isPushSupported(){return o(this,void 0,void 0,function*(){let e="location"in this.scope;if(e||(this.unsupportedReason="self.location not accessible"),!e||(e="navigator"in this.scope)||(this.unsupportedReason="self.navigator not accessible"),!e||(e="userAgent"in this.navigator)||(this.unsupportedReason="self.userAgent not accessible"),!e||(e=this.navigator.cookieEnabled)||(this.unsupportedReason="self.navigator.cookieEnabled is FALSE"),!e||(e="Notification"in this.scope)||(this.unsupportedReason="self.Notification not accessible"),!e||(e=this.isArrayFullySupported())||(this.unsupportedReason="required Array functionality not accessible"),!e||(e=!!this.location.host)||(this.unsupportedReason="self.location.host is undefined"),!e||(e=!!this.location.hostname)||(this.unsupportedReason="self.location.hostname is undefined"),e)try{e=!!this.location.hostname.split("")}catch(s){e=!1,this.unsupportedReason="self.location.hostname is not a valid String"}if(e){const t=/HeadlessChrome|googlebot|crawler|spider|robot|crawling|facebookexternalhit/im;(e=!t.test(this.navigator.userAgent))||(this.unsupportedReason="self.navigator.userAgent is recognizedBot"),!e||(e=!t.test(this.navigator.appVersion))||(this.unsupportedReason="self.navigator.appVersion is recognizedBot"),!e||(e=!t.test(this.navigator.appCodeName))||(this.unsupportedReason="self.navigator.appCodeName is recognizedBot"),!e||(e=!t.test(this.navigator.product))||(this.unsupportedReason="self.navigator.product is recognizedBot")}var s=this.isPushManagerInScope();if(e&&!s){const o=/iphone|ipad/i;(e=!o.test(this.navigator.userAgent))||(this.unsupportedReason="self.navigator.userAgent is iDevice"),!e||(e=!(this.navigator.platform&&o.test(this.navigator.platform)))||(this.unsupportedReason="self.navigator.platform is iDevice")}if(e&&this.isSafari()&&!s)!e||(e=this.isSafariPushCapable())||(this.unsupportedReason="self.safari.pushNotification is not accessible");else if(!e||(e="PushManager"in this.scope)||(this.unsupportedReason="self.PushManager is not accessible"),!e||(e="PushSubscription"in this.scope)||(this.unsupportedReason="self.PushSubscription is not accessible"),!e||(e=this.scope.PushSubscription.prototype.hasOwnProperty("getKey"))||(this.unsupportedReason="self.PushSubscription.prototype.getKey is not accessible"),(this.isHTTPS()||this.isDevMode())&&(e&&!(e="ServiceWorker"in this.scope)&&(this.unsupportedReason="self.ServiceWorker is not accessible"),e&&!(e="serviceWorker"in this.navigator)&&(this.unsupportedReason="self.navigator.serviceWorker is not accessible"),e&&!(e="ServiceWorkerRegistration"in this.scope)&&(this.unsupportedReason="self.ServiceWorkerRegistration is not accessible"),e&&!(e=this.scope.ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification"))&&(this.unsupportedReason="self.ServiceWorkerRegistration.prototype.showNotification is not accessible"),e))try{yield this.navigator.serviceWorker.getRegistration()}catch(s){e=!1,this.unsupportedReason="call to self.navigator.serviceWorker.getRegistration() failed"}return e})}}},"./src/sdk/models/context.model.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContextModel=void 0;e.ContextModel=class{constructor(){this.clock=0,this.s=!1}}},"./src/sdk/models/domains/domain.model.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DomainModel=e.DomainFrequencyCapMetric=void 0;const i=t("./src/_utils/domain-matching.ts"),o=t("./src/_utils/global-env.ts");(t=e.DomainFrequencyCapMetric||(e.DomainFrequencyCapMetric={})).DAYS="days",t.HOURS="hours",t.MINUTES="minutes";e.DomainModel=class{constructor(){this.flags=[],this.additionalSubscriptionData=[],this.promptGroups=[],this.prompts=[],this.isCached=!1}shouldReplaceExistingWorkerInPushlyScope(){return this.hasFlag("REPLACE_EXISTING_WORKERS")}shouldUnregisterNonPushlyWorkers(){return this.hasFlag("UNREGISTER_ALL_NON_PUSHLY_WORKERS")}shouldUseCustomVapidKey(){return!!this.vapidPublicKey}shouldUseVapid(){return"PushManager"in(0,o.getSelf)()}hasFlag(s){return Array.isArray(this.flags)&&-1!==this.flags.indexOf(s.toString().toUpperCase())}hasApnsConfig(){return!!this.apnsConfiguration}isApnsConfigEnabled(){return this.hasApnsConfig()&&!0===this.apnsConfiguration.is_active}getPushPackageSettings(){return(this.apnsConfiguration||{}).push_package||{}}getWebsitePushId(){return this.getPushPackageSettings().website_push_id}isEventOnlyMode(){const s=this.whitelistDomains||[],e=this.sdkEventOnlyDomains||["oceans3.deepbluedev.com"];var t=this.hasFlag("FEAT_SDK_EVENT_ONLY_DOMAINS"),o=s.some(i.domainMatchPredicate),n=e.some(i.domainMatchPredicate);return t&&o&&n}}},"./src/sdk/models/domains/global-prompt-referrer-conditions.model.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalPromptReferrerConditionsModel=void 0;const o=t("./src/sdk/enums/prompt-referrer-condition.enum.ts").PromptReferrerCondition.IGNORE;e.GlobalPromptReferrerConditionsModel=class n{constructor(){this.persist_ttl_seconds=259200}static parse(s){const e=new n;return s=s||{},e.enabled=s.enabled||!1,e.persist_ttl_seconds=s.persist_ttl_seconds||e.persist_ttl_seconds,e.when_self=s.when_self||o,e.when_blank=s.when_blank||o,e.allowed=s.allowed||void 0,e.blocked=s.blocked||void 0,e}}},"./src/sdk/models/events/base-streamable-event.model.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStreamableEventModel=void 0;const n=t("./src/sdk/constants.ts"),i=t("./src/sdk/utils.ts"),p=t("./src/sdk/enums/event-priority.enum.ts");e.BaseStreamableEventModel=class{constructor(s,e,t){this.type=s,this.additionalData=e,this.context=t,this.id=(0,i.randomString)(),this.eventDate=(new Date).toISOString()}getPostData(){return o(this,void 0,void 0,function*(){return Object.assign(Object.assign({},this.additionalData),{action:this.type,domain_id:this.context.domain.id,event_date:this.eventDate,meta:Object.assign(Object.assign({},this.additionalData.meta||{}),{event_id:this.id,source:{application:n.PUSHLY_SDK_APPLICATION_NAME,version:n.PUSHLY_APPLICATION_VERSION}})})})}getRequestObject(e,t){return o(this,void 0,void 0,function*(){let s={"content-type":"text/plain"};return t===p.EventPriority.IMMEDIATE&&(s["X-Event-Priority"]=t),{endpoint:e||n.EVENTS_ENDPOINT,method:"POST",headers:s,body:JSON.stringify(yield this.getPostData())}})}}},"./src/sdk/models/events/event.model.ts":(s,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventModel=void 0;e.EventModel=class{constructor(s,...e){this.type=s,this.data=e}}},"./src/sdk/models/events/eventable.model.ts":function(s,e,t){"use strict";var i=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.EventableModel=void 0;const p=t("./src/sdk/models/events/subscriber-streamable-event.model.ts"),o=(t("./src/sdk/enums/debug-cookie-code.enum.ts"),t("./src/sdk/utils.ts")),n=t("./src/common/data-providers/api.data-provider.ts"),r=t("./src/sdk/enums/steamable-event-type.enum.ts"),l=t("./src/sdk/data-providers/event.data-provider.ts");class u{constructor(){this.e=(0,o.randomString)()}static post(e,t,o){return i(this,void 0,void 0,function*(){var s=yield e.getRequestObject(t,o);return n.ApiDataProvider.exec(s.endpoint,s.method,s.headers,s.body,!1)})}static debug(e,t,o,n){return i(this,void 0,void 0,function*(){try{if(e.domain&&e.domain.hasFlag("SDK_DEBUG_EVENTS")){let s={};return t===r.StreamableEventType.PROMPT_NOT_SHOWN&&(s={prompt_not_shown_reason:o||"unknown"},n&&(s.error_message=n)),this.post(new p.SubscriberStreamableEventModel(t,{meta:s},e))}}catch(s){}})}static debugPromptNotShown(s,e,t){return i(this,void 0,void 0,function*(){return this.debug(s,r.StreamableEventType.PROMPT_NOT_SHOWN,e,t)})}watch(s,e){return l.EventManager.on(s,e)}watchOnce(s,e){return l.EventManager.once(s,e)}unwatch(s,e){l.EventManager.unregisterCallback(s,e)}dispatch(s){return i(this,void 0,void 0,function*(){yield l.EventManager.dispatch(s)})}post(s,e,t){return i(this,void 0,void 0,function*(){return u.post(s,e,t)})}debug(s,e,t){return i(this,void 0,void 0,function*(){return u.debug(s,e,t,null)})}debugPromptNotShown(s,e,t){return i(this,void 0,void 0,function*(){return u.debugPromptNotShown(s,e,t)})}}e.EventableModel=u},"./src/sdk/models/events/subscriber-streamable-event.model.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.SubscriberStreamableEventModel=void 0;const h=t("./src/_utils/consent.ts");var n=t("./src/sdk/models/events/base-streamable-event.model.ts");const d=t("./src/_utils/global-env.ts"),c=t("./src/sdk/utils.ts"),a=t("./src/sdk/data-providers/cookie.data-provider.ts");class i extends n.BaseStreamableEventModel{getPostData(){const u=Object.create(null,{getPostData:{get:()=>super.getPostData}});return o(this,void 0,void 0,function*(){var s=yield u.getPostData.call(this);let e,t,o,n,i,p,r,l;if(this.context.user||this.context.domain&&this.context.domain.hasFlag("SDK_DEBUG_EVENTS")){this.context.user&&(t=this.context.user.puuid,o=this.context.user.externalId,n=this.context.user.token,i=this.context.user.lastSeenPromptId),p=(0,d.getLocation)().href;try{r=Intl.DateTimeFormat().resolvedOptions().locale,l=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(s){}}if(!t)try{let s=a.CookieDataProvider.get("pushly.user_puuid");s||(s=(0,c.randomString)(),a.CookieDataProvider.set("pushly.user_puuid",s)),t=s}catch(s){}if(t&&/undefined/i.test(t.toString())&&(t=(0,c.randomString)(),a.CookieDataProvider.set("pushly.user_puuid",t)),e=Object.assign(Object.assign(Object.assign(Object.assign({},s),{domain_key:this.context.domainKey}),(0,h.buildSdkConsentEventData)(this.context)),{meta:Object.assign(Object.assign({},s.meta),{pushly_unique_user_id:t,external_id:o})}),this.context.env&&this.context.env.isSafari()&&!this.context.env.isPushManagerInScope()&&(e.meta.apns_token=n),e.meta){let s=e.meta;s.prompt_id=s.promptId||s.prompt_id,s.prompt_id||(s.prompt_id=i),delete s.promptId}return e.meta.page_url=p,e.meta.language=r,e.meta.time_zone=l,e})}}e.SubscriberStreamableEventModel=i},"./src/sdk/models/users/user.model.ts":function(s,e){"use strict";var t=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.UserModel=void 0;e.UserModel=class o{constructor(){this.subscriberState="none",this.isInUdr=!1}static of(s){const e=new o;return Object.assign(e,s),e.subscriberState||(e.subscriberState="none"),e}isUnsubscribed(s){return t(this,void 0,void 0,function*(){return"unsubscribed"===this.subscriberState&&"default"===(yield this.getComputedPushPermission(s)).permission||this.isInUdr})}getComputedPushPermission(s){return t(this,void 0,void 0,function*(){return this._computedPushPermission||(this._computedPushPermission=yield this.env.getComputedPushPermission(s)),this._computedPushPermission})}getLocalPushPermission(s,e=!1){return t(this,void 0,void 0,function*(){return this._localPushPermission&&!e||(this._localPushPermission=yield this.env.getLocalPushPermission(s)),this._localPushPermission})}setPushPermission(s){this._localPushPermission=s,this._computedPushPermission=s}isSubscribed(s){return t(this,void 0,void 0,function*(){return("subscribed"===this.subscriberState||"granted"===(yield this.getComputedPushPermission(s)).permission)&&!this.isInUdr})}isDismissed(){return"dismissed"===this.subscriberState}isBlocked(){return"blocked"===this.subscriberState}isEligibleToPrompt(s){return t(this,void 0,void 0,function*(){return!(yield this.isSubscribed(s))&&!this.isDismissed()&&!this.isBlocked()})}}},"./src/sdk/prompts/base.prompt.ts":function(s,e,t){"use strict";var u=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.BasePrompt=void 0;const h=t("./src/sdk/utils.ts"),o=t("./src/sdk/enums/prompt-style.enum.ts"),n=t("./src/sdk/models/events/event.model.ts"),i=t("./src/sdk/enums/event-type.enum.ts"),d=t("./src/sdk/services/user.service.ts"),l=t("./src/sdk/enums/prompt-referrer-condition.enum.ts"),p=t("./src/sdk/models/domains/global-prompt-referrer-conditions.model.ts"),r=t("./src/sdk/factories/data-provider-factory.ts"),c=t("./src/sdk/services/logging.service.ts");class a extends t("./src/sdk/models/events/eventable.model.ts").EventableModel{constructor(s,e,t=!0){super(),this.context=s,this.settings=e,this.envSupported=t,this.userReferrerIsAllowed=!0,this.bypassEligibilityCheck=!1,t&&(c.Logger.info(`Preloading ${this.style} prompt ${this.promptId}, `+this.name),this._wireEvents())}get groupId(){return this.settings.group.id}get promptId(){return this.settings.prompt.id}get style(){return this.settings.prompt.style}get name(){let s=this.settings.group.name;return s=this.settings.prompt.name?s+" - "+this.settings.prompt.name:s}get promptConfig(){return this.settings.prompt.config||{}}get promptConditions(){return this.settings.prompt.conditions_json||{}}isNativePrompt(){return this.style===o.PromptStyle.Native}isSlidePrompt(){return this.style===o.PromptStyle.Slide}isBellPrompt(){return this.style===o.PromptStyle.Bell}get isUserSubscribed(){return this.context.user.isSubscribed(this.context)}run(s){return u(this,void 0,void 0,function*(){this.bypassEligibilityCheck=!!s&&!!s.bypassEligibilityCheck,this.userReferrerIsAllowed=yield this._evaluateCurrentReferrer()})}_attemptToShow(){return u(this,void 0,void 0,function*(){yield(0,h.delay)(Math.floor(50*Math.random()))})}_show(){return u(this,void 0,void 0,function*(){c.Logger.info(`Showing prompt ${this.promptId}, `+this.name),this.dispatch(new n.EventModel(i.EventType.PROMPT_SHOWN,this._buildDispatchEventPack())),this._incrementUserPromptCount(),yield this._setLastSeenPromptId()})}_buildDispatchEventPack(){return u(this,void 0,void 0,function*(){return{prompt:{id:this.promptId,keywords:[]},subscribed:this.isUserSubscribed}})}_buildPostEventPack(){return u(this,void 0,void 0,function*(){return{meta:{promptId:this.promptId,subscribed:yield this.isUserSubscribed}}})}_incrementUserPromptCount(){try{var s=this.isNativePrompt()||this.isSlidePrompt(),e=!!this.context.domain&&!!this.context.domain.frequencyCaps&&!!this.context.domain.frequencyCaps.prompt;if(s&&e){var t,o=this.context.domain.frequencyCaps.prompt.fcap_seconds;if(0<o){const n=this.context.user.promptCountState;let s=0,e=new Date;e.setTime(e.getTime()+1e3*o),!n||2===(t=n.split("|")).length&&(s=parseInt(t[0],10),e=t[1]),e instanceof Date&&(e=e.toUTCString()),d.UserService.setPromptState(this.context.user,o,s+1+"|"+e,e)}}}catch(s){c.Logger.warn("Encountered an error while updating prompt frequency cap",s)}}_setLastSeenPromptId(){return u(this,void 0,void 0,function*(){(yield this.isUserSubscribed)||(yield d.UserService.setLastSeenPromptId(this.context.user,this.promptId))})}_canShow(){return u(this,void 0,void 0,function*(){var s=this._isPlacementEnabled();return(yield this._isUserEligibleToPrompt())&&s})}_isPlacementEnabled(){let s=!1;var e="desktop"===this.context.env.getDeviceType(),t=this.promptConfig.position||{},o="disabled"!==t.desktop,t="disabled"!==t.mobile;return s=e&&o||!e&&t?!0:s}_isCustomOrBaseSubStateEligible(){return u(this,void 0,void 0,function*(){var s=yield this.context.user.getComputedPushPermission(this.context);return this.style===o.PromptStyle.Custom||"denied"!==s.permission})}_isUserEligibleToPrompt(){return u(this,void 0,void 0,function*(){let e=!1;if(this.bypassEligibilityCheck)e=yield this._isCustomOrBaseSubStateEligible();else{const o=this.context.user;var t=yield this.context.user.isEligibleToPrompt(this.context),t=this.isBellPrompt()||t;let s=!0;t&&(this.isNativePrompt()||this.isSlidePrompt())&&(s=this._evaluateFcapConditions()),this.userReferrerIsAllowed?t?s?e=!0:this.debugPromptNotShown(this.context,"prompt_ineligible_fcap"):o.isBlocked()?this.debugPromptNotShown(this.context,"user_permission_denied"):o.isDismissed()?this.debugPromptNotShown(this.context,"user_permission_dismissed"):(yield o.isSubscribed(this.context))?this.debugPromptNotShown(this.context,"user_permission_granted"):this.debugPromptNotShown(this.context,"user_ineligible"):this.debugPromptNotShown(this.context,"referrer_"+this.userReferrerState)}return e})}_evaluateRunConditions(){return u(this,void 0,void 0,function*(){return new Promise(l=>u(this,void 0,void 0,function*(){const o=this.promptConfig.behavior||{},n=this.promptConditions.visitor||{},i=!!n.time_on_page_seconds,t=!!n.session_page_views,p=!!n.session_time_on_site_seconds,s=new Promise(e=>u(this,void 0,void 0,function*(){if(t)if(yield this._evaluateSessionPageViewConditions())e();else{c.Logger.info(`Prompt condition: Page views [at least ${n.session_page_views} pages]`);const s=setInterval(()=>u(this,void 0,void 0,function*(){(yield this._evaluateSessionPageViewConditions())&&(clearInterval(s),e())}),1e3)}else e()})),e=new Promise(e=>u(this,void 0,void 0,function*(){if(p)if(yield this._evaluateSessionTimeOnSiteConditions())e();else{c.Logger.info(`Prompt condition: Time on site [at least ${n.session_time_on_site_seconds} seconds]`);const s=setInterval(()=>u(this,void 0,void 0,function*(){(yield this._evaluateSessionTimeOnSiteConditions())&&(clearInterval(s),e())}),1e3)}else e()})),r=new Promise(t=>u(this,void 0,void 0,function*(){var s=self._swclk_||0;let e=o.delay_seconds||0;i&&(e=n.time_on_page_seconds||0,c.Logger.info(`Prompt condition: Time on page [at least ${e} seconds]`)),(e=e>s?e-s:0)<0&&(e=0),yield(0,h.delay)(1e3*e),t()}));yield Promise.all([s.then(()=>{t&&c.Logger.info("Prompt condition: Page views [satisfied]")}),e.then(()=>{p&&c.Logger.info("Prompt condition: Time on site [satisfied]")}),r.then(()=>{i&&c.Logger.info("Prompt condition: Time on page [satisfied]")})]),l()}))})}_evaluateSessionPageViewConditions(){return u(this,void 0,void 0,function*(){const s=yield r.DataProviderFactory.getSessionDataProvider(this.context);let e=!1;var t=this.promptConditions.visitor.session_page_views,o=yield s.getCurrentTotalPageViews();return e=t<=o?!0:e})}_evaluateSessionTimeOnSiteConditions(){return u(this,void 0,void 0,function*(){const s=yield r.DataProviderFactory.getSessionDataProvider(this.context);let e=!1;var t=Date.now(),o=(yield s.getCurrentSession()).sessionStart,n=this.promptConditions.visitor.session_time_on_site_seconds;return e=n<=(t-o)/1e3?!0:e})}_evaluateFcapConditions(){let s=!0,e=0;try{var t=this.isNativePrompt()||this.isSlidePrompt(),o=!!this.context.domain&&!!this.context.domain.frequencyCaps&&!!this.context.domain.frequencyCaps.prompt;if(t)if(o){var n=this.context.domain.frequencyCaps.prompt;const l=this.context.user.promptCountState;var i=this.context.user.promptFcapSeconds;if(String(i)!==String(n.fcap_seconds))d.UserService.clearPromptFcapState();else if(l){var p=l.split("|");if(2===p.length){var r=p[1];if(((0,h.tryParseInt)(p[0])||0)>=n.occurrences){s=!1;try{e=Math.floor((Date.parse(r)-(new Date).getTime())/1e3)}catch(s){}}}}}else d.UserService.clearPromptFcapState()}catch(s){c.Logger.warn("Encountered an error while checking prompt frequency cap")}return s||c.Logger.info("Prompt frequency cap has been met"+(0<e?` - ${e} seconds remain`:"")),s}_evaluateCurrentReferrer(){return u(this,void 0,void 0,function*(){let s=!0;var e;return!0!==this.bypassEligibilityCheck&&(e=this.context.domain.globalPromptSettings)&&e.referrers&&(e=e.referrers,(e=p.GlobalPromptReferrerConditionsModel.parse(e)).enabled&&(e=yield this._evaluateReferrerConditions(e),this.userReferrerState=e.referrerResponse,s=e.pass)),s||c.Logger.info(`Based on client referrer, prompt, ${this.promptId}, is currently disabled`),s})}_evaluateReferrerConditions(p){return u(this,void 0,void 0,function*(){let s={pass:!0,referrerResponse:l.PromptReferrerCondition.ALLOW},e=this.context.env.referrer;var t=this.context.user.lastReferrerState,o=yield this._evaluateExistingReferrerState(p,t,e),t=!(e=t&&!o.updateRequired?o.referrer:e)||""===e;const n=String(e);var i=!t&&-1!==n.indexOf(this.context.domain.name);return!((s=t?a._evaluateSimpleReferrerCondition(p.when_blank,s):i?a._evaluateSimpleReferrerCondition(p.when_self,s):this._evaluateExternalReferrerConditions(p,s,e)).referrerResponse===l.PromptReferrerCondition.IGNORE)&&o.updateRequired&&(yield d.UserService.setLastReferrerState(this.context.user,n)),s})}_evaluateExistingReferrerState(o,n,i){return u(this,void 0,void 0,function*(){const s={referrer:i,updateRequired:!1};if(n&&n.lastSetAt){const t=new Date;var e=(t.getTime()-n.lastSetAt)/1e3;(o.persist_ttl_seconds||0)<e?(yield d.UserService.clearLastReferrerState(this.context.user),s.updateRequired=!0):s.referrer=n.referrer}return s})}static _evaluateSimpleReferrerCondition(s,e){const t=Object.assign({},e);switch(s){case l.PromptReferrerCondition.IGNORE:t.pass=!1,t.referrerResponse=l.PromptReferrerCondition.IGNORE;break;case l.PromptReferrerCondition.BLOCK:t.pass=!1,t.referrerResponse=l.PromptReferrerCondition.BLOCK}return t}_evaluateExternalReferrerConditions(s,e,t){const o=Object.assign({},e);let n=!0,i=!0,p=!1,r=!1;s.allowed&&(Array.isArray(s.allowed.contains)&&(i=s.allowed.contains.some(s=>-1!==t.indexOf(s))),Array.isArray(s.allowed.exact)&&(n=s.allowed.exact.some(s=>t===s))),s.blocked&&(Array.isArray(s.blocked.contains)&&(r=s.blocked.contains.some(s=>-1!==t.indexOf(s))),Array.isArray(s.blocked.exact)&&(p=s.blocked.exact.some(s=>t===s)));e=n||i,s=p||r;return e&&!s||(o.pass=!1,o.referrerResponse=l.PromptReferrerCondition.BLOCK),o}}e.BasePrompt=a},"./src/sdk/prompts/bell.prompt.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.BellPrompt=void 0,t("./src/sdk/prompts/dom.prompt.ts"));const i=t("./src/sdk/constants.ts"),p=t("./src/sdk/models/events/event.model.ts"),r=t("./src/sdk/enums/event-type.enum.ts"),l=t("./src/sdk/services/logging.service.ts"),u=t("./src/sdk/enums/bell-prompt-display-behavior.enum.ts"),h={"top-left":"d-top-left","top-right":"d-top-right","bottom-right":"d-bottom-right","bottom-left":"d-bottom-left",disabled:"d-disabled"},d={"top-left":"m-top-left","top-right":"m-top-right","bottom-right":"m-bottom-right","bottom-left":"m-bottom-left",disabled:"m-disabled"};let c=null;class a extends n.DomPrompt{_wireEvents(){var s=this._handleFlowLoaded.bind(this),e=this._handleShowPrompt.bind(this),t=this._handleHidePrompt.bind(this),o=this._handleSubscription.bind(this),n=this._handleUnsubscription.bind(this),i=[r.EventType.REGISTRATION_SUBSCRIBED,r.EventType.REGISTRATION_MIGRATED],p=[r.EventType.PERMISSION_DISMISSED,r.EventType.PERMISSION_DENIED];this.watch(r.EventType.FLOW_LOADED,s),this.watch(r.EventType.PROMPT_SHOW,e),this.watch(p,t),this.watch(i,o),this.watch(r.EventType.REGISTRATION_UNSUBSCRIBED,n)}_wireElementEvents(){var s=this._handleButtonMouseOver.bind(this),e=this._handleButtonMouseOut.bind(this),t=this._handleButtonClick.bind(this),o=this._handleWindowResize.bind(this);this.svgBtn.addEventListener("mouseover",s),this.svgBtn.addEventListener("mouseout",e),this.svgBtn.addEventListener("click",t),!0===this.promptConfig.preview_mode&&this.svgBtn.removeEventListener("click",t),this.context.env.scope.addEventListener("resize",o)}attachToDom(e){const t=Object.create(null,{attachToDom:{get:()=>super.attachToDom}});return o(this,void 0,void 0,function*(){var s;yield t.attachToDom.call(this,e),this.parentReady&&(s=yield this._buildTemplate(),this.parent.appendChild(s),this._wireElementEvents())})}run(s={}){const e=Object.create(null,{run:{get:()=>super.run}});return o(this,void 0,void 0,function*(){yield e.run.call(this,s),(yield this._canShow())?(this.dispatch(new p.EventModel(r.EventType.PROMPT_ELIGIBLE,this._buildDispatchEventPack())),yield this._evaluateDisplayBehavior(!!this.bypassEligibilityCheck)):this.dispatch(new p.EventModel(r.EventType.PROMPT_INELIGIBLE,this._buildDispatchEventPack()))})}_attemptToShow(e=!1){return o(this,void 0,void 0,function*(){var s=this.settings.prompt.is_auto_show||e;this._isPlacementEnabled()?(yield this._canShow())&&s&&(yield this._evaluateRunConditions(),yield this._show()):l.Logger.info("Current prompt is not enabled for this placement")})}_show(){const s=Object.create(null,{_show:{get:()=>super._show}});return o(this,void 0,void 0,function*(){yield s._show.call(this)})}_buildTemplate(){return o(this,void 0,void 0,function*(){if(!this.element){const s=["pushly_bell",(yield this.isUserSubscribed)?"subscribed":"not-subscribed",this.promptConfig.managed?"managed":"non-managed",h[this.promptTheme.position.desktop],d[this.promptTheme.position.mobile]];this.element=this._createDivElement({className:s.join(" ")}),this.svgBtn=this._createSvgElement("0 0 512 512"),this.svgBtn.innerHTML=`
<circle fill="${this.promptTheme.primary_color}" cx="256" cy="256" r="255.059" />
<path fill="${this.promptTheme.accent_color}" d="M256,46.349C140.398,46.349,46.349,140.398,46.349,256c0,115.603,94.049,209.651,209.651,209.651
    c115.603,0,209.651-94.049,209.651-209.651C465.651,140.398,371.603,46.349,256,46.349z M256,450.411
    c-107.198,0-194.41-87.213-194.41-194.411c0-107.198,87.212-194.41,194.41-194.41c107.198,0,194.411,87.212,194.411,194.41
    C450.411,363.198,363.198,450.411,256,450.411z" />
<g>
    <path fill="${this.promptTheme.accent_color}" d="M341.024,293.378v-58.851c0-41.452-28.823-76.096-67.492-85.197c-0.235-10.897-9.101-19.647-20.033-19.647
        c-10.941,0-19.847,8.789-20.076,19.647c-38.669,9.101-67.495,43.745-67.495,85.197v58.851c-14.569,0-26.369,11.797-26.369,26.365
        v18.603h227.829v-18.603C367.389,305.175,355.596,293.378,341.024,293.378z" />
    <path fill="${this.promptTheme.accent_color}" d="M253.5,381.699c17.454,0,32.062-11.757,36.661-27.781h-73.376C221.393,369.942,236,381.699,253.5,381.699z" />
</g>
        `.trim(),this.tooltipContainer=this._createDivElement({className:"pushly_bell-tooltip-container"}),this.tooltipContainer.innerHTML=`
<div class="pushly_bell-tooltip pushly_bell-tooltip-subscribed" ${this.promptTheme.tooltip.subscribed?"":'style="display: none;"'}>
    <div class="pushly_bell-tooltip-arrow" style="background-color: ${this.promptTheme.primary_color};"></div>
    <div class="pushly_bell-tooltip-text" style="background-color: ${this.promptTheme.primary_color}; color: ${this.promptTheme.accent_color};">${this.promptTheme.tooltip.subscribed}</div>
</div>
<div class="pushly_bell-tooltip pushly_bell-tooltip-notsubscribed" ${this.promptTheme.tooltip.unsubscribed?"":'style="display: none;"'}>
    <div class="pushly_bell-tooltip-arrow" style="background-color: ${this.promptTheme.primary_color};"></div>
    <div class="pushly_bell-tooltip-text" style="background-color: ${this.promptTheme.primary_color}; color: ${this.promptTheme.accent_color};">${this.promptTheme.tooltip.unsubscribed}</div>
</div>
        `.trim(),this.element.appendChild(this.svgBtn),this.element.appendChild(this.tooltipContainer),this._updateSize()}return this.element})}_updateSize(){let s=this.promptTheme.size;this.context.env.scope.innerWidth<i.MOBILE_MAX_SIZE&&this.promptTheme.mobile_size&&(s=this.promptTheme.mobile_size),this.svgBtn.setAttribute("height",s),this.svgBtn.style.height=s,this.svgBtn.setAttribute("width",s),this.svgBtn.style.width=s}_handleFlowLoaded(){return o(this,void 0,void 0,function*(){yield this.run()})}_handleShowPrompt(){return o(this,void 0,void 0,function*(){this.context.app.loadConfig.manualPromptMode||this.element.classList.contains(i.DEFAULT_CLASSNAME_PROMPT_VISIBLE)||(yield this._evaluateDisplayBehavior(!0))})}_handleHidePrompt(){return o(this,void 0,void 0,function*(){yield this._hide()})}_handleSubscription(){return o(this,void 0,void 0,function*(){return this.element.classList.add("subscribed"),this._evaluateDisplayBehavior()})}_handleUnsubscription(){return o(this,void 0,void 0,function*(){return this.element.classList.remove("subscribed"),this._evaluateDisplayBehavior()})}_evaluateDisplayBehavior(n=!1){return o(this,void 0,void 0,function*(){var s,e,t=yield this.isUserSubscribed,o=this.promptConfig.behavior;o&&(s=o.display_behavior===u.BellPromptDisplayBehavior.PRE_SUBSCRIPTION,e=o.display_behavior===u.BellPromptDisplayBehavior.POST_SUBSCRIPTION,o.display_behavior===u.BellPromptDisplayBehavior.ALWAYS?(l.Logger.info("Bell prompt display mode: always.","User Subscribed: "+(t?"true":"false")),yield this._attemptToShow()):s?(l.Logger.info("Bell prompt display mode: pre-subscription.","User Subscribed: "+(t?"true":"false")),t?yield this._hide():yield this._attemptToShow(n)):e&&(l.Logger.info("Bell prompt display mode: post-subscription.","User Subscribed: "+(t?"true":"false")),t?yield this._attemptToShow(n):yield this._hide()))})}_handleButtonClick(){return o(this,void 0,void 0,function*(){(yield this.isUserSubscribed)||(yield this._allow())})}_handleButtonMouseOver(){return o(this,void 0,void 0,function*(){this.element.classList.add("hover")})}_handleButtonMouseOut(){return o(this,void 0,void 0,function*(){this.element.classList.remove("hover")})}_handleWindowResize(){return o(this,void 0,void 0,function*(){c&&clearTimeout(c),c=setTimeout(()=>{c=null,this._updateSize()},50)})}}e.BellPrompt=a},"./src/sdk/prompts/custom.prompt.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.CustomPrompt=void 0,t("./src/sdk/prompts/dom.prompt.ts"));const i=t("./src/sdk/constants.ts"),p=t("./src/sdk/models/events/event.model.ts"),r=t("./src/sdk/enums/event-type.enum.ts"),l=t("./src/sdk/services/logging.service.ts");class u extends n.DomPrompt{constructor(){super(...arguments),this.allowBtns=[],this.dismissBtns=[]}_wireEvents(){var s=this._handleShowPrompt.bind(this),e=this._handlePermissionGranted.bind(this),t=this._handlePermissionDismissed.bind(this),o=this._handlePermissionDenied.bind(this),n=[r.EventType.REGISTRATION_SUBSCRIBED,r.EventType.REGISTRATION_MIGRATED,r.EventType.PERMISSION_GRANTED,r.EventType.FOLLOWED],i=[r.EventType.PROMPT_DISMISSED,r.EventType.PERMISSION_DISMISSED],p=[r.EventType.PERMISSION_DENIED];this.watch(r.EventType.PROMPT_SHOW,s),this.watch(n,e),this.watch(i,t),this.watch(p,o)}_locateAndAssignElement(){const e=setInterval(()=>o(this,void 0,void 0,function*(){var s=this.parent.getElementsByClassName(i.DEFAULT_CLASSNAME_PROMPT_CUSTOM);s&&0<s.length&&(clearInterval(e),this.element=s[0],this.envSupported?(this._setSupportedClassname(),yield this._setInitialSubscriptionClassname(),this._resolveKeywords(),this._assignButtonElements()):this._setUnsupportedClassname())}),500)}attachToDom(){const s=Object.create(null,{attachToDom:{get:()=>super.attachToDom}});return o(this,void 0,void 0,function*(){yield s.attachToDom.call(this),yield this._locateAndAssignElement()})}runInUnsupportedMode(){return o(this,void 0,void 0,function*(){yield this.attachToDom()})}_run(){return o(this,void 0,void 0,function*(){l.Logger.info("Custom prompt ready"),(yield this._isUserEligibleToPrompt())?(this._setEligibleClassnames(),this.dispatch(new p.EventModel(r.EventType.PROMPT_ELIGIBLE,this._buildDispatchEventPack()))):(this._setIneligibleClassnames(),this.dispatch(new p.EventModel(r.EventType.PROMPT_INELIGIBLE,this._buildDispatchEventPack())))})}_attemptToShow(s=0){return o(this,void 0,void 0,function*(){this.bypassEligibilityCheck&&this._setEligibleClassnames(),(yield this._isUserEligibleToPrompt())?this._setEligibleClassnames():this._setIneligibleClassnames()})}_show(){return o(this,void 0,void 0,function*(){})}_assignButtonElements(){return o(this,void 0,void 0,function*(){var s=this.element.getElementsByClassName(i.DEFAULT_CLASSNAME_PROMPT_BTN_ALLOW),e=this.element.getElementsByClassName(i.DEFAULT_CLASSNAME_PROMPT_BTN_DISMISS);s&&0<s.length?Array.from(s).forEach(s=>{s.addEventListener("click",this._allow.bind(this)),this.allowBtns.push(s)}):l.Logger.warn("Prompt allow button cannot be located"),e&&0<e.length?Array.from(e).forEach(s=>{s.addEventListener("click",this._dismiss.bind(this)),this.dismissBtns.push(s)}):l.Logger.warn("Prompt dismiss button cannot be located"),yield this._run()})}_getConfigClassNames(){const s=this.context.app.classNames||{};return s.webPushUnsupported=s.webPushUnsupported||i.DEFAULT_CLASSNAME_WEB_PUSH_UNSUPPORTED,s.webPushSupported=s.webPushSupported||i.DEFAULT_CLASSNAME_WEB_PUSH_SUPPORTED,s.subscriptionNone=s.subscriptionNone||i.DEFAULT_CLASSNAME_SUBSCRIPTION_NONE,s.subscriptionSubscribed=s.subscriptionSubscribed||i.DEFAULT_CLASSNAME_SUBSCRIPTION_TRUE,s.subscriptionUnsubscribed=s.subscriptionUnsubscribed||i.DEFAULT_CLASSNAME_SUBSCRIPTION_FALSE,s.subscriptionDenied=s.subscriptionDenied||i.DEFAULT_CLASSNAME_SUBSCRIPTION_DENIED,s.subscriptionDismissed=s.subscriptionDismissed||i.DEFAULT_CLASSNAME_SUBSCRIPTION_DISMISSED,s.promptIneligible=s.promptIneligible||i.DEFAULT_CLASSNAME_PROMPT_INELIGIBLE,s.promptEligible=s.promptEligible||i.DEFAULT_CLASSNAME_PROMPT_ELIGIBLE,s}_setInitialSubscriptionClassname(){return o(this,void 0,void 0,function*(){this.context.user.isBlocked()?this._setDeniedClassnames():this.context.user.isDismissed()?this._setDismissedClassnames():(yield this.isUserSubscribed)?this._setSubscribedClassnames():this._setNoSubscriptionClassnames()})}_setPromptCompositeSubscribedClassnames(){this._setIneligibleClassnames(),this._setSubscribedClassnames(),this.element.classList.remove(i.DEFAULT_CLASSNAME_PROMPT_VISIBLE)}_setSubscriptionDismissedClassnames(){this._setIneligibleClassnames(),this._setDismissedClassnames(),this.element.classList.remove(i.DEFAULT_CLASSNAME_PROMPT_VISIBLE)}_setSubscriptionDeniedClassnames(){this._setIneligibleClassnames(),this._setDeniedClassnames(),this.element.classList.remove(i.DEFAULT_CLASSNAME_PROMPT_VISIBLE)}_setUnsupportedClassname(){var s=this._getConfigClassNames();this.element.classList.add(s.webPushUnsupported),this.element.classList.remove(s.webPushSupported)}_setSupportedClassname(){var s=this._getConfigClassNames();this.element.classList.add(s.webPushSupported),this.element.classList.remove(s.webPushUnsupported)}_setEligibleClassnames(){var s=this._getConfigClassNames();this.element.classList.remove(s.promptIneligible),this.element.classList.add(s.promptEligible)}_setIneligibleClassnames(){var s=this._getConfigClassNames();this.element.classList.remove(s.promptEligible),this.element.classList.add(s.promptIneligible)}_setNoSubscriptionClassnames(){var s=this._getConfigClassNames();this.element.classList.add(s.subscriptionNone),this.element.classList.remove(s.subscriptionSubscribed,s.subscriptionDismissed,s.subscriptionDenied,s.subscriptionUnsubscribed)}_setSubscribedClassnames(){var s=this._getConfigClassNames();this.element.classList.add(s.subscriptionSubscribed),this.element.classList.remove(s.subscriptionNone,s.subscriptionDismissed,s.subscriptionDenied,s.subscriptionUnsubscribed)}_setDismissedClassnames(){var s=this._getConfigClassNames();this.element.classList.add(s.subscriptionDismissed),this.element.classList.remove(s.subscriptionNone,s.subscriptionSubscribed,s.subscriptionDenied,s.subscriptionUnsubscribed)}_setDeniedClassnames(){var s=this._getConfigClassNames();this.element.classList.add(s.subscriptionDenied),this.element.classList.remove(s.subscriptionNone,s.subscriptionSubscribed,s.subscriptionDismissed,s.subscriptionUnsubscribed)}_handleShowPrompt(){return o(this,void 0,void 0,function*(){var s;this.context.app.loadConfig.manualPromptMode||(s=yield this._isUserEligibleToPrompt(),!this.element.classList.contains(i.DEFAULT_CLASSNAME_PROMPT_VISIBLE)&&s&&(yield this._attemptToShow(!0)))})}_handlePermissionGranted(){return o(this,void 0,void 0,function*(){this._setPromptCompositeSubscribedClassnames(),yield this._hide()})}_handlePermissionDismissed(){return o(this,void 0,void 0,function*(){this._setSubscriptionDismissedClassnames(),yield this._hide()})}_handlePermissionDenied(){return o(this,void 0,void 0,function*(){this._setSubscriptionDeniedClassnames(),yield this._hide()})}}e.CustomPrompt=u},"./src/sdk/prompts/dom.prompt.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.DomPrompt=void 0,t("./src/sdk/prompts/base.prompt.ts"));const i=t("./src/sdk/constants.ts"),p=t("./src/sdk/models/events/subscriber-streamable-event.model.ts"),r=t("./src/sdk/models/events/event.model.ts"),l=t("./src/sdk/enums/prompt-style.enum.ts"),u=t("./src/sdk/enums/steamable-event-type.enum.ts"),h=t("./src/sdk/enums/event-type.enum.ts"),d=t("./src/sdk/services/user.service.ts"),c=t("./src/sdk/services/logging.service.ts"),a=t("./src/sdk/utils.ts");let m=0;class y extends n.BasePrompt{constructor(s,e,t=!0){super(s,e,t),this.parentReady=!1,this._handlePromptAllowedError=s=>o(this,void 0,void 0,function*(){/prompting has been disabled/i.test(String(s))&&this.dispatch(new r.EventModel(h.EventType.PROMPT_DISABLED,yield this._buildDispatchEventPack(),this.context,this,{message:s}))}),t&&this._wireRenderEvent()}_wireRenderEvent(){var s=this._handleFlowLoadedRender.bind(this);this.watchOnce(h.EventType.FLOW_LOADED,s)}get promptTheme(){return this.promptConfig.theme||{}}attachToDom(e){return o(this,void 0,void 0,function*(){var s;this.element||(s=this.context.env.document.body,this.parent=e||s,this.parent?this.parentReady=!0:m<5?(c.Logger.info(`Prompt parent element, ${String(this.parent)}, could not be resolved. Attempts: `+m),m++,yield(0,a.delay)(100*m*2),yield this.attachToDom(e)):c.Logger.warn(`Prompt parent element, ${String(this.parent)}, unavailable`))})}_canShow(){const e=Object.create(null,{_canShow:{get:()=>super._canShow}});return o(this,void 0,void 0,function*(){var s=yield e._canShow.call(this);return!!this.element&&s})}_show(){return o(this,void 0,void 0,function*(){c.Logger.info(`Showing prompt ${this.promptId}, `+this.name),this._incrementUserPromptCount(),yield this._setLastSeenPromptId(),this._addVisibleClassName();const s=yield this._buildPostEventPack();this._hasKeywords()&&(s.meta.keywords=this.keywords),(yield this.isUserSubscribed)?this.style===l.PromptStyle.Custom&&(this.dispatch(new r.EventModel(h.EventType.FOLLOW_SHOWN,yield this._buildDispatchEventPack())),this.post(new p.SubscriberStreamableEventModel(u.StreamableEventType.FOLLOW_SHOWN,s,this.context))):(this.dispatch(new r.EventModel(h.EventType.PROMPT_SHOWN,yield this._buildDispatchEventPack())),this.post(new p.SubscriberStreamableEventModel(u.StreamableEventType.PROMPT_SHOWN,s,this.context)))})}_hide(){return o(this,void 0,void 0,function*(){this._removeVisibleClassName(),this.dispatch(new r.EventModel(h.EventType.PROMPT_HIDE,yield this._buildDispatchEventPack()))})}_allow(s){return o(this,void 0,void 0,function*(){const s=yield this._buildPostEventPack();this._hasKeywords()&&(s.meta.keywords=this.keywords),(yield this.isUserSubscribed)?this.style===l.PromptStyle.Custom&&(this.dispatch(new r.EventModel(h.EventType.FOLLOWED,this._buildDispatchEventPack())),this.post(new p.SubscriberStreamableEventModel(u.StreamableEventType.FOLLOWED,s,this.context))):(this.dispatch(new r.EventModel(h.EventType.PROMPT_ALLOWED,this._buildDispatchEventPack(),this.context,this)).catch(this._handlePromptAllowedError),this.post(new p.SubscriberStreamableEventModel(u.StreamableEventType.PROMPT_ALLOWED,s,this.context)))})}_dismiss(s){return o(this,void 0,void 0,function*(){yield this._hide(),this.dispatch(new r.EventModel(h.EventType.PROMPT_DISMISSED,this._buildDispatchEventPack())),this.post(new p.SubscriberStreamableEventModel(u.StreamableEventType.PROMPT_DISMISSED,yield this._buildPostEventPack(),this.context)),yield d.UserService.setPromptDismissed(this.context.user,this)})}_addVisibleClassName(){this.element&&this.element.classList.add(i.DEFAULT_CLASSNAME_PROMPT_VISIBLE)}_removeVisibleClassName(){this.element&&this.element.classList.remove(i.DEFAULT_CLASSNAME_PROMPT_VISIBLE)}_resolveKeywords(){try{if(this.element){const e=(this.element.dataset||{}).keywords||"";if(""!==e.trim()){const t=e.toString().split(",");var s=t.map(s=>s.toString().trim());this.keywords=[...Array.from(new Set(s))]}}}catch(s){c.Logger.warn("Could not resolve prompt keywords - "+s.message)}}_hasKeywords(){return!!this.keywords&&Array.isArray(this.keywords)&&0<this.keywords.length}_buildDispatchEventPack(){const e=Object.create(null,{_buildDispatchEventPack:{get:()=>super._buildDispatchEventPack}});return o(this,void 0,void 0,function*(){const s=yield e._buildDispatchEventPack.call(this);return s.keywords=this.keywords||[],s})}_handleFlowLoadedRender(){return o(this,void 0,void 0,function*(){yield this.attachToDom()})}_createDivElement(s={}){return this._createDomElement("div",s)}_createButtonElement(s={}){return this._createDomElement("button",s)}_createImgElement(s,e){const t=this._createDomElement("img");return s&&(t.src=s),e&&(t.alt=e),t}_createSvgElement(s){const e=this.context.env.document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("viewBox",s),e}_createDomElement(s,e={}){const t=this.context.env.document.createElement(s);return e.className&&t.setAttribute("class",e.className),e.style&&t.setAttribute("style",e.style),e.innerText&&(t.innerText=e.innerText),t}}e.DomPrompt=y},"./src/sdk/prompts/native.prompt.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.NativePrompt=void 0,t("./src/sdk/prompts/base.prompt.ts"));const i=t("./src/sdk/models/events/event.model.ts"),p=t("./src/sdk/enums/exception-message.enum.ts"),r=t("./src/sdk/enums/runtime-environment.enum.ts"),l=t("./src/sdk/enums/event-type.enum.ts"),u=t("./src/sdk/services/logging.service.ts"),h=t("./src/sdk/enums/integration-type.enum.ts"),d=t("./src/sdk/exceptions/fail.exception.ts");class c extends n.BasePrompt{constructor(){super(...arguments),this.shown=!1}_wireEvents(){var s=this._handleFlowLoaded.bind(this),e=this._handleShowPrompt.bind(this);this.watch(l.EventType.FLOW_LOADED,s),this.watch(l.EventType.PROMPT_SHOW,e)}_handleFlowLoaded(){return o(this,void 0,void 0,function*(){yield this.run()})}_handleShowPrompt(){return o(this,void 0,void 0,function*(){this.context.app.loadConfig.manualPromptMode||(yield this._attemptToShow(!0))})}run(s={}){const e=Object.create(null,{run:{get:()=>super.run}});return o(this,void 0,void 0,function*(){this.shown||(yield e.run.call(this,s),this._runMixedIntegrationCheck(),(yield this._canShow())?(this.dispatch(new i.EventModel(l.EventType.PROMPT_ELIGIBLE,this._buildDispatchEventPack())),yield this._attemptToShow(!!s.bypassEligibilityCheck)):this.dispatch(new i.EventModel(l.EventType.PROMPT_INELIGIBLE,this._buildDispatchEventPack())))})}_canShow(){const t=Object.create(null,{_canShow:{get:()=>super._canShow}});return o(this,void 0,void 0,function*(){var s=yield t._canShow.call(this),e=(yield this.context.user.getComputedPushPermission(this.context)).subscription;return s&&!e||u.Logger.debug("Native prompt cannot show due to current subscription state."),s&&!e})}_attemptToShow(e=!1){const t=Object.create(null,{_attemptToShow:{get:()=>super._attemptToShow}});return o(this,void 0,void 0,function*(){var s;yield t._attemptToShow.call(this),this.shown||(s=this.settings.prompt.is_auto_show||e,this._isPlacementEnabled()?(yield this._canShow())&&s&&(yield this._evaluateRunConditions(),(yield this._canShow())&&(yield this._show())):u.Logger.info("Current prompt is not enabled for this placement"))})}_show(){const s=Object.create(null,{_show:{get:()=>super._show}});return o(this,void 0,void 0,function*(){this.shown||(yield s._show.call(this),this.shown=!0,yield this.dispatch(new i.EventModel(l.EventType.PROMPT_ALLOWED,this._buildDispatchEventPack(),this.context,this)))})}_runMixedIntegrationCheck(){var s=this.context.domain.integrationType;if(this.context.env.primaryRuntimeEnvironment===r.RuntimeEnvironment.DIRECT&&s===h.IntegrationType.PROXY)throw this.debugPromptNotShown(this.context,"mixed_integration"),new d.FailException(null,p.ExceptionMessage.MIXED_INTEGRATION)}}e.NativePrompt=c},"./src/sdk/prompts/slide.prompt.ts":function(s,e,t){"use strict";var i=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.SlidePrompt=void 0,t("./src/sdk/prompts/dom.prompt.ts"));const n=t("./src/sdk/constants.ts"),p=t("./src/sdk/models/events/event.model.ts"),r=t("./src/sdk/enums/event-type.enum.ts"),l=t("./src/sdk/services/logging.service.ts"),u={top:"d-top",bottom:"d-bottom",disabled:"d-disabled"},h={top:"m-top",bottom:"m-bottom",disabled:"m-disabled"};class d extends o.DomPrompt{constructor(){super(...arguments),this.shown=!1}get promptImage(){return this.promptTheme.image}_wireEvents(){var s=this._handleFlowLoaded.bind(this),e=this._handlePromptHide.bind(this),t=this._handleShowPrompt.bind(this),o=[r.EventType.PROMPT_ALLOWED,r.EventType.PROMPT_DISMISSED,r.EventType.PERMISSION_DIALOG_SHOWN,r.EventType.PERMISSION_DENIED,r.EventType.REGISTRATION_SUBSCRIBED,r.EventType.REGISTRATION_MIGRATED];this.watch(r.EventType.FLOW_LOADED,s),this.watch(o,e),this.watch(r.EventType.PROMPT_SHOW,t)}_handleFlowLoaded(){return i(this,void 0,void 0,function*(){yield this.run()})}_handlePromptHide(){return i(this,void 0,void 0,function*(){yield this._hide()})}_handleShowPrompt(){return i(this,void 0,void 0,function*(){this.context.app.loadConfig.manualPromptMode||this.element&&!this.element.classList.contains(n.DEFAULT_CLASSNAME_PROMPT_VISIBLE)&&(yield this._attemptToShow(!0))})}_wireElementEvents(){this.allowBtn.addEventListener("click",this._allow.bind(this)),this.dismissBtn.addEventListener("click",this._dismiss.bind(this))}attachToDom(o){const n=Object.create(null,{attachToDom:{get:()=>super.attachToDom}});return i(this,void 0,void 0,function*(){if(yield n.attachToDom.call(this,o),this.parentReady){var s=this._buildTemplate();const e=["pushly_popover","pushly-prompt-window",this.promptTheme.layout||"normal",this.promptConfig.managed?"managed":"non-managed",u[this.promptTheme.position.desktop],h[this.promptTheme.position.mobile]],t=this.element=this._createDivElement({className:e.join(" "),style:"z-index: 999999999"});t.appendChild(s),this.element&&this.parent.appendChild(this.element),this._wireElementEvents()}})}_buildTemplate(){const s=this._createDivElement({className:"pushly_popover-box pushly-prompt-slide",style:"background-color: "+this.promptTheme.background_color}),e=this._createDivElement({className:"pushly_popover-first pushly-prompt-icon"});s.appendChild(e),this.promptImage?(n=this._createImgElement(this.promptImage,this.context.domain.name+" Logo"),e.appendChild(n)):e.style.display="none";const t=this._createDivElement({className:"pushly_popover-second pushly-prompt-content"}),o=(s.appendChild(t),this._createDivElement({className:"pushly_popover-message pushly-prompt-message"}));t.appendChild(o);var n=this._createDivElement({className:"pushly_popover-message-headline pushly-prompt-message-headline",style:"color: "+this.promptTheme.title.text_color,innerText:this.promptTheme.title.text}),n=(o.appendChild(n),this._createDivElement({className:"pushly_popover-message-headline pushly-prompt-message-headline",style:"color: "+this.promptTheme.subtitle.text_color,innerText:this.promptTheme.subtitle.text}));o.appendChild(n);const i=this._createDivElement({className:"pushly_popover-buttons pushly-prompt-actions"});return t.appendChild(i),this.dismissBtn=this._createButtonElement({className:"pushly_popover-buttons-dismiss pushly-prompt-buttons-dismiss",style:`color: ${this.promptTheme.dismiss_button.text_color}; background-color: ${this.promptTheme.dismiss_button.background_color};`,innerText:this.promptTheme.dismiss_button.text}),i.appendChild(this.dismissBtn),this.allowBtn=this._createButtonElement({className:"pushly_popover-buttons-allow pushly-prompt-buttons-allow",style:`color: ${this.promptTheme.allow_button.text_color}; background-color: ${this.promptTheme.allow_button.background_color};`,innerText:this.promptTheme.allow_button.text}),i.appendChild(this.allowBtn),s}run(s={}){const e=Object.create(null,{run:{get:()=>super.run}});return i(this,void 0,void 0,function*(){this.shown||(yield e.run.call(this,s),(yield this._canShow())?(this.dispatch(new p.EventModel(r.EventType.PROMPT_ELIGIBLE,this._buildDispatchEventPack())),yield this._attemptToShow(!!s.bypassEligibilityCheck)):this.dispatch(new p.EventModel(r.EventType.PROMPT_INELIGIBLE,this._buildDispatchEventPack())))})}_attemptToShow(e=!1){const t=Object.create(null,{_attemptToShow:{get:()=>super._attemptToShow}});return i(this,void 0,void 0,function*(){var s;yield t._attemptToShow.call(this),this.shown||(s=this.settings.prompt.is_auto_show||e,this._isPlacementEnabled()?(yield this._canShow())&&s&&(yield this._evaluateRunConditions(),yield this._show()):l.Logger.info("Current prompt is not enabled for this placement"))})}_show(){const s=Object.create(null,{_show:{get:()=>super._show}});return i(this,void 0,void 0,function*(){this.shown||(yield s._show.call(this),this.shown=!0)})}}e.SlidePrompt=d},"./src/sdk/repositories/application.repository.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.ApplicationRepository=void 0;const n=t("./src/sdk/utils.ts"),i=t("./src/sdk/data-providers/cookie.data-provider.ts"),p=t("./src/sdk/services/logging.service.ts"),r=t("./src/sdk/models/application/app.model.ts");e.ApplicationRepository=class{static get(){return o(this,void 0,void 0,function*(){let s=new r.AppModel;return p.Logger.info("Data mode: CDM"),s.isVisibleLoggingEnabled=(0,n.tryParseJSON)(yield i.CookieDataProvider.getmv("_pnvl",!1,"pushly.app_visibleLogs")),this.removeDeprecatedCookies(),s})}static set(s){return o(this,void 0,void 0,function*(){return yield i.CookieDataProvider.set("_pnvl",!0===s.isVisibleLoggingEnabled),this})}static purgeCookies(){return o(this,void 0,void 0,function*(){yield this.removeDeprecatedCookies();for(const s of["_pnvl","_pndbg","_pndbgpr"])(yield i.CookieDataProvider.has(s))&&(yield i.CookieDataProvider.clear(s))})}static removeDeprecatedCookies(){return o(this,void 0,void 0,function*(){for(const s of["pushly.app_env","pushly.app_version","pushly.app_workerVersion","pushly_view_logs"])(yield i.CookieDataProvider.has(s))&&(yield i.CookieDataProvider.clear(s))})}}},"./src/sdk/repositories/domain.repository.ts":function(s,e,t){"use strict";var n=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.DomainRepository=void 0;const i=t("./src/common/data-providers/api.data-provider.ts"),p=t("./src/sdk/constants.ts"),r=t("./src/sdk/models/domains/domain.model.ts"),l=t("./src/sdk/exceptions/domain-load.exception.ts"),u=t("./src/sdk/services/logging.service.ts");class o extends t("./src/sdk/models/events/eventable.model.ts").EventableModel{static get(o){return n(this,void 0,void 0,function*(){var e;const t=new r.DomainModel;Object.assign(t,{}),u.Logger.info("Updating domain cache");try{let s=p.INJECTED_DOMAIN_SETTINGS;(s=!p.DOMAIN_SETTINGS_INJECTION_FAILED.test(s)&&"domain"in s?s:yield i.ApiDataProvider.get(p.SETTINGS_ENDPOINT+"/"+o))&&(e=s.domain,t.id=e.id,t.name=e.name,t.domainKey=o,t.senderId=e.sender_id,t.customAllowDomain=e.custom_allow_domain,t.frequencyCaps=e.frequency_caps,t.globalPromptSettings=e.global_prompt_settings,t.integrationType=e.integration_type,t.whitelistDomains=e.whitelist_domains,t.sdkEventOnlyDomains=e.sdk_event_only_domains,t.apnsConfiguration=e.apns_configuration,t.flags=e.flags||t.flags||[],t.vapidPublicKey=e.vapid_public_key,t.additionalSubscriptionData=e.additional_subscription_data,t.promptGroups=s.prompt_groups,t.prompts=s.prompts)}catch(s){throw u.Logger.warn("Unable to load remote domain settings.",s),this.debugPromptNotShown({domainKey:o},"load_failed"),new l.DomainLoadException(s)}return t})}}e.DomainRepository=o},"./src/sdk/repositories/subscription.repository.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.SubscriptionRepository=void 0;const n=t("./src/_utils/service-worker-registration.ts");class i extends t("./src/sdk/models/events/eventable.model.ts").EventableModel{static unregister(t){return o(this,void 0,void 0,function*(){let e=!0;try{const s=yield(0,n.getPushlyServiceWorkerRegistration)(t);s&&(e=yield s.unregister())}catch(s){e=!1}return e})}}e.SubscriptionRepository=i},"./src/sdk/repositories/user.repository.ts":function(s,e,t){"use strict";var p=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.UserRepository=void 0;const r=t("./src/sdk/constants.ts"),l=t("./src/sdk/data-providers/cookie.data-provider.ts"),u=t("./src/sdk/prompts/base.prompt.ts"),o=t("./src/sdk/models/users/user.model.ts");e.UserRepository=class{static get(){return p(this,void 0,void 0,function*(){let s={};return s.puuid=s.puuid||l.CookieDataProvider.get("pushly.user_puuid"),s.externalId=s.externalId||l.CookieDataProvider.getmv("_pnxd",null,"pushly.user_externalId"),s.subscriberState=s.subscriberState||l.CookieDataProvider.getmv("_pnss",null,"pushly.user_subscriberState"),s.lastSeenPromptId=s.lastSeenPromptId||l.CookieDataProvider.getmv("_pnlspid",null,"pushly.user_lastSeenPromptId"),"subscribed"===s.subscriberState&&(s.token=s.token||l.CookieDataProvider.getmv("_pntx",null,"pushly.user_token")),s.promptFcapSeconds=l.CookieDataProvider.getmv("_pnfcps",null,"pushly.user_promptFcapSeconds"),s.promptCountState=l.CookieDataProvider.getmv("_pnpcs",null,"pushly.user_promptCountState"),this.removeDeprecatedCookies(),o.UserModel.of(s)})}static set(s){return p(this,void 0,void 0,function*(){return l.CookieDataProvider.set("pushly.user_puuid",s.puuid),l.CookieDataProvider.set("_pnxd",s.externalId),l.CookieDataProvider.set("_pnss",s.subscriberState),l.CookieDataProvider.set("_pnlspid",s.lastSeenPromptId),s.token?l.CookieDataProvider.set("_pntx",s.token):l.CookieDataProvider.clear("_pntx"),this})}static getWithCachePriority(){return p(this,void 0,void 0,function*(){let s={};return s.puuid=l.CookieDataProvider.get("pushly.user_puuid")||s.puuid,s.subscriberState=l.CookieDataProvider.getmv("_pnss",null,"pushly.user_subscriberState")||s.subscriberState,s.lastSeenPromptId=l.CookieDataProvider.getmv("_pnlspid",null,"pushly.user_lastSeenPromptId")||s.lastSeenPromptId,"subscribed"===s.subscriberState&&(s.token=l.CookieDataProvider.getmv("_pntx",null,"pushly.user_token")||s.token),s.promptFcapSeconds=l.CookieDataProvider.getmv("_pnfcps",null,"pushly.user_promptFcapSeconds"),s.promptCountState=l.CookieDataProvider.getmv("_pnpcs",null,"pushly.user_promptCountState"),o.UserModel.of(s)})}static setPromptState(t,o){return p(this,void 0,void 0,function*(){var{promptFcapSeconds:s,promptCountState:e}=t;return l.CookieDataProvider.setWithRawExpires("_pnfcps",s,o),l.CookieDataProvider.setWithRawExpires("_pnpcs",e,o),this})}static clearPromptState(){return p(this,void 0,void 0,function*(){return l.CookieDataProvider.clear("_pnfcps"),l.CookieDataProvider.clear("_pnpcs"),this})}static setPromptDismissedState(n,i){return p(this,void 0,void 0,function*(){let s=r.PUSHLY_PROMPT_DISMISSED_COOKIE_TIMEOUT,e="d",t={};var o;return"cookie_length_seconds"in(t=i instanceof u.BasePrompt?i.promptConfig.behavior||{}:i.promptBehavior||{})&&(null!=(o=t.cookie_length_seconds)&&(s=o,e="s")),0!==s?(n.subscriberState="dismissed",l.CookieDataProvider.set("_pnpdm",!0,s,e)):n.subscriberState="none",yield this.set(n),self})}static getPromptDismissedState(){return p(this,void 0,void 0,function*(){var s=l.CookieDataProvider.getmv("_pnpdm",!1,"pushly.prompt_dismissed");return"true"===s||!0===s})}static purgeCookies(){this.removeDeprecatedCookies();["pushly.user_puuid","_pnss","_pnlspid","_pnupf","_pntx","_pnfcps","_pnpcs","_pnpdm"].forEach(s=>{l.CookieDataProvider.has(s)&&l.CookieDataProvider.clear(s)})}static removeDeprecatedCookies(){["pushly.user_createdAt","pushly.user_updatedAt","pushly.user_profile","pushly.user_lifetimeViewedKeywordMap","pushly_uqid","pushly_uqid_timestamp","pushly_subscriber_data_updated_at","pushly_do_not_track","pushly_apns_token","pushly_fcm_token","pushly_subscribed","_pndnt","_dor","_pnupf"].forEach(s=>{l.CookieDataProvider.has(s)&&l.CookieDataProvider.clear(s)})}}},"./src/sdk/sdk.ts":function(s,e,t){"use strict";var n=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.SDK=void 0;const u=t("./src/sdk/enums/event-type.enum.ts"),i=t("./src/sdk/services/logging.service.ts"),o=t("./src/_utils/validate-only-instance-of-sdk.ts"),p=t("./src/sdk/services/user-debug.service.ts"),r=t("./src/sdk/enums/steamable-event-type.enum.ts"),l=t("./src/sdk/enums/consent.enum.ts"),h=t("./src/sdk/constants.ts"),d=t("./src/sdk/factories/data-provider-factory.ts"),c=t("./src/sdk/exceptions/exit.exception.ts"),a=t("./src/sdk/exceptions/fail.exception.ts"),m=t("./src/sdk/services/flow.service.ts"),y=t("./src/_utils/consent.ts"),v=t("./src/sdk/services/prompt.service.ts"),_=t("./src/sdk/exceptions/pushly.exception.ts"),b=t("./src/sdk/data-providers/cookie.data-provider.ts"),f=t("./src/sdk/services/app.service.ts"),g=t("./src/sdk/enums/runtime-environment.enum.ts"),w=t("./src/sdk/services/user.service.ts"),A=t("./src/sdk/services/domain.service.ts"),x=t("./src/sdk/exceptions/domain-load.exception.ts"),k=t("./src/sdk/cross-frame-messenger/messenger-server.ts"),E=t("./src/sdk/services/registration.service.ts");var C=t("./src/sdk/models/events/eventable.model.ts");const I=t("./src/sdk/models/events/event.model.ts"),S=t("./src/sdk/enums/exception-message.enum.ts"),P=t("./src/sdk/exceptions/invalid-event.exception.ts"),O=t("./src/sdk/services/environment.service.ts"),D=t("./src/sdk/exceptions/worker-registration.exception.ts"),j=t("./src/sdk/utils.ts");class M extends C.EventableModel{constructor(s){super(),this.context=s,this.iid=(0,j.randomString)(),this._swsts_=Date.now(),(this._swclk_=0,o.validateOnlyInstanceOfSdk)(this),this.t(),this.p()}push(o){return n(this,void 0,void 0,function*(){let s=o[0];const e=/^on_/i;try{var t;e.test(s)?(s=s.replace(e,""),this.watch(s,o[1])):(t=new I.EventModel(s,o[1]),yield this.dispatch(t))}catch(s){if(!(s instanceof P.InvalidEventException))throw s;i.Logger.warn(s.message)}})}on(s,e){return n(this,void 0,void 0,function*(){yield this.push(["on_"+s,e])})}trigger(s,e){return n(this,void 0,void 0,function*(){yield this.push([s,e])})}showLogs(s=!0){return n(this,void 0,void 0,function*(){this.context.app.isVisibleLoggingEnabled=!!s,yield f.AppService.saveApp(this.context.app),i.Logger.setVisibleLogsEnabled(s)})}getLogs(){return i.Logger.logs}load(s,e=!1){return n(this,void 0,void 0,function*(){try{yield this.l(s,e)}catch(s){let e=!1;s&&(s instanceof a.FailException||s instanceof x.DomainLoadException||s instanceof D.WorkerRegistrationException?(e=!0,i.Logger.error(this.context,s)):(s instanceof _.PushlyException||s&&s.isPushlyException)&&(e=!0,i.Logger.warn(s.message)),(s instanceof D.WorkerRegistrationException||s instanceof x.DomainLoadException||"object"==typeof s&&"message"in s&&s.message===S.ExceptionMessage.HOST_NOT_WHITELISTED)&&this.dispatch(new I.EventModel(u.EventType.APPLICATION_ERROR,{message:s.message}))),e||(yield this.u(s))}})}requestNotificationPermission(s=0,e){return n(this,void 0,void 0,function*(){if(!this.context.domain.isEventOnlyMode())return E.RegistrationService.performManualRegistrationAttempt(this.context,s,e);i.Logger.warn("Requesting notification permission is not available while in event only mode.")})}isUserSoftUnsubscribed(){return n(this,void 0,void 0,function*(){return this.context.user.isInUdr})}isUserEligibleToPrompt(){return n(this,void 0,void 0,function*(){return yield this.context.user.isEligibleToPrompt(this.context)})}isUserSubscribed(){return n(this,void 0,void 0,function*(){return yield this.context.user.isSubscribed(this.context)})}l(s,e){return n(this,void 0,void 0,function*(){if(this.context.runtimeEnvironment=s._subRuntimeEnvironmentOverride,this.context.runtimeEnvironment!==g.RuntimeEnvironment.AMP_FRAME_HELPER&&this.context.runtimeEnvironment!==g.RuntimeEnvironment.BROKERED_DATA_SERVER||k.MessengerServer.global.accept(),(0,o.validateOnlyInstanceOfSdk)(this),s.domainKey&&""!==s.domainKey.trim())return this.context.h=s,this.context.domainKey=s.domainKey,this.context.consent=(0,y.buildSdkConsentContext)(s,e),i.Logger.info("Loading: "+this.context.domainKey),this.context.domain=yield A.DomainService.loadDomain(this.context.domainKey),b.CookieDataProvider.domain=this.context.domain,this._runtimeEnvShouldSendSdkImpression(s)&&!f.AppService.inUdrContext()&&this.debug(this.context,r.StreamableEventType.SDK_IMPRESSION),this.context.env=yield O.EnvironmentService.loadEnv(),yield O.EnvironmentService.verifyEnvironmentSupport(s,this.context),yield A.DomainService.verifyEnvironmentSupport(this.context),this.context.domain.hasFlag("FEAT_SDK_RESTRICT_MULTI_SUBS")&&!this.context.domain.isEventOnlyMode()&&O.EnvironmentService.verifyNoSiblingSubscriptions(s,this.context),this.c();throw new c.ExitException(null,S.ExceptionMessage.DOMAIN_KEY_NOT_SPECIFIED)})}c(){return n(this,void 0,void 0,function*(){var e=this.context.h;if(this.context.consent.required&&this.context.consent.status===l.ConsentStatus.UNCONFIRMED)i.Logger.info("Awaiting Consent");else{this.context.app=yield f.AppService.loadApp(e),this.context.env.mode=this.context.app.mode,i.Logger.setVisibleLogsEnabled(this.context.app.isVisibleLoggingEnabled);let s=this.context.app.mode;this.context.domain.isEventOnlyMode()&&(s+=" [event only]"),i.Logger.info("Application Mode: "+s),i.Logger.info("Version: "+h.PUSHLY_APPLICATION_VERSION);try{const o=yield d.DataProviderFactory.getSessionDataProvider(this.context);var t=parseInt((yield o.getCurrentSession()).sessionStart);t<this._swsts_?this._swsts_=t:yield o.set("sessionStart",this._swsts_)}catch(s){}if(this.context.user=yield w.UserService.loadUser(e,this.context),!this.context.user)throw new a.FailException(null,S.ExceptionMessage.USER_UNABLE_TO_LOAD);yield O.EnvironmentService.verifyUdrState(this.context),e.externalId&&this.push(["profile",{external_id:e.externalId}]),p.UserDebugService.shouldShowDebugPanel()&&p.UserDebugService.showDebugPanel(this.context),O.EnvironmentService.configureRuntimeEnvironments(this.context),this.context.app.isLoaded=!0,i.Logger.info("Loaded"),this.dispatch(new I.EventModel(u.EventType.APPLICATION_LOADED)),this.context.user.isInUdr?(yield this.m(),i.Logger.info("Halting (UDR)")):yield this._loadFlows(e)}})}_loadFlows(t){return n(this,void 0,void 0,function*(){if(t.disableWebFlow)yield this.m();else{const e=m.FlowService.loadFlow(this.context);var s;!t.manualPromptMode&&e.isPromptableFlow&&(yield w.UserService.verifyUserSubscriptionState(this.context),this.context.domain.isEventOnlyMode()||(s={isSafari:this.context.env.isSafari()},v.PromptService.loadPrompts(this.context,s))),yield e.run()}})}_runtimeEnvShouldSendSdkImpression(s){const e=[g.RuntimeEnvironment.AMP_FRAME_HELPER,g.RuntimeEnvironment.AMP_PERMISSION_DIALOG,g.RuntimeEnvironment.PROXY,g.RuntimeEnvironment.PROXY_FRAME_HELPER,g.RuntimeEnvironment.PROXY_PERMISSION_DIALOG,g.RuntimeEnvironment.AMP,g.RuntimeEnvironment.AMP_FRAME_HELPER,g.RuntimeEnvironment.BROKERED_DATA_SERVER];return-1===e.indexOf(s._subRuntimeEnvironmentOverride)}t(){var s,e,t,o,n,i,p,r,l;this.context.app&&this.context.app.isLoaded||(s=this.y.bind(this),e=this.m.bind(this),t=this.v.bind(this),o=this._.bind(this),n=this.b.bind(this),i=this.f.bind(this),p=this.g.bind(this),r=this.w.bind(this),l=this.A.bind(this),this.watchOnce(u.EventType.CONFIRM_CONSENT,s),this.watchOnce(u.EventType.APPLICATION_LOAD,o),this.watchOnce(u.EventType.AMP_FRAME_HELPER_LOAD,n),this.watchOnce(u.EventType.AMP_PERMISSION_DIALOG_LOAD,i),this.watchOnce(u.EventType.PROXY_PERMISSION_DIALOG_LOAD,p),this.watchOnce(u.EventType.BROKERED_DATA_SERVER_LOAD,l),this.watchOnce(u.EventType.FLOW_LOADED,e),this.watch(u.EventType.REVERT_USER_DELETION,r),this.watch(u.EventType.PROMPT_SHOW,t),w.UserService.wireProfileEvents(this.context))}y(){this.context.app&&this.context.app.isLoaded||this.load(this.context.h,!0)}w(){return n(this,void 0,void 0,function*(){b.CookieDataProvider.has("_pnudr")&&(yield w.UserService.handleUdrRevert(this.context))})}_(s){this.load(s)}b(s){s._subRuntimeEnvironmentOverride=g.RuntimeEnvironment.AMP_FRAME_HELPER,i.Logger.setSubApplicationName("amp-helper-frame"),i.Logger.setColor("#7CBE7B"),i.Logger.setBackgroundColor("black"),this.load(s)}f(s){s._subRuntimeEnvironmentOverride=g.RuntimeEnvironment.AMP_PERMISSION_DIALOG,i.Logger.setSubApplicationName("amp-permission-dialog"),this.load(s)}g(s){s._subRuntimeEnvironmentOverride=g.RuntimeEnvironment.PROXY_PERMISSION_DIALOG,i.Logger.setSubApplicationName("proxy-permission-dialog"),this.load(s)}A(s){i.Logger.setSubApplicationName("brokered-data-server"),i.Logger.setColor("#FFC152"),i.Logger.setBackgroundColor("black"),s._subRuntimeEnvironmentOverride=g.RuntimeEnvironment.BROKERED_DATA_SERVER,this.load(s)}v(s){return n(this,void 0,void 0,function*(){this.x(()=>{this.context.domain.isEventOnlyMode()?i.Logger.warn("Manual prompting is not available while in event only mode."):(this.context.app.loadConfig.manualPromptMode||i.Logger.warn("Manual prompt mode is not enabled."),v.PromptService.performManualPromptLoad(this.context,s))},"Delaying 'show_prompt' request.")})}m(){return n(this,void 0,void 0,function*(){i.Logger.info("Ready"),this.context.app.isReady=!0,this.dispatch(new I.EventModel(u.EventType.APPLICATION_READY,this.context))})}x(s,e){this.context.app&&this.context.app.isReady?s():(i.Logger.debug(e||"Delaying request until application is in ready state."),this.watchOnce(u.EventType.APPLICATION_READY,s))}u(e){return n(this,void 0,void 0,function*(){if("object"==typeof e){e.context=Object.assign(Object.assign({},e.context),{sw_error:!1});const s=new RegExp(h.UNCAUGHT_ERROR_BLACKLIST.map(s=>`(${s})`).join("|"),"i");s.test(e.name)||s.test(e.message)?i.Logger.warn(this.context,e):i.Logger.error(this.context,e)}else i.Logger.error(this.context,e)})}p(){return n(this,void 0,void 0,function*(){setInterval(()=>{this._swclk_+=1,this.context.clock=this._swclk_},1e3)})}}e.SDK=M},"./src/sdk/services/app.service.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.AppService=void 0;const n=t("./src/sdk/data-providers/cookie.data-provider.ts"),i=t("./src/sdk/repositories/application.repository.ts"),p=t("./src/sdk/exceptions/exit.exception.ts"),r=t("./src/_utils/global-env.ts");e.AppService=new class{loadApp(e){return o(this,void 0,void 0,function*(){const s=yield i.ApplicationRepository.get();if(s.loadConfig=e,s.loadConfig.classNames=s.loadConfig.classNames||{},s.mode=(s.loadConfig.mode||s.mode||"production").toString().toLowerCase(),["production","development"].includes(s.mode))return yield this.saveApp(s),s.classNames=e.classNames,s;throw new p.ExitException("Invalid sdk mode specified.")})}saveApp(s){return o(this,void 0,void 0,function*(){return yield i.ApplicationRepository.set(s),s})}processUdr(){return o(this,void 0,void 0,function*(){return n.CookieDataProvider.set("_pnudr",1),i.ApplicationRepository.purgeCookies()})}inUdrContext(){return this.udrCookiePresent()||this.udrParamPresent()}udrCookiePresent(){let s=!1;try{s=!!n.CookieDataProvider.get("_pnudr")}catch(s){}return s}udrParamPresent(){var s=(0,r.getLocation)();let e=!1;try{e=/(^|[?&#])(push(ly)?_udr)=1(?=[&#]|$)/i.test(s.search)}catch(s){}return e}}},"./src/sdk/services/domain.service.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.DomainService=void 0;const l=t("./src/_utils/global-env.ts"),n=t("./src/sdk/models/events/event.model.ts"),u=t("./src/sdk/enums/exception-message.enum.ts"),i=t("./src/sdk/enums/event-type.enum.ts"),h=t("./src/sdk/exceptions/exit.exception.ts");var p=t("./src/sdk/models/events/eventable.model.ts");const r=t("./src/sdk/repositories/domain.repository.ts");class d extends p.EventableModel{loadDomain(s){return o(this,void 0,void 0,function*(){return r.DomainRepository.get(s)})}verifyEnvironmentSupport(s){return o(this,void 0,void 0,function*(){if(s.env.isSafari()&&!s.env.isPushManagerInScope()){if(!s.domain.hasApnsConfig())throw this.debugPromptNotShown(s,"apns_not_configured"),this.dispatch(new n.EventModel(i.EventType.WEB_PUSH_NOT_CONFIGURED)),this.dispatch(new n.EventModel(i.EventType.DOMAIN_APNS_NOT_CONFIGURED)),new h.ExitException(null,u.ExceptionMessage.DOMAIN_APNS_NOT_CONFIGURED);if(!s.domain.isApnsConfigEnabled())throw this.debugPromptNotShown(s,"apns_not_enabled"),this.dispatch(new n.EventModel(i.EventType.WEB_PUSH_NOT_CONFIGURED)),this.dispatch(new n.EventModel(i.EventType.DOMAIN_APNS_NOT_ENABLED)),new h.ExitException(null,u.ExceptionMessage.DOMAIN_APNS_NOT_ENABLED);if(!s.domain.getWebsitePushId())throw this.debugPromptNotShown(s,"apns_invalid_config"),this.dispatch(new n.EventModel(i.EventType.WEB_PUSH_NOT_CONFIGURED)),this.dispatch(new n.EventModel(i.EventType.DOMAIN_APNS_INVALID_CONFIG)),new h.ExitException(null,u.ExceptionMessage.DOMAIN_APNS_INVALID_CONFIG)}this.validateHostAvailability(s)})}validateHostAvailability(s){var e=(0,l.getLocation)();let t,o=s.domain.whitelistDomains;if(o)if(Array.isArray(o)&&0!==o.length){0<o.length&&s.env.isSafari()&&(o=[o[0]]);var n=["localhost","127.0.0.1"];const i=e.protocol+"//"+e.hostname,p=e.protocol+"//"+e.host,r=e.href;e=[...o,...n].some(s=>{/^\*/.test(s)&&(s="."+s);const e=new RegExp(`^(http[s]?://)?${s}$`,"i");return e.test(i)||e.test(p)||e.test(r)});t=!e}else t=!1;else t=!1;if(t)throw this.debugPromptNotShown(s,"host_not_whitelisted"),new h.ExitException(null,u.ExceptionMessage.HOST_NOT_WHITELISTED)}}e.DomainService=new d},"./src/sdk/services/environment.service.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.EnvironmentService=void 0;const i=t("./src/sdk/services/logging.service.ts"),n=t("./src/sdk/services/app.service.ts"),p=t("./src/sdk/models/events/subscriber-streamable-event.model.ts"),r=t("./src/sdk/enums/runtime-environment.enum.ts"),l=t("./src/sdk/enums/event-type.enum.ts"),u=t("./src/sdk/services/user.service.ts");var h=t("./src/sdk/models/events/eventable.model.ts");const d=t("./src/sdk/models/events/event.model.ts"),c=t("./src/sdk/enums/exception-message.enum.ts"),a=t("./src/sdk/enums/steamable-event-type.enum.ts"),m=t("./src/sdk/models/application/environment.model.ts"),y=t("./src/sdk/factories/data-provider-factory.ts"),v=t("./src/sdk/exceptions/exit.exception.ts"),_=t("./src/sdk/enums/integration-type.enum.ts");class b extends h.EventableModel{loadEnv(){return o(this,void 0,void 0,function*(){return new m.EnvironmentModel})}verifyNoSiblingSubscriptions(e,s){if(s.env.document.cookie.split(";").map(s=>s.toString().trim().split("=")).find(s=>/^_pnss/.test(s[0])&&!new RegExp(e.domainKey.substr(-8)+"$").test(s[0])&&"subscribed"===s[1]))throw this.debugPromptNotShown(s,"sibling_subscription_detected",s.env.unsupportedReason),this.dispatch(new d.EventModel(l.EventType.EXISTING_SUBSCRIPTION_DETECTED,void 0,e,s.env)),new v.ExitException(null,c.ExceptionMessage.EXISTING_SUBSCRIPTION_DETECTED)}verifyEnvironmentSupport(e,t){return o(this,void 0,void 0,function*(){var s=!!t.env&&(yield t.env.isPushSupported());if(s)return this.dispatch(new d.EventModel(l.EventType.WEB_PUSH_SUPPORTED)),s;throw this.debugPromptNotShown(t,"web_push_unsupported",t.env.unsupportedReason),this.dispatch(new d.EventModel(l.EventType.WEB_PUSH_NOT_SUPPORTED,void 0,e,t.env)),new v.ExitException(null,c.ExceptionMessage.ENV_NOT_SUPPORTED)})}verifyUdrState(e){return o(this,void 0,void 0,function*(){if(n.AppService.inUdrContext()){e.user.isInUdr=!0;try{n.AppService.udrParamPresent()&&!n.AppService.udrCookiePresent()&&(yield this.post(new p.SubscriberStreamableEventModel(a.StreamableEventType.UDR,{},e)),yield n.AppService.processUdr(),yield u.UserService.processUdr(),this.dispatch(new d.EventModel(l.EventType.USER_DELETION_REQUEST)));const s=yield y.DataProviderFactory.getPermissionDataProvider(e);yield s.removeRegistration()}catch(s){"NoResponseException"!==s.name&&i.Logger.warn("Error processing UDR:",s)}}})}configureRuntimeEnvironments(s){const{app:e,domain:t,env:o}=s;if(t.integrationType===_.IntegrationType.DIRECT&&t.customAllowDomain&&!o.isHTTPS()&&!o.isDevMode())o.primaryRuntimeEnvironment=r.RuntimeEnvironment.PROXY;else if(e.loadConfig._subRuntimeEnvironmentOverride){var n=e.loadConfig._subRuntimeEnvironmentOverride;switch(n){case r.RuntimeEnvironment.BROKERED_DATA_SERVER:o.primaryRuntimeEnvironment=r.RuntimeEnvironment.BROKERED_DATA_SERVER;break;case r.RuntimeEnvironment.AMP_FRAME_HELPER||r.RuntimeEnvironment.AMP_PERMISSION_DIALOG:o.primaryRuntimeEnvironment=r.RuntimeEnvironment.AMP,o.subRuntimeEnvironment=n;break;case r.RuntimeEnvironment.PROXY_PERMISSION_DIALOG:o.primaryRuntimeEnvironment=r.RuntimeEnvironment.PROXY,o.subRuntimeEnvironment=n}}o.primaryRuntimeEnvironment||(t.integrationType===_.IntegrationType.PROXY?o.primaryRuntimeEnvironment=r.RuntimeEnvironment.PROXY:o.primaryRuntimeEnvironment=r.RuntimeEnvironment.DIRECT),i.Logger.info("Current runtime environment: "+r.RuntimeEnvironmentName[o.subRuntimeEnvironment||o.primaryRuntimeEnvironment])}}e.EnvironmentService=new b},"./src/sdk/services/flow.service.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FlowService=e.FlowSvc=void 0;const o=t("./src/sdk/factories/flow.factory.ts");class n{loadFlow(s){return o.FlowFactory.getFlow(s)}}e.FlowSvc=n,e.FlowService=new n},"./src/sdk/services/helpers/apns.service-helpers.ts":function(s,e,t){"use strict";var n=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.ApnsServiceHelpers=void 0;const u=t("./src/sdk/services/logging.service.ts"),h=t("./src/sdk/constants.ts"),i=t("./src/sdk/enums/exception-message.enum.ts"),p=t("./src/sdk/enums/notification-permission-state.enum.ts"),r=t("./src/sdk/exceptions/fail.exception.ts");e.ApnsServiceHelpers=class{static getToken(t){return n(this,void 0,void 0,function*(){let s;var e=yield t.user.getComputedPushPermission(t);return s=e.deviceToken?e.deviceToken:s})}static requestNotificationPermission(t,o){return n(this,void 0,void 0,function*(){const s={permissionState:"default"};var e=t.domain.getWebsitePushId(),e=(u.Logger.info("APNS checking permission for",e),yield t.user.getComputedPushPermission(t));if(s.permissionState=e.permission,s.permissionState===p.NotificationPermissionState.GRANTED)u.Logger.info("APNS permission already granted"),s.token=e.deviceToken;else{e=yield this._checkRemotePermission(t,s,o);if(s.permissionState=e.permission,u.Logger.info("APNS response",e),e.permission===p.NotificationPermissionState.GRANTED&&(s.token=e.deviceToken,t.user.setPushPermission(e),!s.token))throw new r.FailException(null,i.ExceptionMessage.APNS_FAILED_TO_GET_GRANTED_TOKEN)}return s})}static _checkRemotePermission(s,e,t){return n(this,void 0,void 0,function*(){if(null!==e&&e.permissionState!==p.NotificationPermissionState.DEFAULT)return e;if(t)try{t()}catch(s){}return this._requestSafariPermissions(s)})}static _requestSafariPermissions(l){return n(this,void 0,void 0,function*(){return new Promise(e=>{u.Logger.info("Setting permission scope");const t=l.env.scope,o=(u.Logger.info("Gathering permission snapshot"),t.safari.pushNotification.permission(l.domain.getWebsitePushId())||{});let n,i=0,p=!1;function r(){clearInterval(n),p=!0}u.Logger.info("Requesting permission"),t.safari.pushNotification.requestPermission(h.APNS_URL,l.domain.getWebsitePushId(),{domain_key:l.domainKey,pushly_unique_user_id:l.user.puuid},s=>{p||(r(),e(s),u.Logger.info(`Native permission response sent [${s.permission}]`))}),n=setInterval(()=>{try{var s;p||(i+=1,s=t.safari.pushNotification.permission(l.domain.getWebsitePushId())||{},600<=i?(clearInterval(n),u.Logger.info(`Fallback permission retry attempts exhausted, [${s.permission}]`)):s.permission!==o.permission&&(r(),e(s),u.Logger.info(`Fallback permission response sent [${s.permission}]`)))}catch(s){u.Logger.warn("sw.apns.error",s)}},500)})})}}},"./src/sdk/services/helpers/user-profile.service-helpers.ts":function(s,e,t){"use strict";var r=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.UserProfileServiceHelpers=void 0;const l=t("./src/sdk/models/events/subscriber-streamable-event.model.ts"),o=t("./src/sdk/enums/steamable-event-type.enum.ts"),u=t("./src/sdk/exceptions/profile.exception.ts");var n=t("./src/sdk/models/events/eventable.model.ts");const h=t("./src/sdk/utils.ts"),i=t("./src/sdk/enums/event-priority.enum.ts");class p extends n.EventableModel{static saveUserTags(s,e,t=0){return r(this,void 0,void 0,function*(){Array.isArray(e)||(e=[e]),yield this.patchProfile(o.StreamableEventType.PROFILE_UPDATE,s,{tag:e},t)})}static saveUserEvent(s,e){return r(this,void 0,void 0,function*(){yield this.patchProfile(o.StreamableEventType.PROFILE_UPDATE,s,{event:[e]})})}static saveUserProfileData(s,e){return r(this,void 0,void 0,function*(){yield this.patchProfile(o.StreamableEventType.PROFILE_UPDATE,s,{profile:e})})}static appendProfileArrayValue(s,e){return r(this,void 0,void 0,function*(){yield this.patchProfile(o.StreamableEventType.PROFILE_APPEND,s,{profile:e})})}static removeProfileArrayValue(s,e){return r(this,void 0,void 0,function*(){yield this.patchProfile(o.StreamableEventType.PROFILE_REMOVE,s,{profile:e})})}static pageTagVisit(s,e){return r(this,void 0,void 0,function*(){yield this.patchProfile(o.StreamableEventType.PAGE_TAG_VISITS,s,{page_tags:e})})}static viewItem(s,e){return r(this,void 0,void 0,function*(){yield this.patchProfile(o.StreamableEventType.VIEW_ITEM,s,e)})}static saveItem(s,e){return r(this,void 0,void 0,function*(){yield this.patchProfile(o.StreamableEventType.SAVE_ITEM,s,e)})}static addToCart(s,e){return r(this,void 0,void 0,function*(){yield this.patchProfile(o.StreamableEventType.ADD_TO_CART,s,e,null,i.EventPriority.IMMEDIATE)})}static updateCartItem(s,e){return r(this,void 0,void 0,function*(){yield this.patchProfile(o.StreamableEventType.UPDATE_CART_ITEM,s,e,null,i.EventPriority.IMMEDIATE)})}static purchase(s,e){return r(this,void 0,void 0,function*(){yield this.patchProfile(o.StreamableEventType.PURCHASE,s,e,null,i.EventPriority.IMMEDIATE)})}static saveExternalUserId(s,e){return r(this,void 0,void 0,function*(){yield this.patchProfile(o.StreamableEventType.PROFILE_UPDATE,s,{profile:{external_id:e}},0)})}static patchProfile(t,o,n,i=0,p){return r(this,void 0,void 0,function*(){try{i&&0<i&&(yield(0,h.delayRandom)(i));let s={};n&&n.meta&&(s=n.meta);var e=(yield o.user.getComputedPushPermission(o)).subscription;s.subscription_data=e||void 0,yield this.post(new l.SubscriberStreamableEventModel(t,Object.assign(Object.assign({},n),{meta:s}),o),null,p)}catch(s){throw new u.ProfileException(s)}})}}e.UserProfileServiceHelpers=p},"./src/sdk/services/helpers/vapid.service-helpers.ts":function(s,e,t){"use strict";var r=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.VapidServiceHelpers=void 0;const l=t("./src/sdk/services/logging.service.ts"),p=t("./src/common/md5.ts"),u=t("./src/sdk/services/worker.service.ts"),h=t("./src/_utils/service-worker-registration.ts"),i=t("./src/_utils/base-64.ts"),d=t("./src/sdk/data-providers/local-permission.data-provider.ts"),c=t("./src/sdk/enums/exception-message.enum.ts"),o=t("./src/sdk/enums/notification-permission-state.enum.ts"),a=t("./src/sdk/exceptions/fail.exception.ts"),m=t("./src/sdk/utils.ts");e.VapidServiceHelpers=class{static getToken(n){return r(this,void 0,void 0,function*(){let e,t=yield this.getSubscription(n,!1);var s=n.user.isSubscribed(n);if(t&&t.endpoint&&(e=(0,p.MD5)(t.endpoint),n.domain&&n.domain.vapidPublicKey)){var o=n.domain.vapidPublicKey;let s;(s=t.options&&t.options.applicationServerKey?(0,i.arrayBufferToBase64)(t.options.applicationServerKey):s)!==o&&(t=yield this.subscribe(o,n,t),e=(0,p.MD5)(t.endpoint))}o=yield n.user.getLocalPushPermission(n);return e=!e&&s&&"granted"===o.permission&&(s=yield this.handleNotificationPermissionGranted(n,{permissionState:"granted"}))&&s.token?s.token:e})}static getSubscription(e,t=!0){return r(this,void 0,void 0,function*(){let s=null;return(yield(0,h.getPushlyServiceWorkerRegistration)(e))?s=yield(0,h.getPushSubscription)(e):t&&(yield u.WorkerService.registerWorker(e)),s})}static requestNotificationPermission(t,o){return r(this,void 0,void 0,function*(){var s=yield t.user.getLocalPushPermission(t);const e={permissionState:s.permission};return"default"===s.permission&&(o&&o(),l.Logger.debug("Requesting browser notification permission"),e.permissionState=yield Notification.requestPermission()),e})}static handleNotificationPermissionGranted(n,i){return r(this,void 0,void 0,function*(){var s=yield n.user.getLocalPushPermission(n,!0);if(i.permissionState=s.permission,i.permissionState===o.NotificationPermissionState.GRANTED){let s,t,o=1e3;for(let e=0;e<10;e++){try{if(i.subscription=yield this.subscribe(n.domain.vapidPublicKey,n),s=i.subscription?i.subscription.endpoint:s)break}catch(s){e<9?l.Logger.warn(s):t=s}l.Logger.info("Retrying fetch token"),o*=3,yield(0,m.delay)(o)}if(!s)throw new a.FailException(t,c.ExceptionMessage.FAILED_TO_GET_GRANTED_TOKEN);if("string"!=typeof s){const e=new a.FailException(null,c.ExceptionMessage.INVALID_TOKEN_TYPE);throw e.context={token:s},e}i.token=(0,p.MD5)(s)}return i})}static subscribe(s,i,p){return r(this,void 0,void 0,function*(){let e=yield(0,h.getPushlyServiceWorkerRegistration)(i);e=e||(yield u.WorkerService.registerWorker(i));try{yield(0,h.createPushSubscription)(i,e)}catch(s){if(!/unsubscribe then resubscribe/i.test(s.message))throw s;var t;if(p)l.Logger.info("Attempting to unsubscribe previous subscription"),yield p.unsubscribe();else for(t of yield(0,h.getServiceWorkerRegistrations)(i)){const n=yield t.pushManager.getSubscription();yield n.unsubscribe()}l.Logger.info("Resubscribing"),yield(0,h.createPushSubscription)(i,e)}const s=new d.LocalPermissionDataProvider(i);var o=yield s.getPushPermission();return i.user.setPushPermission(o),o.subscription})}}},"./src/sdk/services/logging.service.ts":function(s,e,t){"use strict";var i=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0;const o=t("./node_modules/error-stack-parser/error-stack-parser.js"),l=t("./src/sdk/constants.ts"),p=t("./src/_utils/global-env.ts"),r=t("./src/sdk/utils.ts"),u=t("./src/sdk/exceptions/pushly.exception.ts"),h=t("./src/sdk/enums/steamable-event-type.enum.ts"),d=t("./src/sdk/models/context.model.ts"),c=["test",l.ENV_NAME_DEV,l.ENV_NAME_LOCAL,l.ENV_NAME_STAGING],a=["test",l.ENV_NAME_LOCAL_PRODUCTION,l.ENV_NAME_PRODUCTION];e.Logger=new class{constructor(){this.logs=[],this.applicationName=l.PUSHLY_SDK_APPLICATION_NAME,this.color=null,this.backgroundColor=null,this.subApplicationName=null,this.plugins=[];var s=(this.visibleLogsEnabled=!1,p.getNavigator)();try{if("plugins"in s)for(var e=0;e<s.plugins.length;e++)this.plugins.push(s.plugins[e].name)}catch(s){this.plugins.push("unable to collect plugin information")}}setVisibleLogsEnabled(s){this.visibleLogsEnabled=s}getComputedApplicationName(){let s=this.applicationName;return s=this.subApplicationName?this.applicationName+"::"+this.subApplicationName:s}print(s,e){var t;if((0,p.getSelf)().console)for(t of Array.isArray(e)?e:[e]){t instanceof Object&&(t=JSON.stringify(t));const o=[`[${this.getComputedApplicationName()}] `+t],n=[];this.color&&n.push("color: "+this.color),this.backgroundColor&&n.push("background-color: "+this.backgroundColor),n&&(o[0]="%c"+o[0],o.push(n.join(";"))),console[s].apply(console,o)}}getBacktrace(e){let t=[];try{let s=(0,o.parse)(e);s.forEach(s=>{t.push({file:s.fileName,line:s.lineNumber,column:s.columnNumber,function:s.functionName})})}catch(e){this.warn(e),t.push({file:"logging.service.ts",line:"1",function:"getBacktrace"})}return t}debug(...s){this.logs=Array.prototype.concat(this.logs,s.map(s=>["debug",s])),!this.visibleLogsEnabled&&-1===c.indexOf(l.ENV_NAME)||this.print("debug",s)}info(...s){this.logs=Array.prototype.concat(this.logs,s.map(s=>["info",s])),!this.visibleLogsEnabled&&-1===c.indexOf(l.ENV_NAME)||this.print("log",s)}warn(...s){this.logs=Array.prototype.concat(this.logs,s.map(s=>["warn",s])),!this.visibleLogsEnabled&&-1===c.indexOf(l.ENV_NAME)||this.print("warn",s)}error(...n){let i;if(n[0]instanceof d.ContextModel&&(i=n.shift()),this.logs=Array.prototype.concat(this.logs,n.map(s=>["error",s])),!this.visibleLogsEnabled&&-1===c.indexOf(l.ENV_NAME)||this.print("error",n),i&&0<n.length){let s=0,t=[],e=(this.logs.forEach(s=>{var e=s[0],s=s[1]instanceof Error?s[1].message:s[1];t.push([e,s])}),1<n.length&&-1===(s=n.findIndex(s=>s instanceof Error))&&(s=0),n.splice(s,1)),o=(e&&0<e.length?e=e[0]:(e=new Error("Cannot resolve error from logs")).code="sw/cannot-resolve-error-from-logs",e instanceof Error?e:new Error(e));if(o instanceof Error){let s=!1;const r={error_type:o.name,error_message:o.message,backtrace:this.getBacktrace(o),logs:Array.from(t).splice(t.length-15,15),plugins:this.plugins};o instanceof u.PushlyException&&(s=o.shouldSuppress(),"originError"in o&&o.originError instanceof Error&&(r.error_message!=o.originError.message&&(r.error_message=r.error_message+"; "+o.originError.message),r.backtrace=this.getBacktrace(o.originError)));var{context:n,code:p}=o;p&&(r.error_code=p),r.context={suppressed:s||!1,originError:o.originError||null};try{r.context=Object.assign(Object.assign({},r.context),n)}catch(s){}let e=!1;i.domain&&i.domain.hasFlag("SDK_DEBUG_EVENTS")&&(e=!0),s&&!e||this.streamError(i,r)}}}streamError(o,n){return i(this,void 0,void 0,function*(){var s=o.domain||{},e=o.user||{},t=(n=Object.assign(Object.assign({},n),{sdk_version:2,source:{application:this.applicationName,version:l.PUSHLY_APPLICATION_VERSION},page_url:o.env.location.toString(),pushly_unique_user_id:e.puuid}),"safari"in(0,p.getSelf)()?"apns_token":"fcm_subscription_id"),t=(n[t]=e.token,{action:h.StreamableEventType.ERROR,domain_id:s.id,domain_key:o.domainKey,event_date:(new Date).toISOString(),meta:n});-1!==a.indexOf(l.ENV_NAME)?(0,r.retryFetch)(l.EVENTS_ENDPOINT,{headers:{"content-type":"text/plain"},method:"POST",body:JSON.stringify(t)},()=>{}):console.log(t)})}setSubApplicationName(s){this.subApplicationName=s}setColor(s){this.color=s}setBackgroundColor(s){this.backgroundColor=s}}},"./src/sdk/services/prompt.service.ts":function(s,e,t){"use strict";var n=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.PromptService=void 0;const i=t("./src/sdk/constants.ts"),p=t("./src/sdk/services/logging.service.ts"),r=t("./src/_utils/global-env.ts"),o=t("./src/sdk/enums/prompt-style.enum.ts"),l=t("./src/sdk/prompts/native.prompt.ts"),u=t("./src/sdk/enums/event-type.enum.ts");var h=t("./src/sdk/models/events/eventable.model.ts");const d=t("./src/sdk/models/events/event.model.ts"),c=t("./src/sdk/prompts/dom.prompt.ts"),a=t("./src/sdk/prompts/custom.prompt.ts"),m=t("./src/sdk/factories/prompt.factory.ts"),y=t("./src/sdk/prompts/bell.prompt.ts"),v=t("./src/sdk/prompts/slide.prompt.ts");class _ extends h.EventableModel{constructor(){super(),this.k=[],this.C={},this._wireEvents()}_wireEvents(){var s=this._handleWebPushNotSupported.bind(this);this.watch(u.EventType.WEB_PUSH_NOT_SUPPORTED,s)}_handleWebPushNotSupported(s,e,t){this.setCustomPromptUnsupportedClassname(e,t)}performManualPromptLoad(t,o){return n(this,void 0,void 0,function*(){let s;var e;(o=o||{}).id?s=this.C[o.id]:0<this.k.length&&(s=this.k[0])&&p.Logger.info(`No prompt ID specified - using already loaded prompt ${s.promptId}.`),s?(p.Logger.info(`Prompt, ${s.promptId}, is already running.`),s.bypassEligibilityCheck=void 0===o.checkEligibility||!o.checkEligibility,s.hasOwnProperty("shown")&&!s.shown&&s.run({bypassEligibilityCheck:s.bypassEligibilityCheck})):(o.id?s=this.getPromptById(t,o.id):(e=this.loadPrompts(t,{isSafari:t.env.isSafari()}),0<length&&(s=e[0])),s&&(s instanceof c.DomPrompt&&(yield s.attachToDom()),yield s.run({bypassEligibilityCheck:void 0===o.checkEligibility||!o.checkEligibility})))})}loadPrompts(s,e={}){const t=m.PromptFactory.getPrompts(s,e);return t.forEach(s=>{this._cachePrompt(s.promptId,s)}),t&&0===length&&this.dispatch(new d.EventModel(u.EventType.NO_ELIGIBLE_PROMPTS)),t}setCustomPromptUnsupportedClassname(s,e){return n(this,void 0,void 0,function*(){(yield this._locateCustomPrompt())&&this._loadUnsupportedCustomPrompt(s,e)})}getPromptById(s,e){const t={};let o;if(t.prompt=s.domain.prompts.find(s=>s.id.toString()===e.toString()),t.prompt&&(t.group=s.domain.promptGroups.find(s=>s.id.toString()===t.prompt.prompt_group_id.toString())),t.group){const n=this._selectPromptClass(t.prompt.style);o=new n(s,t)}return o}_selectPromptClass(s){return{[o.PromptStyle.Native]:l.NativePrompt,[o.PromptStyle.Slide]:v.SlidePrompt,[o.PromptStyle.Bell]:y.BellPrompt,[o.PromptStyle.Custom]:a.CustomPrompt}[s]}_cachePrompt(s,e){this.k.push(e),this.C[s]=e}_locateCustomPrompt(){return n(this,void 0,void 0,function*(){let n=0;return new Promise((t,s)=>{const o=setInterval(()=>{20<=n&&(clearInterval(o),t(!1)),n++;const s=(0,r.getDocument)();var e;s.getElementsByClassName&&(e=s.getElementsByClassName(i.DEFAULT_CLASSNAME_PROMPT_CUSTOM))&&0<e.length&&(clearInterval(o),t(!0))},500)})})}_loadUnsupportedCustomPrompt(s,e){s={app:{loadConfig:s},user:{env:e}};const t=new a.CustomPrompt(s,{},!1);t.runInUnsupportedMode()}}e.PromptService=new _},"./src/sdk/services/registration.service.ts":function(s,e,t){"use strict";var h=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.RegistrationService=void 0;const d=t("./src/sdk/constants.ts"),p=t("./src/sdk/services/helpers/apns.service-helpers.ts"),r=t("./src/sdk/services/helpers/vapid.service-helpers.ts"),c=t("./src/sdk/services/logging.service.ts"),l=t("./src/sdk/services/user.service.ts"),n=t("./src/sdk/services/worker.service.ts"),a=t("./src/sdk/utils.ts"),m=t("./src/sdk/models/events/subscriber-streamable-event.model.ts"),u=t("./src/sdk/models/events/event.model.ts"),y=t("./src/sdk/data-providers/cookie.data-provider.ts"),v=t("./src/sdk/enums/runtime-environment.enum.ts"),_=t("./src/sdk/repositories/user.repository.ts"),b=t("./src/sdk/enums/steamable-event-type.enum.ts"),o=t("./src/sdk/prompts/dom.prompt.ts"),f=t("./src/sdk/enums/event-type.enum.ts");var i=t("./src/sdk/models/events/eventable.model.ts");const g=t("./src/sdk/prompts/base.prompt.ts");class w extends i.EventableModel{constructor(){super(),this._wireEvents()}_wireEvents(){var s=this._handlePromptAllowed.bind(this),e=this._handlePromptDisabled.bind(this);this.watch(f.EventType.PROMPT_ALLOWED,s),this.watch(f.EventType.PROMPT_DISABLED,e)}_handlePromptAllowed(s,e,t){return h(this,void 0,void 0,function*(){if(!e.domain.isEventOnlyMode())return this._tryRegistration(e,t);c.Logger.warn("Prompt events are suppressed while in event only mode")})}_handlePromptDisabled(s,e,t){return h(this,void 0,void 0,function*(){var s;e.domain.isEventOnlyMode()?c.Logger.warn("Prompt events are suppressed while in event only mode"):(s=this._getPromptRegistrationData(e,t),this._handlePermissionDenied(e,s))})}tryMigration(n,i=!0){return h(this,void 0,void 0,function*(){if(n.domain.isEventOnlyMode())c.Logger.warn("Cannot try migration while in event only mode");else{let s;var e,t,o;(s=n.env.isPushManagerInScope()?yield r.VapidServiceHelpers.getToken(n):yield p.ApnsServiceHelpers.getToken(n))&&s!==n.user.token&&(c.Logger.info("Subscription token refreshed by the remote end. Migrating subscription."),"granted"===(o=yield n.user.getLocalPushPermission(n)).permission&&(n.env.primaryRuntimeEnvironment===v.RuntimeEnvironment.PROXY||(yield n.user.isUnsubscribed(n)))||(e=yield n.user.isSubscribed(n),t=n.user.token,n.user.token=s,yield _.UserRepository.set(n.user),o=this._sendSubscriptionToRemote(n,{subscription_data:o.subscription||void 0,token:s,previous_token:t,external_id:n.user.externalId,domain_key:n.domain.domainKey,amp:n.env.primaryRuntimeEnvironment===v.RuntimeEnvironment.AMP,migrated:!0,pushly_subscriber_data_present:e}),i&&(yield o),this.dispatch(new u.EventModel(f.EventType.REGISTRATION_MIGRATED,s))))}})}_shouldOpenProxyRegistrationWindow(s){return!s.domain.isEventOnlyMode()&&s.env.primaryRuntimeEnvironment===v.RuntimeEnvironment.PROXY&&s.env.subRuntimeEnvironment!==v.RuntimeEnvironment.PROXY_PERMISSION_DIALOG}_tryRegistration(e,t){return h(this,void 0,void 0,function*(){var s;{if(!e.domain.isEventOnlyMode())return s=this._getPromptRegistrationData(e,t),this._shouldOpenProxyRegistrationWindow(e)?this._openProxyRegistrationWindow(e,s):this._register(e,s);c.Logger.warn("Cannot try registration while in event only mode")}})}performManualRegistrationAttempt(e,t,o){return h(this,void 0,void 0,function*(){var s;{if(!e.domain.isEventOnlyMode())return yield n.WorkerService.registerWorker(e),s=this._getPromptRegistrationData(e,{promptId:t,promptKeywords:o}),this._shouldOpenProxyRegistrationWindow(e)?this._openProxyRegistrationWindow(e,s):this._register(e,s);c.Logger.warn("Cannot perform manual registration attempt while in event only mode")}})}unsubscribe(o,n="blocked"){return h(this,void 0,void 0,function*(){if(o.domain.isEventOnlyMode())c.Logger.warn("Cannot perform unsubscribe request while in event only mode");else{const e=this._buildPromptPermissionEventPack(),t=yield o.user.getLocalPushPermission(o);var s=yield o.user.isSubscribed(o);t.subscription&&s&&o.env.isPushManagerInScope()&&o.env.primaryRuntimeEnvironment!==v.RuntimeEnvironment.PROXY&&(c.Logger.info("Processing subscription unsubscribe request"),e.meta=Object.assign(Object.assign({},e.meta),{subscription_data:t.subscription}),yield t.subscription.unsubscribe(),o.user.setPushPermission(t)),s&&(yield l.UserService.setSubscriptionState(o.user,n),this.post(new m.SubscriberStreamableEventModel(b.StreamableEventType.MANUAL_UNSUBSCRIBED,e,o)),this.dispatch(new u.EventModel(f.EventType.REGISTRATION_UNSUBSCRIBED,this._buildClientFeedbackEventPack())),c.Logger.info("User has been unsubscribed from notifications"))}})}_register(o,n){return h(this,void 0,void 0,function*(){if(o.domain.isEventOnlyMode())c.Logger.warn("Cannot perform registration while in event only mode");else{let s;var e=this._handlePermissionPrompted.bind(this,o,n);const{env:t}=o["user"];"granted"===(s=t.isPushManagerInScope()?yield r.VapidServiceHelpers.requestNotificationPermission(o,e):yield p.ApnsServiceHelpers.requestNotificationPermission(o,e)).permissionState?(yield this._handlePermissionGranted(o,n),o.domain.shouldUseVapid()&&(s=yield r.VapidServiceHelpers.handleNotificationPermissionGranted(o,s)),yield this._handleSubscriptionSuccess(o,s,n)):"default"===s.permissionState?this._handlePermissionDismissed(o,n):"denied"===s.permissionState?this._handlePermissionDenied(o,n):c.Logger.warn("Unknown")}})}_sendSubscriptionToRemote(t,o){return h(this,void 0,void 0,function*(){if(t.domain.isEventOnlyMode())c.Logger.warn("Cannot send subscription data while in event only mode");else if(t.user.subscriptionRegistered)c.Logger.warn(t,"Attempt to register subscription token more than once detected");else{const e={meta:Object.assign({},o)};var s=this.gatherAdditionalSubData(t),s=(s&&(e.meta.page_meta_properties=s),o.previous_token?e.meta.migrated=!0:e.meta.subscribed_referrer=(t.user.lastReferrerState||{}).referrer,new m.SubscriberStreamableEventModel(b.StreamableEventType.SUBSCRIBED,e,t));yield this.post(s,d.ALLOW_ENDPOINT),t.user.subscriptionRegistered=!0,yield _.UserRepository.set(t.user)}})}gatherAdditionalSubData(n){try{var s=n["domain"];const i={};if(Array.isArray(s.additionalSubscriptionData)){const e=s.additionalSubscriptionData;e.forEach(s=>{try{var e=s.profile_property;const o=s.selectors;if(e&&Array.isArray(o)){let t;o.some(s=>{var e=s.selector,s=s.value;return e&&s&&(e=n.env.document.head.querySelector(`[${e}~='${s}'][content]`),t=(e||{}).content),!!t}),t&&(i[e]=t)}}catch(s){}})}if(0<Object.keys(i).length)return i}catch(s){}}_handlePermissionPrompted(s,e){s.domain.isEventOnlyMode()?c.Logger.warn("Permission events are suppressed while in event only mode"):(this.post(new m.SubscriberStreamableEventModel(b.StreamableEventType.PERMISSION_PROMPTED,Object.assign({},e.streamPack),s)),this.dispatch(new u.EventModel(f.EventType.LEGACY_PERMISSION_DIALOG_SHOWN)),this.dispatch(new u.EventModel(f.EventType.PERMISSION_DIALOG_SHOWN,e.clientPack)))}_handlePermissionGranted(s,e){return h(this,void 0,void 0,function*(){s.domain.isEventOnlyMode()?c.Logger.warn("Permission events are suppressed while in event only mode"):(this.post(new m.SubscriberStreamableEventModel(b.StreamableEventType.PERMISSION_ACCEPTED,Object.assign({},e.streamPack),s)),this.dispatch(new u.EventModel(f.EventType.LEGACY_PERMISSION_GRANTED)),this.dispatch(new u.EventModel(f.EventType.PERMISSION_GRANTED,e.clientPack)))})}_handleSubscriptionSuccess(i,p,r){return h(this,void 0,void 0,function*(){if(i.domain.isEventOnlyMode())c.Logger.warn("Permission events are suppressed while in event only mode");else{c.Logger.info("Got token: "+p.token);const o=i["domain"];i.user.token=p.token;var e=i.env.isPushManagerInScope()?"fcm_subscription_id":"apns_token",t=i.env.getQueryString();let s=i.env.location.href;d.PUSHLY_SUBSCRIBED_URL_QS in t&&(s=decodeURIComponent(t[d.PUSHLY_SUBSCRIBED_URL_QS]));const n={[e]:o.shouldUseVapid()?void 0:p.token,subscription_data:p.subscription||void 0,external_id:i.user.externalId,subscribed_url:s,prompt_id:r.promptId,domain_key:i.domain.domainKey,amp:i.env.primaryRuntimeEnvironment===v.RuntimeEnvironment.AMP};r.promptId&&r.promptKeywords&&(n.tag=r.promptKeywords,n.keywords=r.promptKeywords),yield this._sendSubscriptionToRemote(i,n),l.UserService.setSubscriptionState(i.user,"subscribed",p.token),y.CookieDataProvider.set("_pnpds",window.location.hostname),this.post(new m.SubscriberStreamableEventModel(b.StreamableEventType.PAGE_VIEW,{meta:{subscription_data:p.subscription}},i)),this.dispatch(new u.EventModel(f.EventType.REGISTRATION_SUBSCRIBED,p.token))}})}_handlePermissionDismissed(s,e){s.domain.isEventOnlyMode()?c.Logger.warn("Permission events are suppressed while in event only mode"):(this.post(new m.SubscriberStreamableEventModel(b.StreamableEventType.PERMISSION_DISMISSED,Object.assign({},e.streamPack),s)),l.UserService.setSubscriptionState(s.user,"dismissed",null,e),this.dispatch(new u.EventModel(f.EventType.PERMISSION_DISMISSED,e.clientPack)))}_handlePermissionDenied(s,e){s.domain.isEventOnlyMode()?c.Logger.warn("Permission events are suppressed while in event only mode"):(this.post(new m.SubscriberStreamableEventModel(b.StreamableEventType.PERMISSION_DENIED,Object.assign({},e.streamPack),s)),l.UserService.setSubscriptionState(s.user,"blocked",null,e),this.dispatch(new u.EventModel(f.EventType.PERMISSION_DENIED,e.clientPack)))}_getPromptRegistrationData(s,e){const t={};s=s.env.getQueryString();return e instanceof g.BasePrompt?(t.promptId=e?e.promptId:void 0,t.promptBehavior=e?e.promptConfig.behavior:void 0,e&&e instanceof o.DomPrompt&&(t.promptKeywords=e.keywords)):(t.promptId=(e||{}).promptId,t.promptKeywords=(e||{}).promptKeywords),d.PUSHLY_PROMPT_ID_QS in s&&(t.promptId=(0,a.tryParseInt)(s[d.PUSHLY_PROMPT_ID_QS])),t.streamPack=this._buildPromptPermissionEventPack(t.promptId,t.promptKeywords),t.clientPack=this._buildClientFeedbackEventPack(t.promptId,t.promptKeywords),t}_openProxyRegistrationWindow(l,u){return h(this,void 0,void 0,function*(){if(l.domain.isEventOnlyMode())c.Logger.warn("Cannot open proxy registration window while in event only mode");else{const t=l.env.document;var s=l.domain.customAllowDomain;const o=t.createElement("a");var e,s=`https://${s}/`+l.domain.domainKey;o.href=s;const n=(0,a.parseQueryString)(o.search),i=(n[d.PUSHLY_SUBSCRIBED_URL_QS]=encodeURIComponent(l.env.location.toString()),n[d.PUSHLY_UNIQUE_USER_ID_QS]=l.user.puuid,n[d.PUSHLY_DOMAIN_KEY_QS]=l.domain.domainKey,n[d.PUSHLY_PROMPT_ID_QS]=u.promptId,[]);for(e in n)i.push(e+"="+n[e]);s=`${o.protocol}//${o.host}${o.pathname}?`+i.join("&");const p=l.env.scope.open(s,"Push Notification Registration","directories=0,toolbar=0,status=0,menubar=0,width=680,height=550");if(p){this.post(new m.SubscriberStreamableEventModel(b.StreamableEventType.PROXY_WINDOW_OPENED,{meta:{promptId:u.promptId}},l));const r=l.env.scope.setInterval(()=>{p.closed&&(clearInterval(r),this.post(new m.SubscriberStreamableEventModel(b.StreamableEventType.PROXY_WINDOW_CLOSED,{meta:{promptId:u.promptId}},l)))},1e3)}else this.post(new m.SubscriberStreamableEventModel(b.StreamableEventType.PROXY_WINDOW_BLOCKED,{meta:{promptId:u.promptId}},l))}})}_buildPromptPermissionEventPack(s=null,e){const t={meta:{promptId:s}};return s&&e&&(t.meta.keywords=e),t}_buildClientFeedbackEventPack(s=null,e=[]){return{prompt:{id:s,keywords:e}}}}e.RegistrationService=new w},"./src/sdk/services/user-debug.service.ts":function(s,e,t){"use strict";var o=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.UserDebugService=void 0;const g=t("./src/sdk/services/logging.service.ts"),n=t("./src/_utils/global-env.ts");e.UserDebugService=class{static shouldShowDebugPanel(){var s=(0,n.getLocation)();let e=!1;try{e="search"in s&&/(^|[?&#])((pushly_debug73485)|(push(ly)?_debug))=1(?=[&#]|$)/i.test(s.search)}catch(s){}return e}static showDebugPanel(f){return o(this,void 0,void 0,function*(){f.domain;const e=f.user,t=f.env;try{const r=t.document,l=r.createElement("style");r.head.appendChild(l),l.innerHTML=`
.sw-user-debug-drawer-wrapper {
  display: block !important;
  box-sizing: border-box;
  position: absolute;
  z-index: 7777;
  bottom: 120px;
  left: -320px;
  width: 320px;
  border: 1px solid #d9d9d9;
  border-left: none;
  box-shadow: 0 1px 4px #e9e9e9;
  background: #f5f5f7;
  transition: left .24s linear;
}
.sw-user-debug-drawer-wrapper.open {
  left: 0;
}

.sw-user-debug-drawer-wrapper .sw-user-debug-shadow {
  visibility: hidden;
  border: none;
  box-shadow: none;
  outline: none;
  position: absolute;
  z-index: -1;
}

.sw-user-debug-drawer-wrapper .sw-user-debug-shadow.copying {
  visibility: visible;
}

.sw-user-debug-drawer-wrapper .sw-user-debug-drawer .sw-user-debug-drawer-handle {
  cursor: pointer;
  display: block;
  box-sizing: border-box;
  position: absolute;
  background: #0077a0;
  border-radius: 0 0 12px 12px;
  border: 1px solid #888;
  border-top: none;
  top: 50%;
  transform: translateY(-50%) rotate(-90deg);
  padding: 8px 38px 8px 38px;
  right: -90px;
  box-shadow: 0 1px 3px #e9e9e9;
  color: #fff;
  font-family: arial;
  font-size: 13px;
}

.sw-user-debug-drawer-wrapper .sw-user-debug-drawer .sw-user-debug-drawer-content {
  color: #545454;
  font-family: arial;
  font-size: 13px;
  padding: 14px;
}

.sw-user-debug-drawer-wrapper .sw-user-debug-drawer .sw-user-debug-drawer-content .sw-user-debug-label {
  color: #949494;
  display: block;
  box-sizing: border-box;
  margin-bottom: 4px;
}
.sw-user-debug-drawer-wrapper .sw-user-debug-drawer .sw-user-debug-drawer-content .sw-user-debug-value {
  display: block;
  word-break: break-all;
}

.sw-user-debug-drawer-wrapper .sw-user-debug-drawer .sw-user-debug-drawer-content .sw-user-debug-puuid {
  border-bottom: 1px solid #d9d9d9;
  padding: 0 12px 6px;
}

.sw-user-debug-drawer-wrapper .sw-user-debug-drawer .sw-user-debug-drawer-content .sw-user-debug-substate {
  border-bottom: 1px solid #d9d9d9;
  padding: 6px 12px;
}

.sw-user-debug-drawer-wrapper .sw-user-debug-drawer .sw-user-debug-drawer-content .sw-user-debug-token {
  padding: 6px 12px 0;
}

.sw-user-debug-drawer-wrapper .sw-user-debug-drawer .sw-user-debug-drawer-content .sw-user-debug-action-wrapper {
  text-align: right;
}

.sw-user-debug-drawer-wrapper .sw-user-debug-drawer .sw-user-debug-drawer-content .sw-user-debug-copy-btn {
  display: inline-block;
  margin: 12px 12px 0;
  padding: 4px 14px;
  background: #0077a0;
  border-radius: 3px;
  color: #fff;
  transition: all .24s;
  cursor: pointer;
}
.sw-user-debug-drawer-wrapper .sw-user-debug-drawer .sw-user-debug-drawer-content .sw-user-debug-copy-btn.success {
  background: green;
}
`.trim();var o,n=e.puuid,i=e.subscriberState.toString().replace(/(^.)/,s=>s.toUpperCase()),p="subscribed"===e.subscriberState?e.token:"N/A";let s="Unable to Resolve";try{t.isPushManagerInScope()?(o=(yield f.user.getComputedPushPermission(f)).subscription)&&(s=o.endpoint):s="N/A"}catch(s){}const u=r.createElement("div"),h=(u.classList.add("sw-user-debug-drawer-wrapper"),u.setAttribute("style","display:none;"),r.createElement("div")),d=(u.appendChild(h),h.classList.add("sw-user-debug-drawer"),r.createElement("div")),c=(h.appendChild(d),d.classList.add("sw-user-debug-drawer-handle"),d.onclick=()=>{u.classList.contains("open")?u.classList.remove("open"):u.classList.add("open")},d.innerHTML=`
<span class="sw-user-debug-label">
    Push SDK
</span>
`.trim(),r.createElement("div")),a=(h.appendChild(c),c.classList.add("sw-user-debug-drawer-content"),r.createElement("div")),m=(c.appendChild(a),a.classList.add("sw-user-debug-puuid"),a.innerHTML=`
<span class="sw-user-debug-label">
    Push User ID
</span>
<span class="sw-user-debug-value">
    ${n}
</span>
`.trim(),r.createElement("div")),y=(c.appendChild(m),m.classList.add("sw-user-debug-substate"),m.innerHTML=`
<span class="sw-user-debug-label">
    Subscriber State
</span>
<span class="sw-user-debug-value">
    ${i}
</span>
`.trim(),r.createElement("div")),v=(c.appendChild(y),y.classList.add("sw-user-debug-token"),y.innerHTML=`
<span class="sw-user-debug-label">
    Subscriber Token
</span>
<span class="sw-user-debug-value">
    ${p}
</span>
`.trim(),r.createElement("input")),_=(u.appendChild(v),v.classList.add("sw-user-debug-shadow"),v.type="textarea",v.defaultValue=`
Push User ID: ${n}, \r

Subscriber State: ${i}, \r

Token: ${p}, \r

Endpoint: ${s}, \r

Browser Permissions: ${(yield f.user.getComputedPushPermission(f)).permission}, \r

UserAgent: ${t.userAgent}
`.trim(),r.createElement("div")),b=(c.appendChild(_),_.classList.add("sw-user-debug-action-wrapper"),r.createElement("div"));_.appendChild(b),b.classList.add("sw-user-debug-copy-btn"),b.innerText="Copy",b.onclick=()=>{v.classList.add("copying"),v.select(),r.execCommand("copy"),v.classList.remove("copying"),b.classList.add("success"),setTimeout(()=>{b.classList.remove("success")},240)},r.body.appendChild(u)}catch(s){g.Logger.warn(s)}})}}},"./src/sdk/services/user.service.ts":function(s,e,t){"use strict";var r=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.UserService=void 0;const p=t("./src/sdk/services/helpers/user-profile.service-helpers.ts"),o=t("./src/sdk/models/events/subscriber-streamable-event.model.ts"),l=t("./src/sdk/data-providers/cookie.data-provider.ts"),n=t("./src/sdk/repositories/subscription.repository.ts"),u=t("./src/sdk/enums/event-type.enum.ts"),h=t("./src/_utils/global-env.ts"),i=t("./src/sdk/repositories/application.repository.ts"),d=t("./src/sdk/services/logging.service.ts"),c=t("./src/sdk/services/registration.service.ts");var a=t("./src/sdk/models/events/eventable.model.ts");const m=t("./src/sdk/models/events/event.model.ts"),y=t("./src/sdk/repositories/user.repository.ts"),v=t("./src/sdk/constants.ts"),_=t("./src/sdk/enums/steamable-event-type.enum.ts"),b=t("./src/sdk/utils.ts"),f=t("./src/sdk/services/worker.service.ts");class g extends a.EventableModel{constructor(){super(...arguments),this.userProfileEventsWired=!1}loadUser(s,o){return r(this,void 0,void 0,function*(){let s=yield y.UserRepository.get();var e=!s.puuid;let t;return o.env.inWorkerGlobalScope()||(t=o.env.getQueryString()[v.PUSHLY_UNIQUE_USER_ID_QS]),s.env=o.env,e&&(s.puuid=t||(0,b.randomString)()),s.puuid&&/undefined/i.test(s.puuid.toString())&&(s.puuid=(0,b.randomString)()),o.domain.isEventOnlyMode()||!(yield y.UserRepository.getPromptDismissedState())&&s.isDismissed()&&(s.subscriberState="none"),yield y.UserRepository.set(s),s})}reloadUserWithCachePriority(e){return r(this,void 0,void 0,function*(){var s=yield y.UserRepository.getWithCachePriority();return e.puuid=s.puuid||e.puuid,e.subscriberState=s.subscriberState||e.subscriberState,e.token=s.token||e.token,e})}wireProfileEvents(e){if(!this.userProfileEventsWired){this.userProfileEventsWired=!0;const s=[u.EventType.PROFILE_UPDATE,u.EventType.PROFILE_UPDATE_EXTERNAL_ID,u.EventType.PROFILE_UPDATE_USER_EVENT,u.EventType.PROFILE_UPDATE_TAGS,u.EventType.PROFILE_APPEND,u.EventType.PROFILE_REMOVE,u.EventType.PAGE_TAG_VISIT,u.EventType.VIEW_ITEM,u.EventType.SAVE_ITEM,u.EventType.ADD_TO_CART,u.EventType.UPDATE_CART_ITEM,u.EventType.PURCHASE,u.EventType.REQUEST_USER_DELETION];s.forEach(s=>{this._wireProfileEvent(e,s)})}}verifyUserSubscriptionState(p){return r(this,void 0,void 0,function*(){const e=p.env,s=p.domain,t=p.user;if(s.isEventOnlyMode())d.Logger.info("Skipping user subscription state verification while in event only mode");else{d.Logger.info("Verifying user subscription state");let s;(e.isHTTPS()||e.isDevMode())&&(s=yield p.user.getComputedPushPermission(p));var o=l.CookieDataProvider.get("_pnss"),n="subscribed"===(t.subscriberState=o),i="dismissed"===o;"blocked"===o?!(p.env.isSafari()&&"PushManager"in(0,h.getSelf)())&&s&&"denied"!==s.permission?"granted"===s.permission&&s.host===(0,h.getSelf)().location.hostname?yield c.RegistrationService.performManualRegistrationAttempt(p,t.lastSeenPromptId):"default"===s.permission&&this.setSubscriptionState(t,"none"):("blocked"!==t.subscriberState&&(t.subscriberState="blocked"),this.dispatch(new m.EventModel(u.EventType.EXIT_PERMISSIONS_DENIED)),this.debugPromptNotShown(p,"user_permission_denied")):i?s&&"default"!==s.permission?"granted"===s.permission&&s.host===(0,h.getSelf)().location.hostname?yield c.RegistrationService.performManualRegistrationAttempt(p,t.lastSeenPromptId):"denied"===s.permission&&(yield this.setSubscriptionState(t,"blocked"),this.dispatch(new m.EventModel(u.EventType.EXIT_PERMISSIONS_DENIED)),this.debugPromptNotShown(p,"user_permission_denied")):("dismissed"!==t.subscriberState&&(t.subscriberState="dismissed"),this.dispatch(new m.EventModel(u.EventType.EXIT_PERMISSIONS_DISMISSED)),this.debugPromptNotShown(p,"user_permission_dismissed")):n?s&&"granted"!==s.permission?"default"===s.permission?(yield this.setSubscriptionState(t,"none"),yield c.RegistrationService.unsubscribe(p,"none")):"denied"===s.permission&&(t.token=null,yield c.RegistrationService.unsubscribe(p),this.dispatch(new m.EventModel(u.EventType.EXIT_PERMISSIONS_DENIED)),this.debugPromptNotShown(p,"user_permission_denied")):"subscribed"!==t.subscriberState&&(t.subscriberState="subscribed"):s&&"default"!==s.permission?"granted"===s.permission?(t.subscriberState="subscribed",s.host===(0,h.getSelf)().location.hostname&&(yield c.RegistrationService.performManualRegistrationAttempt(p,t.lastSeenPromptId))):"denied"===s.permission&&(yield this.setSubscriptionState(t,"blocked"),this.dispatch(new m.EventModel(u.EventType.EXIT_PERMISSIONS_DENIED)),this.debugPromptNotShown(p,"user_permission_denied")):"none"!==t.subscriberState&&(t.subscriberState="none")}"none"===t.subscriberState?d.Logger.info("Subscription state is currently set to none."):"subscribed"===t.subscriberState?d.Logger.info("Subscription state is currently set to subscribed."):"dismissed"===t.subscriberState?d.Logger.info("Subscription state is currently set to dismissed."):"blocked"===t.subscriberState&&d.Logger.info("Subscription state is currently set to blocked."),yield y.UserRepository.set(t)})}setExternalId(s,e){return r(this,void 0,void 0,function*(){s.externalId=e,yield y.UserRepository.set(s)})}saveExternalId(s,e){return r(this,void 0,void 0,function*(){yield this.setExternalId(s.user,e),yield p.UserProfileServiceHelpers.saveExternalUserId(s,e)})}setToken(s,e){return r(this,void 0,void 0,function*(){s.token=e,yield y.UserRepository.set(s)})}setSubscriptionState(s,e,t,o){return r(this,void 0,void 0,function*(){d.Logger.info("Updating subscriber state to "+e),s.subscriberState=e,t?s.token=t:t=null,yield y.UserRepository.set(s),"dismissed"===s.subscriberState&&o&&(yield y.UserRepository.setPromptDismissedState(s,o))})}setLastSeenPromptId(s,e){return r(this,void 0,void 0,function*(){s.lastSeenPromptId=e,yield y.UserRepository.set(s)})}setPromptState(s,e,t,o){return r(this,void 0,void 0,function*(){s.promptFcapSeconds=e,s.promptCountState=t,yield y.UserRepository.setPromptState(s,o)})}clearPromptFcapState(){return r(this,void 0,void 0,function*(){yield y.UserRepository.clearPromptState()})}setPromptDismissed(s,e){return r(this,void 0,void 0,function*(){yield y.UserRepository.setPromptDismissedState(s,e)})}setLastReferrerState(s,e){return r(this,void 0,void 0,function*(){s.lastReferrerState={referrer:e,lastSetAt:(new Date).getTime()},yield y.UserRepository.set(s)})}clearLastReferrerState(s){return r(this,void 0,void 0,function*(){delete s.lastReferrerState,yield y.UserRepository.set(s)})}handleUdrRequest(t){return r(this,void 0,void 0,function*(){var s=t.env,e=!!s&&!!l.CookieDataProvider.get("_pnudr");l.CookieDataProvider.set("_pnudr","1"),e?d.Logger.warn("User deletion has already been requested."):(yield this.post(new o.SubscriberStreamableEventModel(_.StreamableEventType.UDR,{},t)),yield n.SubscriptionRepository.unregister(t),i.ApplicationRepository.purgeCookies(),y.UserRepository.purgeCookies(),this.dispatch(new m.EventModel(u.EventType.USER_DELETION_REQUEST,void 0,t.app.loadConfig,s)))})}handleUdrRevert(s){return r(this,void 0,void 0,function*(){l.CookieDataProvider.clear("_pnudr"),yield f.WorkerService.unregisterWorker(s),yield c.RegistrationService.performManualRegistrationAttempt(s,s.user.lastSeenPromptId),d.Logger.warn("User deletion reverted")})}processUdr(){return r(this,void 0,void 0,function*(){return y.UserRepository.purgeCookies()})}_wireProfileEvent(n,i){this.watch(i,t=>{const o=()=>r(this,void 0,void 0,function*(){if(n.app&&n.app.isLoaded){var s=yield n.user.getComputedPushPermission(n);if((s.subscription||s.deviceToken||n.domain.isEventOnlyMode())&&(yield n.user.isSubscribed(n)))try{switch(i){case u.EventType.PROFILE_UPDATE:yield p.UserProfileServiceHelpers.saveUserProfileData(n,t);break;case u.EventType.PROFILE_UPDATE_EXTERNAL_ID:yield this.setExternalId(n.user,t),yield p.UserProfileServiceHelpers.saveExternalUserId(n,t);break;case u.EventType.PROFILE_UPDATE_USER_EVENT:yield p.UserProfileServiceHelpers.saveUserEvent(n,t);break;case u.EventType.PROFILE_UPDATE_TAGS:yield p.UserProfileServiceHelpers.saveUserTags(n,t);break;case u.EventType.PROFILE_APPEND:yield p.UserProfileServiceHelpers.appendProfileArrayValue(n,t);break;case u.EventType.PROFILE_REMOVE:yield p.UserProfileServiceHelpers.removeProfileArrayValue(n,t);break;case u.EventType.PAGE_TAG_VISIT:t=Array.isArray(t)?t:[t],yield p.UserProfileServiceHelpers.pageTagVisit(n,t);break;case u.EventType.VIEW_ITEM:yield p.UserProfileServiceHelpers.viewItem(n,t);break;case u.EventType.SAVE_ITEM:yield p.UserProfileServiceHelpers.saveItem(n,t);break;case u.EventType.ADD_TO_CART:yield p.UserProfileServiceHelpers.addToCart(n,t);break;case u.EventType.UPDATE_CART_ITEM:yield p.UserProfileServiceHelpers.updateCartItem(n,t);break;case u.EventType.PURCHASE:yield p.UserProfileServiceHelpers.purchase(n,t);break;case u.EventType.REQUEST_USER_DELETION:yield this.handleUdrRequest(n)}}catch(s){d.Logger.error(n,s)}else{let s=!0,e;if(i===u.EventType.PROFILE_UPDATE_EXTERNAL_ID?(e=t,s=!1):t instanceof Object&&"external_id"in t&&(e=t.external_id),e&&(yield this.setExternalId(n.user,e)),s){let s,e;s=this.watchOnce(u.EventType.REGISTRATION_SUBSCRIBED,()=>{e&&e(),o()}),e=this.watchOnce(u.EventType.REGISTRATION_MIGRATED,()=>{s&&s(),o()})}}}else this.watchOnce(u.EventType.APPLICATION_LOADED,o)});o()})}}e.UserService=new g},"./src/sdk/services/worker.service.ts":function(s,e,t){"use strict";var n=this&&this.__awaiter||function(s,p,r,l){return new(r=r||Promise)(function(t,e){function o(s){try{i(l.next(s))}catch(s){e(s)}}function n(s){try{i(l.throw(s))}catch(s){e(s)}}function i(s){var e;s.done?t(s.value):((e=s.value)instanceof r?e:new r(function(s){s(e)})).then(o,n)}i((l=l.apply(s,p||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.WorkerService=void 0;const i=t("./src/sdk/constants.ts"),p=t("./src/sdk/services/logging.service.ts"),o=t("./src/_utils/service-worker-registration.ts"),r=t("./src/sdk/models/events/event.model.ts"),l=t("./src/sdk/enums/event-type.enum.ts"),u=t("./src/sdk/repositories/application.repository.ts");var h=t("./src/sdk/models/events/eventable.model.ts");const d=t("./src/sdk/exceptions/worker-registration.exception.ts");class c extends h.EventableModel{_installPushlyServiceWorker(t){return n(this,void 0,void 0,function*(){const s=t.env.navigator;var e=(0,o.getPushlyWorkerConfig)(t);return s.serviceWorker.register(e.installationPath,{updateViaCache:"none",scope:e.scope})})}unregisterWorker(e){return n(this,void 0,void 0,function*(){const s=yield(0,o.getPushlyServiceWorkerRegistration)(e);s&&(yield s.unregister())})}registerWorker(e){return n(this,void 0,void 0,function*(){let s=null;try{(s=yield(0,o.getPushlyServiceWorkerRegistration)(e))||(p.Logger.info("Registering new ServiceWorker"),s=yield this._installPushlyServiceWorker(e),this.dispatch(new r.EventModel(l.EventType.SW_INSTALLED,{registration:s}))),yield u.ApplicationRepository.set(e.app),this.dispatch(new r.EventModel(l.EventType.SW_SETUP_COMPLETE,{registration:s}))}catch(s){throw p.Logger.warn({type:s.type,code:s.code,message:s.message,error:s}),new d.WorkerRegistrationException(s)}return s})}loadServiceWorkerDependencyScript(o){return n(this,void 0,void 0,function*(){const s=o.env.document;if(s&&s.body){const e=s.createElement("script"),t=(e.onload=()=>{p.Logger.info("ServiceWorker dependency script loaded")},e.async=!0,e.src=i.SW_DEPENDENCY_URL,s.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}})}}e.WorkerService=new c},"./src/sdk/utils.ts":(s,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.tryParseJSON=e.parseQueryString=e.hashFromString=e.isProductionBuild=e.simpleUnHash=e.simpleHash=e.atobShim=e.delayRandom=e.delay=e.tryParseInt=e.randomString=e.retryFetch=void 0;var o=t("./src/common/utils.ts");Object.defineProperty(e,"retryFetch",{enumerable:!0,get:function(){return o.retryFetch}}),Object.defineProperty(e,"randomString",{enumerable:!0,get:function(){return o.randomString}}),Object.defineProperty(e,"tryParseInt",{enumerable:!0,get:function(){return o.tryParseInt}}),Object.defineProperty(e,"delay",{enumerable:!0,get:function(){return o.delay}}),Object.defineProperty(e,"delayRandom",{enumerable:!0,get:function(){return o.delayRandom}});const n=t("./src/sdk/constants.ts");e.atobShim=s=>{let e="";try{if("string"==typeof(e=window.atob(s)))return e}catch(s){}e="";var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";if(s=String(s).replace(/[\t\n\f\r ]+/g,""),!/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/.test(s))throw new TypeError("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");s+="==".slice(2-(3&s.length));let o,n,i,p=0;for(;p<s.length;)o=t.indexOf(s.charAt(p++))<<18|t.indexOf(s.charAt(p++))<<12|(n=t.indexOf(s.charAt(p++)))<<6|(i=t.indexOf(s.charAt(p++))),e+=64===n?String.fromCharCode(o>>16&255):64===i?String.fromCharCode(o>>16&255,o>>8&255):String.fromCharCode(o>>16&255,o>>8&255,255&o);return e},e.simpleHash=s=>window.btoa(JSON.stringify(s)),e.simpleUnHash=s=>(0,e.tryParseJSON)((0,e.atobShim)(s)),e.isProductionBuild=()=>"production"===n.ENV_NAME||"prod"===n.ENV_NAME,e.hashFromString=s=>{let e=5381,t=s.length;for(;t;)e=33*e^s.charCodeAt(--t);return e>>>0},e.parseQueryString=s=>{s=s.split("?").pop().split("&");let e={};try{for(var t of s){const o=t.split("=");o[0]&&(o[1]=o[1]?o[1].replace(/\+/gi," "):"",e[o[0]]=decodeURIComponent(o[1]))}}catch(s){}return e};e.tryParseJSON=s=>{let e;try{e=JSON.parse(s)}catch(s){}return e}}},o={};function r(s){var e=o[s];if(void 0!==e)return e.exports;e=o[s]={id:s,exports:{}};return t[s].call(e.exports,e,e.exports,r),e.exports}r.n=s=>{var e=s&&s.__esModule?()=>s.default:()=>s;return r.d(e,{a:e}),e},r.d=(s,e)=>{for(var t in e)r.o(e,t)&&!r.o(s,t)&&Object.defineProperty(s,t,{enumerable:!0,get:e[t]})},r.o=(s,e)=>Object.prototype.hasOwnProperty.call(s,e),r.r=s=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r.nc=void 0;var l={};(()=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0});var e=r("./src/sdk/exceptions/pushly.exception.ts");const s=r("./src/sdk/models/context.model.ts"),t=r("./src/sdk/sdk.ts"),o=r("./src/sdk/services/logging.service.ts");r("./src/sdk/styles/app.scss");try{const p=new t.SDK(new s.ContextModel);var n=window.PushlySDK;if(n&&n instanceof Array)for(var i of n)p.push(i);window.PushlySDK=p}catch(s){if(!(s instanceof e.PushlyException))throw s;console.log(s),o.Logger.warn("[pushly-sdk]",s.message)}})()})();

(function(){
if (document.location.pathname != '/') {
    PushlySDK.watch('ready', () => {
        const qs = document.querySelector('meta[name="keywords"]');
        if (qs && qs.content) {
            PushlySDK.push(['page_tag_visit', qs.content.split(',').map(v => v.trim())]);
        }
    });
}

})();