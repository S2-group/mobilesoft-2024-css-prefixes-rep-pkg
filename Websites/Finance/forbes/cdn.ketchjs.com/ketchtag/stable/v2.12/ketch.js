/*! For license information please see ketch.js.LICENSE.txt */
(()=>{var e={1971:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KetchWebAPI=void 0;const n=i(655);t.KetchWebAPI=class{constructor(e){this._baseUrl=e}getLocation(){return n.__awaiter(this,void 0,void 0,(function*(){return yield this.get("/ip")}))}getBootstrapConfiguration(e){return n.__awaiter(this,void 0,void 0,(function*(){return yield this.get(`/config/${e.organizationCode}/${e.propertyCode}/boot.json`)}))}getFullConfiguration(e){return n.__awaiter(this,void 0,void 0,(function*(){let t="";return e.environmentCode&&e.hash&&e.jurisdictionCode&&e.languageCode&&(t=`/${e.environmentCode}/${e.hash}/${e.jurisdictionCode}/${e.languageCode}`),yield this.get(`/config/${e.organizationCode}/${e.propertyCode}${t}/config.json`)}))}getSubscriptionsConfiguration(e){return n.__awaiter(this,void 0,void 0,(function*(){return yield this.get(`/config/${e.organizationCode}/${e.propertyCode}/${e.languageCode}/subscriptions.json`)}))}getConsent(e){return n.__awaiter(this,void 0,void 0,(function*(){try{const t=yield this.post(`/consent/${e.organizationCode}/get`,e);return t&&t.purposes&&Object.keys(t.purposes).length?t:e}catch(t){return e}}))}setConsent(e){return n.__awaiter(this,void 0,void 0,(function*(){try{yield this.post(`/consent/${e.organizationCode}/update`,e)}catch(e){return}}))}getSubscriptions(e){return n.__awaiter(this,void 0,void 0,(function*(){return yield this.post(`/subscriptions/${e.organizationCode}/get`,e)}))}setSubscriptions(e){return n.__awaiter(this,void 0,void 0,(function*(){yield this.post(`/subscriptions/${e.organizationCode}/update`,e)}))}invokeRight(e){return n.__awaiter(this,void 0,void 0,(function*(){yield this.post(`/rights/${e.organizationCode}/invoke`,e)}))}preferenceQR(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=new URL(`${this._baseUrl}/qr/${e.organizationCode}/${e.propertyCode}/preferences.png`);e.environmentCode&&t.searchParams.set("env",e.environmentCode),e.imageSize&&t.searchParams.set("size",e.imageSize.toString()),e.path&&t.searchParams.set("path",e.path),e.backgroundColor&&t.searchParams.set("bgcolor",e.backgroundColor),e.foregroundColor&&t.searchParams.set("fgcolor",e.foregroundColor);for(const i of Object.keys(e.parameters))t.searchParams.set(i,e.parameters[i]);return t.toString()}))}webReport(e,t){return n.__awaiter(this,void 0,void 0,(function*(){yield this.post(`/report/${e}`,t)}))}get(e){return n.__awaiter(this,void 0,void 0,(function*(){return fetch(this._baseUrl+e,this.fetchOptions("GET")).then((e=>e.json()))}))}post(e,t){return n.__awaiter(this,void 0,void 0,(function*(){return fetch(this._baseUrl+e,this.fetchOptions("POST",t)).then((e=>e.json()))}))}fetchOptions(e,t){const i={method:e,mode:"cors",credentials:"omit"},n="application/json";return t?(i.body=JSON.stringify(t),i.headers={Accept:n,"Content-Type":n}):i.headers={Accept:n},i}}},7187:e=>{"use strict";var t,i="object"==typeof Reflect?Reflect:null,n=i&&"function"==typeof i.apply?i.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};t=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(i,n){function r(i){e.removeListener(t,o),n(i)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",r),i([].slice.call(arguments))}p(e,t,o,{once:!0}),"error"!==t&&function(e,t,i){"function"==typeof e.on&&p(e,"error",t,{once:!0})}(e,r)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function a(e,t,i,n){var r,o,s,a;if(u(i),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),o=e._events),s=o[t]),void 0===s)s=o[t]=i,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[i,s]:[s,i]:n?s.unshift(i):s.push(i),(r=c(e))>0&&s.length>r&&!s.warned){s.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=s.length,a=d,console&&console.warn&&console.warn(a)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},r=d.bind(n);return r.listener=i,n.wrapFn=r,r}function f(e,t,i){var n=e._events;if(void 0===n)return[];var r=n[t];return void 0===r?[]:"function"==typeof r?i?[r.listener||r]:[r]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(r):_(r,r.length)}function h(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function _(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}function p(e,t,i,n){if("function"==typeof e.on)n.once?e.once(t,i):e.on(t,i);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(o){n.once&&e.removeEventListener(t,r),i(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var u=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw u.context=s,u}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var a=c.length,d=_(c,a);for(i=0;i<a;++i)n(d[i],this,t)}return!0},o.prototype.addListener=function(e,t){return a(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return a(this,e,t,!0)},o.prototype.once=function(e,t){return u(t),this.on(e,l(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,l(this,e,t)),this},o.prototype.removeListener=function(e,t){var i,n,r,o,s;if(u(t),void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(r=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){s=i[o].listener,r=o;break}if(r<0)return this;0===r?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,r),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var r,o=Object.keys(i);for(n=0;n<o.length;++n)"removeListener"!==(r=o[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return f(this,e,!0)},o.prototype.rawListeners=function(e){return f(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},o.prototype.listenerCount=h,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},9746:e=>{function t(e){var t=typeof e;return"object"===t?null===e?"null":function(e){if(Array.isArray(e))return!0;var t=e.length;return"number"==typeof t&&t>-1&&(!t||0 in e&&t-1 in e)}(e)?"array":e.constructor===Object?"pure-object":"object":t}e.exports=function e(i,n){if(i===n)return!0;if(i!=i&&n!=n)return!0;var r=t(i);if(r!==t(n))return!1;if("pure-object"===r){if(i===n)return!0;var o=Object.keys(i),s=Object.keys(n).length;if(o.length!==s)return!1;for(var u=0,c=o.length;u<c;u++){var a=o[u];if(!n.hasOwnProperty(o[u]))return!1;var d=i[a],l=n[a];if(d===i||l===n||d===n||l===i)return d===l;if(!e(d,l))return!1}return!0}if("array"===r){if(i.length!==n.length)return!1;for(var f=0;f<i.length;f++){var h=i[f],_=n[f];if(h===i||_===n||h===n||_===i)return h===_;if(!e(h,_))return!1}return!0}if("object"===r){if(i.valueOf!==Object.prototype.valueOf()&&n.valueOf!==Object.prototype.valueOf())return i.valueOf()===n.valueOf();if(i.toString!==Object.prototype.toString()&&n.toString!==Object.prototype.toString())return i.toString()===n.toString()}return!1}},8127:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655),r=(0,i(7040).getLogger)("appDivs");t.default=function(e){var t,i,o;return n.__awaiter(this,void 0,void 0,(function*(){const n=yield e.getConfig();let s=[];r.debug("init",null===(t=n.options)||void 0===t?void 0:t.appDivs);const u=null===(o=null===(i=n.options)||void 0===i?void 0:i.appDivs)||void 0===o?void 0:o.trim();if(null==u?void 0:u.length){const t=u.split(",");e.on("willShowExperience",(()=>{r.debug("willShowExperience");for(const e of t){const t=document.getElementById(e);t&&(r.debug("obscuring",e),s.push({id:e,zIndex:t.style.zIndex}),t.style.zIndex="-1")}})),e.on("hideExperience",(()=>{r.debug("hideExperience");for(const e of s){const t=document.getElementById(e.id);t&&(r.debug("restoring",t.id),t.style.zIndex=e.zIndex)}s=[]}))}}))}},1822:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655),r=(0,i(7040).getLogger)("dataLayer");function o(){return window.dataLayer=window.dataLayer||[]}t.default=function(e){return n.__awaiter(this,void 0,void 0,(function*(){e.on("geoip",(e=>{r.info("pushGeoIP",e);const t={event:"ketchGeoip",ip:e.ip,countryCode:e.countryCode,regionCode:e.regionCode};o().push(t)})),e.on("jurisdiction",(e=>{r.info("pushJurisdiction",e);const t={event:"ketchJurisdiction",jurisdictionCode:e};o().push(t)}))}))}},3857:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655),r=n.__importDefault(i(8127)),o=n.__importDefault(i(1822)),s=i(7040),u=i(7808),c=(0,s.getLogger)("ketch");t.default=function(e){return n.__awaiter(this,void 0,void 0,(function*(){return c.info(`version ${u.version}`),Promise.all([(0,r.default)(e),(0,o.default)(e)]).then((()=>{}))}))}},655:(e,t,i)=>{"use strict";i.r(t),i.d(t,{__assign:()=>o,__asyncDelegator:()=>I,__asyncGenerator:()=>C,__asyncValues:()=>O,__await:()=>T,__awaiter:()=>_,__classPrivateFieldGet:()=>R,__classPrivateFieldIn:()=>x,__classPrivateFieldSet:()=>j,__createBinding:()=>v,__decorate:()=>u,__esDecorate:()=>a,__exportStar:()=>g,__extends:()=>r,__generator:()=>p,__importDefault:()=>L,__importStar:()=>S,__makeTemplateObject:()=>N,__metadata:()=>h,__param:()=>c,__propKey:()=>l,__read:()=>y,__rest:()=>s,__runInitializers:()=>d,__setFunctionName:()=>f,__spread:()=>b,__spreadArray:()=>w,__spreadArrays:()=>m,__values:()=>E});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},n(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var o=function(){return o=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o.apply(this,arguments)};function s(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}function u(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var u=e.length-1;u>=0;u--)(r=e[u])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s}function c(e,t){return function(i,n){t(i,n,e)}}function a(e,t,i,n,r,o){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var u,c=n.kind,a="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?n.static?e:e.prototype:null,l=t||(d?Object.getOwnPropertyDescriptor(d,n.name):{}),f=!1,h=i.length-1;h>=0;h--){var _={};for(var p in n)_[p]="access"===p?{}:n[p];for(var p in n.access)_.access[p]=n.access[p];_.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");o.push(s(e||null))};var v=(0,i[h])("accessor"===c?{get:l.get,set:l.set}:l[a],_);if("accessor"===c){if(void 0===v)continue;if(null===v||"object"!=typeof v)throw new TypeError("Object expected");(u=s(v.get))&&(l.get=u),(u=s(v.set))&&(l.set=u),(u=s(v.init))&&r.push(u)}else(u=s(v))&&("field"===c?r.push(u):l[a]=u)}d&&Object.defineProperty(d,n.name,l),f=!0}function d(e,t,i){for(var n=arguments.length>2,r=0;r<t.length;r++)i=n?t[r].call(e,i):t[r].call(e);return n?i:void 0}function l(e){return"symbol"==typeof e?e:"".concat(e)}function f(e,t,i){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:i?"".concat(i," ",t):t})}function h(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function _(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,u)}c((n=n.apply(e,t||[])).next())}))}function p(e,t){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(c){return function(u){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(s=0)),s;)try{if(i=1,n&&(r=2&u[0]?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==u[0]&&2!==u[0])){s=0;continue}if(3===u[0]&&(!r||u[1]>r[0]&&u[1]<r[3])){s.label=u[1];break}if(6===u[0]&&s.label<r[1]){s.label=r[1],r=u;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(u);break}r[2]&&s.ops.pop(),s.trys.pop();continue}u=t.call(e,s)}catch(e){u=[6,e],n=0}finally{i=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}var v=Object.create?function(e,t,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(t,i);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,r)}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]};function g(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||v(t,e,i)}function E(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function m(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<i;t++)for(var o=arguments[t],s=0,u=o.length;s<u;s++,r++)n[r]=o[s];return n}function w(e,t,i){if(i||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}function T(e){return this instanceof T?(this.v=e,this):new T(e)}function C(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=i.apply(e,t||[]),o=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){r[e]&&(n[e]=function(t){return new Promise((function(i,n){o.push([e,t,i,n])>1||u(e,t)}))})}function u(e,t){try{(i=r[e](t)).value instanceof T?Promise.resolve(i.value.v).then(c,a):d(o[0][2],i)}catch(e){d(o[0][3],e)}var i}function c(e){u("next",e)}function a(e){u("throw",e)}function d(e,t){e(t),o.shift(),o.length&&u(o[0][0],o[0][1])}}function I(e){var t,i;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,r){t[n]=e[n]?function(t){return(i=!i)?{value:T(e[n](t)),done:!1}:r?r(t):t}:r}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=E(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,r){!function(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)}(n,r,(t=e[i](t)).done,t.value)}))}}}function N(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&v(t,e,i);return P(t,e),t}function L(e){return e&&e.__esModule?e:{default:e}}function R(e,t,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(e):n?n.value:t.get(e)}function j(e,t,i,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?r.call(e,i):r?r.value=i:t.set(e,i),i}function x(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},7429:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return c.default}});var n=f(i(3990)),r=f(i(8237)),o=f(i(5355)),s=f(i(3764)),u=f(i(6314)),c=f(i(8464)),a=f(i(6435)),d=f(i(4008)),l=f(i(8222));function f(e){return e&&e.__esModule?e:{default:e}}},4163:(e,t)=>{"use strict";function i(e){return 14+(e+64>>>9<<4)+1}function n(e,t){const i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function r(e,t,i,r,o,s){return n((u=n(n(t,e),n(r,s)))<<(c=o)|u>>>32-c,i);var u,c}function o(e,t,i,n,o,s,u){return r(t&i|~t&n,e,t,o,s,u)}function s(e,t,i,n,o,s,u){return r(t&n|i&~n,e,t,o,s,u)}function u(e,t,i,n,o,s,u){return r(t^i^n,e,t,o,s,u)}function c(e,t,i,n,o,s,u){return r(i^(t|~n),e,t,o,s,u)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let i=0;i<t.length;++i)e[i]=t.charCodeAt(i)}return function(e){const t=[],i=32*e.length,n="0123456789abcdef";for(let r=0;r<i;r+=8){const i=e[r>>5]>>>r%32&255,o=parseInt(n.charAt(i>>>4&15)+n.charAt(15&i),16);t.push(o)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[i(t)-1]=t;let r=1732584193,a=-271733879,d=-1732584194,l=271733878;for(let t=0;t<e.length;t+=16){const i=r,f=a,h=d,_=l;r=o(r,a,d,l,e[t],7,-680876936),l=o(l,r,a,d,e[t+1],12,-389564586),d=o(d,l,r,a,e[t+2],17,606105819),a=o(a,d,l,r,e[t+3],22,-1044525330),r=o(r,a,d,l,e[t+4],7,-176418897),l=o(l,r,a,d,e[t+5],12,1200080426),d=o(d,l,r,a,e[t+6],17,-1473231341),a=o(a,d,l,r,e[t+7],22,-45705983),r=o(r,a,d,l,e[t+8],7,1770035416),l=o(l,r,a,d,e[t+9],12,-1958414417),d=o(d,l,r,a,e[t+10],17,-42063),a=o(a,d,l,r,e[t+11],22,-1990404162),r=o(r,a,d,l,e[t+12],7,1804603682),l=o(l,r,a,d,e[t+13],12,-40341101),d=o(d,l,r,a,e[t+14],17,-1502002290),a=o(a,d,l,r,e[t+15],22,1236535329),r=s(r,a,d,l,e[t+1],5,-165796510),l=s(l,r,a,d,e[t+6],9,-1069501632),d=s(d,l,r,a,e[t+11],14,643717713),a=s(a,d,l,r,e[t],20,-373897302),r=s(r,a,d,l,e[t+5],5,-701558691),l=s(l,r,a,d,e[t+10],9,38016083),d=s(d,l,r,a,e[t+15],14,-660478335),a=s(a,d,l,r,e[t+4],20,-405537848),r=s(r,a,d,l,e[t+9],5,568446438),l=s(l,r,a,d,e[t+14],9,-1019803690),d=s(d,l,r,a,e[t+3],14,-187363961),a=s(a,d,l,r,e[t+8],20,1163531501),r=s(r,a,d,l,e[t+13],5,-1444681467),l=s(l,r,a,d,e[t+2],9,-51403784),d=s(d,l,r,a,e[t+7],14,1735328473),a=s(a,d,l,r,e[t+12],20,-1926607734),r=u(r,a,d,l,e[t+5],4,-378558),l=u(l,r,a,d,e[t+8],11,-2022574463),d=u(d,l,r,a,e[t+11],16,1839030562),a=u(a,d,l,r,e[t+14],23,-35309556),r=u(r,a,d,l,e[t+1],4,-1530992060),l=u(l,r,a,d,e[t+4],11,1272893353),d=u(d,l,r,a,e[t+7],16,-155497632),a=u(a,d,l,r,e[t+10],23,-1094730640),r=u(r,a,d,l,e[t+13],4,681279174),l=u(l,r,a,d,e[t],11,-358537222),d=u(d,l,r,a,e[t+3],16,-722521979),a=u(a,d,l,r,e[t+6],23,76029189),r=u(r,a,d,l,e[t+9],4,-640364487),l=u(l,r,a,d,e[t+12],11,-421815835),d=u(d,l,r,a,e[t+15],16,530742520),a=u(a,d,l,r,e[t+2],23,-995338651),r=c(r,a,d,l,e[t],6,-198630844),l=c(l,r,a,d,e[t+7],10,1126891415),d=c(d,l,r,a,e[t+14],15,-1416354905),a=c(a,d,l,r,e[t+5],21,-57434055),r=c(r,a,d,l,e[t+12],6,1700485571),l=c(l,r,a,d,e[t+3],10,-1894986606),d=c(d,l,r,a,e[t+10],15,-1051523),a=c(a,d,l,r,e[t+1],21,-2054922799),r=c(r,a,d,l,e[t+8],6,1873313359),l=c(l,r,a,d,e[t+15],10,-30611744),d=c(d,l,r,a,e[t+6],15,-1560198380),a=c(a,d,l,r,e[t+13],21,1309151649),r=c(r,a,d,l,e[t+4],6,-145523070),l=c(l,r,a,d,e[t+11],10,-1120210379),d=c(d,l,r,a,e[t+2],15,718787259),a=c(a,d,l,r,e[t+9],21,-343485551),r=n(r,i),a=n(a,f),d=n(d,h),l=n(l,_)}return[r,a,d,l]}(function(e){if(0===e.length)return[];const t=8*e.length,n=new Uint32Array(i(t));for(let i=0;i<t;i+=8)n[i>>5]|=(255&e[i/8])<<i%32;return n}(e),8*e.length))}},4790:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};t.default=i},6314:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="00000000-0000-0000-0000-000000000000"},8222:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=(n=i(6435))&&n.__esModule?n:{default:n};t.default=function(e){if(!(0,r.default)(e))throw TypeError("Invalid UUID");let t;const i=new Uint8Array(16);return i[0]=(t=parseInt(e.slice(0,8),16))>>>24,i[1]=t>>>16&255,i[2]=t>>>8&255,i[3]=255&t,i[4]=(t=parseInt(e.slice(9,13),16))>>>8,i[5]=255&t,i[6]=(t=parseInt(e.slice(14,18),16))>>>8,i[7]=255&t,i[8]=(t=parseInt(e.slice(19,23),16))>>>8,i[9]=255&t,i[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,i[11]=t/4294967296&255,i[12]=t>>>24&255,i[13]=t>>>16&255,i[14]=t>>>8&255,i[15]=255&t,i}},58:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},3319:(e,t)=>{"use strict";let i;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!i&&(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(n)};const n=new Uint8Array(16)},3757:(e,t)=>{"use strict";function i(e,t,i,n){switch(e){case 0:return t&i^~t&n;case 1:case 3:return t^i^n;case 2:return t&i^t&n^i&n}}function n(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let i=0;i<t.length;++i)e.push(t.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const o=e.length/4+2,s=Math.ceil(o/16),u=new Array(s);for(let t=0;t<s;++t){const i=new Uint32Array(16);for(let n=0;n<16;++n)i[n]=e[64*t+4*n]<<24|e[64*t+4*n+1]<<16|e[64*t+4*n+2]<<8|e[64*t+4*n+3];u[t]=i}u[s-1][14]=8*(e.length-1)/Math.pow(2,32),u[s-1][14]=Math.floor(u[s-1][14]),u[s-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<s;++e){const o=new Uint32Array(80);for(let t=0;t<16;++t)o[t]=u[e][t];for(let e=16;e<80;++e)o[e]=n(o[e-3]^o[e-8]^o[e-14]^o[e-16],1);let s=r[0],c=r[1],a=r[2],d=r[3],l=r[4];for(let e=0;e<80;++e){const r=Math.floor(e/20),u=n(s,5)+i(r,c,a,d)+l+t[r]+o[e]>>>0;l=d,d=a,a=n(c,30)>>>0,c=s,s=u}r[0]=r[0]+s>>>0,r[1]=r[1]+c>>>0,r[2]=r[2]+a>>>0,r[3]=r[3]+d>>>0,r[4]=r[4]+l>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}},4008:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.unsafeStringify=s;var n,r=(n=i(6435))&&n.__esModule?n:{default:n};const o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));function s(e,t=0){return(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase()}t.default=function(e,t=0){const i=s(e,t);if(!(0,r.default)(i))throw TypeError("Stringified UUID is invalid");return i}},3990:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=(n=i(3319))&&n.__esModule?n:{default:n},o=i(4008);let s,u,c=0,a=0;t.default=function(e,t,i){let n=t&&i||0;const d=t||new Array(16);let l=(e=e||{}).node||s,f=void 0!==e.clockseq?e.clockseq:u;if(null==l||null==f){const t=e.random||(e.rng||r.default)();null==l&&(l=s=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==f&&(f=u=16383&(t[6]<<8|t[7]))}let h=void 0!==e.msecs?e.msecs:Date.now(),_=void 0!==e.nsecs?e.nsecs:a+1;const p=h-c+(_-a)/1e4;if(p<0&&void 0===e.clockseq&&(f=f+1&16383),(p<0||h>c)&&void 0===e.nsecs&&(_=0),_>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=h,a=_,u=f,h+=122192928e5;const v=(1e4*(268435455&h)+_)%4294967296;d[n++]=v>>>24&255,d[n++]=v>>>16&255,d[n++]=v>>>8&255,d[n++]=255&v;const g=h/4294967296*1e4&268435455;d[n++]=g>>>8&255,d[n++]=255&g,d[n++]=g>>>24&15|16,d[n++]=g>>>16&255,d[n++]=f>>>8|128,d[n++]=255&f;for(let e=0;e<6;++e)d[n+e]=l[e];return t||(0,o.unsafeStringify)(d)}},8237:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(i(7925)),r=o(i(4163));function o(e){return e&&e.__esModule?e:{default:e}}var s=(0,n.default)("v3",48,r.default);t.default=s},7925:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0,t.default=function(e,t,i){function n(e,n,s,u){var c;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let i=0;i<e.length;++i)t.push(e.charCodeAt(i));return t}(e)),"string"==typeof n&&(n=(0,o.default)(n)),16!==(null===(c=n)||void 0===c?void 0:c.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+e.length);if(a.set(n),a.set(e,n.length),a=i(a),a[6]=15&a[6]|t,a[8]=63&a[8]|128,s){u=u||0;for(let e=0;e<16;++e)s[u+e]=a[e];return s}return(0,r.unsafeStringify)(a)}try{n.name=e}catch(e){}return n.DNS=s,n.URL=u,n};var n,r=i(4008),o=(n=i(8222))&&n.__esModule?n:{default:n};const s="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=s;const u="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=u},5355:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(i(4790)),r=s(i(3319)),o=i(4008);function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,i){if(n.default.randomUUID&&!t&&!e)return n.default.randomUUID();const s=(e=e||{}).random||(e.rng||r.default)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){i=i||0;for(let e=0;e<16;++e)t[i+e]=s[e];return t}return(0,o.unsafeStringify)(s)}},3764:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(i(7925)),r=o(i(3757));function o(e){return e&&e.__esModule?e:{default:e}}var s=(0,n.default)("v5",80,r.default);t.default=s},6435:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=(n=i(58))&&n.__esModule?n:{default:n};t.default=function(e){return"string"==typeof e&&r.default.test(e)}},8464:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=(n=i(6435))&&n.__esModule?n:{default:n};t.default=function(e){if(!(0,r.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},4404:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Future=void 0;const n=i(655),r=i(7187),o=n.__importDefault(i(9746));class s{constructor(e={}){this._options=e,this._value=void 0,this._error=void 0,this._emitter=new r.EventEmitter,e.maxListeners&&this.setMaxListeners(e.maxListeners),e.executor&&this.fulfill(e.executor),this._options.timeout?this._timeout=window.setTimeout((()=>{void 0===this._value&&void 0===this._error&&(this.error=new Error("timed out"))}),this._options.timeout):this._timeout=void 0}static resolve(e){return(new s).fulfill(e)}fulfill(e){return function(e){return"function"==typeof e}(e)?new Promise(e).then((e=>this.value=e)).catch((e=>this.error=e)):this.value=e,this}isFulfilled(){return void 0!==this._value}get fulfilled(){return void 0!==this._value?Promise.resolve(this._value):new Promise(((e,t)=>{this.once(s.FULFILLED,e),this.once(s.ERROR,t)}))}get value(){if(void 0!==this._error)throw this._error;if(void 0===this._value)throw new Error("future has not been resolved");return this._value}set value(e){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=void 0),this._error=void 0,void 0!==this._value&&(0,o.default)(this._value,e)||(this._value=e,this._emitter.emit(s.FULFILLED,e),this._options.name&&this._options.emitter&&this._options.emitter.emit(this._options.name,e))}reset(){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=void 0);const e=this._value;this._value=void 0,this._error=void 0,this._emitter.emit(s.RESET,e),this._options.name&&this._options.emitter&&this._options.emitter.emit(this._options.name,void 0)}get error(){return this._error}set error(e){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=void 0),this._error=e,this._value=void 0,void 0!==e&&this._emitter.emit(s.ERROR,e)}addListener(e,t){return this._emitter.addListener(e,t),this.trigger(e,t),this}on(e,t){return this.addListener(e,t)}once(e,t){return this.trigger(e,t)||this._emitter.once(e,t),this}removeListener(e,t){return this._emitter.removeListener(e,t),this}off(e,t){return this.removeListener(e,t)}removeAllListeners(e){return this._emitter.removeAllListeners(e),this}setMaxListeners(e){return this._emitter.setMaxListeners(e),this}then(e,t){return this.fulfilled.then(e,t)}catch(e){return this.fulfilled.catch(e)}trigger(e,t){return e===s.FULFILLED&&this.isFulfilled()?(t(this._value),!0):e===s.ERROR&&void 0!==this._error&&(t(this._error),!0)}}s.FULFILLED="fulfilled",s.RESET="reset",s.ERROR="error",t.Future=s,t.default=s},6428:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655),r=i(1815),o=i(744);t.default=class{constructor(e=window,t=o.DEFAULT_TTL){this._window=e,this._ttl=t}getItem(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=(0,r.getCookie)(this._window,e);if(t)try{return JSON.parse(atob(t))}catch(e){return}}))}setItem(e,t){return n.__awaiter(this,void 0,void 0,(function*(){return!!(0,r.setCookie)(this._window,e,btoa(JSON.stringify(t)),this._ttl)&&this.getItem(e).then((e=>!!e))}))}removeItem(e){return n.__awaiter(this,void 0,void 0,(function*(){return(0,r.setCookie)(this._window,e,"",-86400),this.getItem(e).then((e=>!e))}))}}},4458:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetaCacher=t.WebStorageCacher=t.CookieCacher=t.getDefaultCacher=void 0;const n=i(655),r=n.__importDefault(i(6428));t.CookieCacher=r.default;const o=n.__importDefault(i(9912));t.WebStorageCacher=o.default;const s=n.__importDefault(i(1877));t.MetaCacher=s.default;const u=i(744);t.getDefaultCacher=function(e={}){var t,i;const n=null!==(t=e.window)&&void 0!==t?t:window,c=null!==(i=e.ttl)&&void 0!==i?i:u.DEFAULT_TTL;return new s.default(new r.default(n,c),new o.default(n.localStorage,c),new o.default(n.sessionStorage,c))}},1877:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655);t.default=class{constructor(...e){this._cachers=e}getItem(e){return n.__awaiter(this,void 0,void 0,(function*(){for(const t of this._cachers){const i=yield t.getItem(e);if(i)return i}}))}setItem(e,t){return n.__awaiter(this,void 0,void 0,(function*(){for(const i of this._cachers)if(yield i.setItem(e,t))return!0;return!1}))}removeItem(e){return n.__awaiter(this,void 0,void 0,(function*(){for(const t of this._cachers)if(yield t.removeItem(e))return!0;return!1}))}}},744:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_TTL=void 0,t.DEFAULT_TTL=604800},9912:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655),r=i(744);t.default=class{constructor(e=window.localStorage,t=r.DEFAULT_TTL){this._storage=e,this._ttl=t}getItem(e){return n.__awaiter(this,void 0,void 0,(function*(){try{const i=function(e,t){const i=e.getItem(`${t}_metadata`);if(i)return JSON.parse(atob(i))}(this._storage,e);if(!(i&&(t=i,t.iat<=Math.floor(Date.now()/1e3))))return;if(function(e){return e.exp<Math.floor(Date.now()/1e3)}(i))return void(yield this.removeItem(e));const n=this._storage.getItem(e);return n?JSON.parse(atob(n)):void 0}catch(e){return}var t}))}setItem(e,t){return n.__awaiter(this,void 0,void 0,(function*(){try{!function(e,t,i){e.setItem(`${t}_metadata`,btoa(JSON.stringify(i)))}(this._storage,e,function(e){const t=Math.floor(Date.now()/1e3);return{iat:t,exp:t+e}}(this._ttl));const i=btoa(JSON.stringify(t));return this._storage.setItem(e,i),i===this._storage.getItem(e)}catch(e){return!1}}))}removeItem(e){return n.__awaiter(this,void 0,void 0,(function*(){try{return function(e,t){e.removeItem(t)}(this._storage,e),this._storage.removeItem(e),!this._storage.getItem(e)}catch(e){return!1}}))}}},1815:(e,t)=>{"use strict";function i(e,t){return e.document.cookie.split("; ").reduce(((e,i)=>{const n=i.split("=");return n[0]===t?decodeURIComponent(n[1]):e}),"")}Object.defineProperty(t,"__esModule",{value:!0}),t.setCookie=t.getCookie=void 0,t.getCookie=i,t.setCookie=function(e,t,n,r){const o=e.document.location.hostname.split("."),s=[`${t}=${encodeURIComponent(n)}`,"path=/","SameSite=None","Secure"];if(r){const e=new Date(Date.now()+1e3*r).toUTCString();s.push(`expires=${e}`)}const u=s.join("; ");for(let r=2;r<=o.length;r++)if(e.document.cookie=`${u}; domain=${o.slice(-1*r).join(".")}`,i(e,t)===n)return!0;return e.document.cookie=u,!!i(e,t)}},3235:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655),r=i(1663),o=n.__importDefault(i(6156));t.default=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){if(!e||0===t.length)return[];const i=(0,r.getCookie)(e,t);return i&&"0"!==i?[i]:(0,o.default)(e,`ketch_${t}`)}))}},9398:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCookie=t.getCookie=t.fetcher=void 0;const n=i(655).__importDefault(i(3235));t.fetcher=n.default;const r=i(1663);Object.defineProperty(t,"getCookie",{enumerable:!0,get:function(){return r.getCookie}}),Object.defineProperty(t,"setCookie",{enumerable:!0,get:function(){return r.setCookie}})},1663:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCookie=t.getCookie=void 0;const n=i(1815);Object.defineProperty(t,"getCookie",{enumerable:!0,get:function(){return n.getCookie}}),t.setCookie=function(e,t,i,r){(0,n.setCookie)(e,t,i,r?86400*r:r)}},2294:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655);t.default=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){if(!e||!e.dataLayer||0===t.length)return[];let i=[];for(const n of e.dataLayer)if(Object.prototype.hasOwnProperty.call(n,t)){const e=n[t];e&&"0"!==e&&(i=i.concat(e))}return i}))}},6087:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetcher=void 0;const n=i(655).__importDefault(i(2294));t.fetcher=n.default},1736:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.semicolonStructure=t.queryStructure=t.jwtStructure=t.jsonStructure=t.stringStructure=t.managedFetcher=t.queryStringFetcher=t.sessionStorageFetcher=t.localStorageFetcher=t.windowFetcher=t.dataLayerFetcher=t.setCookie=t.getCookie=t.cookieFetcher=void 0;const n=i(655),r=i(9398);Object.defineProperty(t,"cookieFetcher",{enumerable:!0,get:function(){return r.fetcher}}),Object.defineProperty(t,"getCookie",{enumerable:!0,get:function(){return r.getCookie}}),Object.defineProperty(t,"setCookie",{enumerable:!0,get:function(){return r.setCookie}});const o=i(6087);Object.defineProperty(t,"dataLayerFetcher",{enumerable:!0,get:function(){return o.fetcher}});const s=i(9011);Object.defineProperty(t,"windowFetcher",{enumerable:!0,get:function(){return s.fetcher}});const u=i(624);Object.defineProperty(t,"localStorageFetcher",{enumerable:!0,get:function(){return u.fetcher}});const c=i(6279);Object.defineProperty(t,"sessionStorageFetcher",{enumerable:!0,get:function(){return c.fetcher}});const a=i(9312);Object.defineProperty(t,"queryStringFetcher",{enumerable:!0,get:function(){return a.fetcher}});const d=i(9480);Object.defineProperty(t,"managedFetcher",{enumerable:!0,get:function(){return d.fetcher}});const l=i(1198);Object.defineProperty(t,"stringStructure",{enumerable:!0,get:function(){return l.structure}});const f=i(7636);Object.defineProperty(t,"jsonStructure",{enumerable:!0,get:function(){return f.structure}});const h=i(1224);Object.defineProperty(t,"jwtStructure",{enumerable:!0,get:function(){return h.structure}});const _=i(9312);Object.defineProperty(t,"queryStructure",{enumerable:!0,get:function(){return _.structure}});const p=i(9444);Object.defineProperty(t,"semicolonStructure",{enumerable:!0,get:function(){return p.structure}});const v=n.__importDefault(i(8751));t.default=v.default},7636:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.structure=void 0;const n=i(655).__importDefault(i(4839));t.structure=n.default},4839:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=JSON.parse(e);return"object"!=typeof t||Array.isArray(t)||null===t?{value:t}:t}},1224:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.structure=void 0;const n=i(655).__importDefault(i(2052));t.structure=n.default},2052:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.split(".")[1],i=atob(t);return JSON.parse(i)}},7233:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(4118);t.default=(0,n.fetcher)("localStorage")},624:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetcher=void 0;const n=i(655).__importDefault(i(7233));t.fetcher=n.default},4642:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655),r=i(1815),o=i(7429);t.default=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){if(!e||0===t.length)return[];t="_swb";let i=(0,r.getCookie)(e,t);return i?[i]:((0,r.setCookie)(e,t,(0,o.v4)(),63072e3),i=(0,r.getCookie)(e,t),i?[i]:[])}))}},9480:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetcher=void 0;const n=i(655).__importDefault(i(4642));t.fetcher=n.default},6156:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655);t.default=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){return e&&e.location&&0!==e.location.search.length&&0!==t.length?new URLSearchParams(e.location.search).getAll(t).filter((e=>"0"!==e)):[]}))}},9312:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.structure=t.fetcher=void 0;const n=i(655),r=n.__importDefault(i(6156));t.fetcher=r.default;const o=n.__importDefault(i(57));t.structure=o.default},57:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t={};for(const[i,n]of new URLSearchParams(e).entries())t[i]=n;return t}},9444:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.structure=void 0;const n=i(655).__importDefault(i(859));t.structure=n.default},859:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.split(";").map((e=>e.trim().split("="))),i={};for(const[e,n]of t)i[decodeURIComponent(e)]=decodeURIComponent(n);return i}},5188:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(4118);t.default=(0,n.fetcher)("sessionStorage")},6279:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetcher=void 0;const n=i(655).__importDefault(i(5188));t.fetcher=n.default},1188:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655);t.default=function(e){return function(t,i){return n.__awaiter(this,void 0,void 0,(function*(){if(!t||0===i.length)return[];try{const n=("localStorage"===e?t.localStorage:t.sessionStorage).getItem(i);return n&&"0"!==n?[n]:[]}catch(e){return[]}}))}}},4118:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetcher=void 0;const n=i(655).__importDefault(i(1188));t.fetcher=n.default},1198:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.structure=void 0;const n=i(655).__importDefault(i(1961));t.structure=n.default},1961:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{value:e}}},8751:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655),r=i(7187),o=i(5752),s=i(9398),u=i(6087),c=i(9011),a=i(624),d=i(6279),l=i(9312),f=i(9480),h=i(1198),_=i(7636),p=i(1224),v=i(9312),g=i(9444),E=n.__importDefault(i(9746)),y=(0,i(7040).getLogger)("identity");t.default=class{constructor(e,t={}){this._emitter=new r.EventEmitter,this._w=e,this._listenerOptions=t,this._fetchers=new Map,this._identities={}}add(e,t){let i;if("function"==typeof t)return void this._fetchers.set(e,(()=>t()));switch(t.format){case o.IdentityFormat.IDENTITY_FORMAT_JSON:i=_.structure;break;case o.IdentityFormat.IDENTITY_FORMAT_JWT:i=p.structure;break;case o.IdentityFormat.IDENTITY_FORMAT_QUERY:i=v.structure;break;case o.IdentityFormat.IDENTITY_FORMAT_SEMICOLON:i=g.structure;break;default:i=h.structure}const n=t.key||"value";switch(t.type){case o.IdentityType.IDENTITY_TYPE_COOKIE:this._fetchers.set(e,(e=>(0,s.fetcher)(e,t.variable).then((e=>e.map(i).map((e=>e[n]))))));break;case o.IdentityType.IDENTITY_TYPE_DATA_LAYER:this._fetchers.set(e,(e=>(0,u.fetcher)(e,t.variable).then((e=>e.map(i).map((e=>e[n]))))));break;case o.IdentityType.IDENTITY_TYPE_WINDOW:this._fetchers.set(e,(e=>(0,c.fetcher)(e,t.variable).then((e=>e.map(i).map((e=>e[n]))))));break;case o.IdentityType.IDENTITY_TYPE_LOCAL_STORAGE:this._fetchers.set(e,(e=>(0,a.fetcher)(e,t.variable).then((e=>e.map(i).map((e=>e[n]))))));break;case o.IdentityType.IDENTITY_TYPE_SESSION_STORAGE:this._fetchers.set(e,(e=>(0,d.fetcher)(e,t.variable).then((e=>e.map(i).map((e=>e[n]))))));break;case o.IdentityType.IDENTITY_TYPE_QUERY_STRING:this._fetchers.set(e,(e=>(0,l.fetcher)(e,t.variable).then((e=>e.map(i).map((e=>e[n]))))));break;case o.IdentityType.IDENTITY_TYPE_MANAGED:this._fetchers.set(e,(e=>(0,f.fetcher)(e,t.variable).then((e=>e.map(i).map((e=>e[n]))))));break;default:throw new Error(`unsupported identity type ${t.type} for ${e}`)}}start(){return n.__awaiter(this,void 0,void 0,(function*(){if(!this._intervalId)return this._listenerOptions.interval&&(this._intervalId=this._w.setInterval(this.notify.bind(this),this._listenerOptions.interval),this._listenerOptions.timeout&&this._w.setTimeout(this.stop.bind(this),this._listenerOptions.timeout)),this.notify()}))}stop(){this._intervalId&&(this._w.clearInterval(this._intervalId),this._intervalId=void 0)}notify(){return n.__awaiter(this,void 0,void 0,(function*(){const e={};for(const[t,i]of this._fetchers.entries())try{const n=yield i(this._w);for(const i of n)e[t]=i}catch(e){y.warn(`failed to fetch identity for ${t}: ${e}`)}(0,E.default)(e,this._identities)||(this._emitter.emit("identity",e),this._identities=e)}))}addListener(e,t){return this.on(e,t)}on(e,t){return this._emitter.on(e,t),this}once(e,t){return this._emitter.once(e,t),this}removeListener(e,t){return this.off(e,t)}off(e,t){return this._emitter.off(e,t),this}removeAllListeners(e){return this._emitter.removeAllListeners(e),this}}},4072:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655);t.default=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){if(!e||0===t.length)return[];try{const i=function(e,t){const i=t.split(".");let n=e,r=null;for(;i.length>0;)if("window"===i[0])i.shift();else if("object"==typeof n)"()"===i[0].slice(-2)?(r=n,n=n[i[0].slice(0,-2)]):(r=n,n=n[i.shift()]);else{if("function"!=typeof n)return null;{const e=n.call(r);r=n,n=e,i.shift()}}return n&&"string"!=typeof n&&(n=n.toString(),n.startsWith("[object"))?"":n}(e,t);return i&&"0"!==i?[i]:[]}catch(e){return[]}}))}},9011:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetcher=void 0;const n=i(655).__importDefault(i(4072));t.fetcher=n.default},7040:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getLogLevel=t.getLogger=t.wrapLogger=t.getParams=t.DEFAULT_LOG_LEVEL=void 0;const r=n(i(8200));t.DEFAULT_LOG_LEVEL="warn";const o={trace:1,debug:2,info:3,warn:4,error:5,log:6},s=()=>{};function u(e=window.location.search,t=["ketch_","swb_"]){return new r.default(e,t)}function c(e,t){const i=`[${t}]`;return{trace:(...t)=>{e.trace(i,...t)},debug:(...t)=>{e.debug(i,...t)},info:(...t)=>{e.info(i,...t)},log:(...t)=>{e.log(i,...t)},warn:(...t)=>{e.warn(i,...t)},error:(...t)=>{e.error(i,...t)}}}function a(e=u()){const i=e.get("log");if(i&&i.length){const e=i.toLowerCase();if(e&&o[e])return e}else if(e.has("debug"))return"debug";return t.DEFAULT_LOG_LEVEL}t.getParams=u,t.wrapLogger=c,t.getLogger=function(e,t=a(u())){const n={log:i.g.console.log,error:i.g.console.error};t=t.toString().toLowerCase();for(const e of Object.keys(o))n[e]="log"===e||o[e]>=o[t]?"error"===e?n.error:n.log:s;return c(n,e)},t.getLogLevel=a},8200:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends URLSearchParams{constructor(e,t){super(e),this._prefixes=t}delete(e){for(const t of this._prefixes)super.delete(`${t}${e}`)}get(e){for(const t of this._prefixes){const i=super.get(`${t}${e}`);if(i)return i}return null}getAll(e){for(const t of this._prefixes)if(super.has(`${t}${e}`))return super.getAll(`${t}${e}`);return[]}has(e){for(const t of this._prefixes)if(super.has(`${t}${e}`))return!0;return!1}}t.default=i},7865:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655),r=n.__importDefault(i(9440)),o=n.__importDefault(i(5274)),s=i(1971),u=n.__importDefault(i(1911)),c=n.__importDefault(i(737)),a=i(5574),d=n.__importDefault(i(6100)),l=n.__importDefault(i(7218)),f=i(7040);t.default=class{constructor(e){this._config=e,this._api=new s.KetchWebAPI((0,l.default)(this._config))}build(){var e,t,i,s;return n.__awaiter(this,void 0,void 0,(function*(){const n=(0,f.wrapLogger)(r.default,"build");if(n.info(this._config),!this._config||!this._config.organization)throw o.default.invalidConfigurationError;const d=new URLSearchParams(window.location.search).get(u.default.LANGUAGE)||c.default.get(u.default.LANGUAGE)||document.documentElement.lang||document.documentElement.getAttribute("xml:lang")||window.navigator.language||this._config.language||"en";if((null===(e=this._config.property)||void 0===e?void 0:e.code)&&(null===(t=this._config.environment)||void 0===t?void 0:t.code)&&(null===(i=this._config.jurisdiction)||void 0===i?void 0:i.code)&&this._config.language===d){n.debug("full configuration");const e=new a.Ketch(this._api,this._config);return yield e.setEnvironment(this._config.environment),yield e.setJurisdiction(this._config.jurisdiction.code),e}const l=yield this.buildEnvironment(),h=yield this.buildGeoIP(),_=yield this.buildRegionInfo(h),p=yield this.buildJurisdiction(_);n.info("loadConfig",l,p,d);const v={organizationCode:this._config.organization.code,propertyCode:(null===(s=this._config.property)||void 0===s?void 0:s.code)||"",environmentCode:l.code,hash:l.hash||"",languageCode:d,jurisdictionCode:p},g=yield this._api.getFullConfiguration(v),E=new a.Ketch(this._api,g);return yield E.setEnvironment(l),yield E.setGeoIP(h),yield E.setRegionInfo(_),yield E.setJurisdiction(p),E}))}buildEnvironment(){return n.__awaiter(this,void 0,void 0,(function*(){const e=(0,f.wrapLogger)(r.default,"buildEnvironment");if(this._config.environment)return e.trace(this._config.environment),this._config.environment;if(!this._config.environments||0===this._config.environments.length)throw e.trace("no environments"),o.default.noEnvironmentError;const t=c.default.get(u.default.ENV);if(t){for(let i=0;i<this._config.environments.length;i++){const n=this._config.environments[i];if(n&&t&&n.code===t)return e.debug("found",n),n}throw e.trace("unknown environment"),o.default.noEnvironmentError}let i={};for(let e=0;e<this._config.environments.length;e++){const t=this._config.environments[e],n=atob(t.pattern||"");n&&new RegExp(n).test(window.document.location.href)&&(!i.pattern||n.length>atob(i.pattern).length)&&(i=t)}if(i.pattern)return e.debug("matched",i),i;for(let t=0;t<this._config.environments.length;t++){const i=this._config.environments[t];if(i.code===u.default.PRODUCTION)return e.debug(i.code,i),i}throw o.default.noEnvironmentError}))}buildJurisdiction(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=(0,f.wrapLogger)(r.default,"buildJurisdiction");t.debug(this._config.jurisdiction);const i=c.default.get(u.default.JURISDICTION);if(i)return t.trace("override",i),i;const n=this._config.jurisdiction;if(!n)throw t.trace("no jurisdiction config"),o.default.noJurisdictionError;if(n.code)return t.trace(n.code),n.code;const s=document.documentElement.getAttribute("jurisdiction");if(s)return t.trace("document jurisdiction",s),s;const a=n.variable;if(a)for(const e of(0,d.default)()){const i=e[a];if(i)return t.trace("dataLayer jurisdiction",i),i}if(n.jurisdictions){const i=n.jurisdictions[e];if(i)return t.trace("region jurisdiction",i),i}if(n.defaultJurisdictionCode)return t.trace("default jurisdiction",n.defaultJurisdictionCode),n.defaultJurisdictionCode;throw o.default.noJurisdictionError}))}buildRegionInfo(e){var t;return n.__awaiter(this,void 0,void 0,(function*(){const i=(0,f.wrapLogger)(r.default,"buildRegionInfo"),n=c.default.get(u.default.REGION);if(n)return i.trace("override",n),n;if(("US"===e.countryCode||"CA"===e.countryCode)&&e.regionCode){const t=`${e.countryCode}-${e.regionCode}`;return i.trace(t),t}const o=null!==(t=e.countryCode)&&void 0!==t?t:"US";return i.trace(o),o}))}buildGeoIP(){return n.__awaiter(this,void 0,void 0,(function*(){r.default.debug("buildGeoIP");const e=yield this._api.getLocation();if(!e||!e.location)throw o.default.unrecognizedLocationError;return e.location}))}}},665:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655).__importDefault(i(8805));class r extends n.default{constructor(e){super(e)}experienceClosed(e){return this._ketch.experienceClosed(e).then((()=>{}))}invokeRight(e){return this._ketch.invokeRight(e)}setProvisionalConsent(e){return this._ketch.setProvisionalConsent(e)}getSubscriptions(){return this._ketch.getSubscriptions()}setSubscriptions(e){return this._ketch.setSubscriptions(e)}getSubscriptionConfiguration(){return this._ketch.getSubscriptionConfiguration()}}t.default=r},5574:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ketch=void 0;const n=i(655),r=i(7187),o=n.__importDefault(i(4404)),s=i(5752),u=n.__importDefault(i(5887)),c=n.__importDefault(i(9440)),a=n.__importDefault(i(5274)),d=n.__importDefault(i(737)),l=n.__importDefault(i(1736)),f=i(2315),h=n.__importDefault(i(9746)),_=n.__importDefault(i(1911)),p=i(7040),v=n.__importDefault(i(665));class g extends r.EventEmitter{constructor(e,t){var i,n,r,s,u,c;super();const a=parseInt(null!==(n=null===(i=t.options)||void 0===i?void 0:i.maxListeners)&&void 0!==n?n:"20");this._api=e,this._config=t,this._consent=new o.default({name:_.default.CONSENT_EVENT,emitter:this,maxListeners:a}),this._environment=new o.default({name:_.default.ENVIRONMENT_EVENT,emitter:this,maxListeners:a}),this._geoip=new o.default({name:_.default.GEOIP_EVENT,emitter:this,maxListeners:a}),this._identities=new o.default({name:_.default.IDENTITIES_EVENT,emitter:this,maxListeners:a}),this._jurisdiction=new o.default({name:_.default.JURISDICTION_EVENT,emitter:this,maxListeners:a}),this._regionInfo=new o.default({name:_.default.REGION_INFO_EVENT,emitter:this,maxListeners:a}),this._subscriptionConfig=new o.default({name:_.default.SUBSCRIPTIONS_EVENT,emitter:this,maxListeners:a}),this._subscriptions=new o.default({name:_.default.SUBSCRIPTION_CONFIG_EVENT,emitter:this,maxListeners:a}),this._isExperienceDisplayed=!1,this._hasExperienceBeenDisplayed=!1,this._provisionalConsent=void 0,this._watcher=new l.default(window,{interval:parseInt(null!==(s=null===(r=t.options)||void 0===r?void 0:r.watcherInterval)&&void 0!==s?s:"2000"),timeout:parseInt(null!==(c=null===(u=t.options)||void 0===u?void 0:u.watcherTimeout)&&void 0!==c?c:"10000")}),this._watcher.on(_.default.IDENTITY_EVENT,this.setIdentities.bind(this)),this.setMaxListeners(a)}registerPlugin(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const i=new v.default(this);return t||(t=yield this.getConfig()),e instanceof Function?e(i,t):(void 0!==e.willShowExperience&&this.on(_.default.WILL_SHOW_EXPERIENCE_EVENT,(t=>{void 0!==e.willShowExperience&&e.willShowExperience(i,this._config,t)})),void 0!==e.showConsentExperience&&this.on(_.default.SHOW_CONSENT_EXPERIENCE_EVENT,((t,n)=>{void 0!==e.showConsentExperience&&e.showConsentExperience(i,this._config,t,n)})),void 0!==e.showPreferenceExperience&&this.on(_.default.SHOW_PREFERENCE_EXPERIENCE_EVENT,((t,n)=>{void 0!==e.showPreferenceExperience&&e.showPreferenceExperience(i,this._config,t,n)})),void 0!==e.consentChanged&&this.on(_.default.CONSENT_EVENT,(t=>{void 0!==e.consentChanged&&e.consentChanged(i,this._config,t)})),void 0!==e.environmentLoaded&&this.on(_.default.ENVIRONMENT_EVENT,(t=>{void 0!==e.environmentLoaded&&e.environmentLoaded(i,this._config,t)})),void 0!==e.experienceHidden&&this.on(_.default.HIDE_EXPERIENCE_EVENT,(t=>{void 0!==e.experienceHidden&&e.experienceHidden(i,this._config,t)})),void 0!==e.geoIPLoaded&&this.on(_.default.GEOIP_EVENT,(t=>{void 0!==e.geoIPLoaded&&e.geoIPLoaded(i,this._config,t)})),void 0!==e.identitiesLoaded&&this.on(_.default.IDENTITIES_EVENT,(t=>{void 0!==e.identitiesLoaded&&e.identitiesLoaded(i,this._config,t)})),void 0!==e.jurisdictionLoaded&&this.on(_.default.JURISDICTION_EVENT,(t=>{void 0!==e.jurisdictionLoaded&&e.jurisdictionLoaded(i,this._config,t)})),void 0!==e.regionInfoLoaded&&this.on(_.default.REGION_INFO_EVENT,(t=>{void 0!==e.regionInfoLoaded&&e.regionInfoLoaded(i,this._config,t)})),void 0!==e.rightInvoked&&this.on(_.default.RIGHT_INVOKED_EVENT,(t=>{void 0!==e.rightInvoked&&e.rightInvoked(i,this._config,t)})),void 0!==e.init?e.init(i,t):void 0)}))}registerIdentityProvider(e,t){return n.__awaiter(this,void 0,void 0,(function*(){this._watcher.add(e,t)}))}registerStorageProvider(e,t){return n.__awaiter(this,void 0,void 0,(function*(){}))}registerExperienceServer(e){return n.__awaiter(this,void 0,void 0,(function*(){}))}getConfig(){return n.__awaiter(this,void 0,void 0,(function*(){return this._config}))}selectExperience(e){const t=(0,p.wrapLogger)(c.default,"selectExperience");if(this._hasExperienceBeenDisplayed)t.debug(_.default.NONE);else{if(d.default.get(_.default.SHOW)===_.default.PREFERENCES)return t.debug(s.ExperienceType.Preference),s.ExperienceType.Preference;if(d.default.has(_.default.SHOW))return t.debug(s.ExperienceType.Consent),s.ExperienceType.Consent;if(this._config.purposes)for(const i of this._config.purposes)if(void 0===e.purposes[i.code])return t.debug(s.ExperienceType.Consent),s.ExperienceType.Consent;t.debug(_.default.NONE)}}selectConsentExperience(){var e,t;const i=(0,p.wrapLogger)(c.default,"selectConsentExperience");if(this._config.purposes&&this._config.purposes.length&&(null===(t=null===(e=this._config.experiences)||void 0===e?void 0:e.consent)||void 0===t?void 0:t.experienceDefault)===s.ExperienceDefault.MODAL)for(const e of this._config.purposes)if(e.requiresOptIn)return i.debug(s.ConsentExperienceType.Modal),s.ConsentExperienceType.Modal;return i.debug(s.ConsentExperienceType.Banner),s.ConsentExperienceType.Banner}willShowExperience(e){c.default.debug("willShowExperience",e),this.emit(_.default.WILL_SHOW_EXPERIENCE_EVENT,e),this._isExperienceDisplayed=!0}experienceClosed(e){return n.__awaiter(this,void 0,void 0,(function*(){if(c.default.debug("experienceClosed",e),this._isExperienceDisplayed=!1,this._hasExperienceBeenDisplayed=!0,e!==s.ExperienceClosedReason.SET_CONSENT){const e=yield this.retrieveConsent();if(this._config.purposes)for(const t of this._config.purposes)void 0===e.purposes[t.code]&&t.requiresOptIn&&(e.purposes[t.code]=!1);yield this.setConsent(e)}return setTimeout((()=>{this.emit(_.default.HIDE_EXPERIENCE_EVENT,e)}),0),this.retrieveConsent()}))}showExperience(e){return n.__awaiter(this,void 0,void 0,(function*(){}))}showConsentExperience(){return n.__awaiter(this,void 0,void 0,(function*(){c.default.debug("showConsentExperience");const e=yield this.retrieveConsent();return this.listenerCount(_.default.SHOW_CONSENT_EXPERIENCE_EVENT)>0&&(this.willShowExperience(s.ExperienceType.Consent),this.emit(_.default.SHOW_CONSENT_EXPERIENCE_EVENT,e,{displayHint:this.selectConsentExperience()})),e}))}showPreferenceExperience(e){var t,i,r;return n.__awaiter(this,void 0,void 0,(function*(){const n=(0,p.wrapLogger)(c.default,"showPreferenceExperience");n.debug(e);const o=yield this.getConsent();if(!(null===(t=this._config.experiences)||void 0===t?void 0:t.preference))return n.info("no preference experience"),o;if(this.listenerCount(_.default.SHOW_PREFERENCE_EXPERIENCE_EVENT)>0){e=null!=e?e:{};const t=d.default.get(_.default.PREFERENCES_TAB);t&&(0,s.isTab)(t)&&(e.tab=t,n.info("tab",t));const u=null===(r=null===(i=d.default.get(_.default.PREFERENCES_TABS))||void 0===i?void 0:i.split(","))||void 0===r?void 0:r.filter((e=>e&&(0,s.isTab)(e)));(null==u?void 0:u.length)&&(e.showOverviewTab=u.includes(s.Tab.Overview),e.showConsentsTab=u.includes(s.Tab.Consents),e.showSubscriptionsTab=u.includes(s.Tab.Subscriptions),e.showRightsTab=u.includes(s.Tab.Rights),e.tab=u.includes(e.tab||"")?e.tab:u[0]);const c=yield this.getSubscriptionConfiguration();if(void 0!==c){if(void 0===e.showSubscriptionsTab&&(e.showSubscriptionsTab=!0),void 0!==c.topics&&void 0!==c.controls&&0!==c.topics.length&&0!==c.controls.length&&0!==Object.keys(c.identities).length||(e.showSubscriptionsTab=!1,n.trace("not showing subscriptions because invalid subscription config")),e.showSubscriptionsTab){let t=!1;const i=yield this.getIdentities();for(const e of Object.keys(c.identities))if(i[e]){t=!0;break}t||(n.trace("not showing subscriptions because no auth identities"),e.showSubscriptionsTab=!1)}}else n.trace("invalid subscription config"),e.showSubscriptionsTab=!1;e.showSubscriptionsTab||e.tab!==s.Tab.Subscriptions||(e.tab=void 0),this.willShowExperience(s.ExperienceType.Preference),this.emit(_.default.SHOW_PREFERENCE_EXPERIENCE_EVENT,o,e)}return o}))}onShowConsentExperience(e){return n.__awaiter(this,void 0,void 0,(function*(){c.default.debug("onShowConsentExperience"),this.removeAllListeners(_.default.SHOW_CONSENT_EXPERIENCE_EVENT),this.on(_.default.SHOW_CONSENT_EXPERIENCE_EVENT,e)}))}onShowPreferenceExperience(e){return n.__awaiter(this,void 0,void 0,(function*(){c.default.debug("onShowPreferenceExperience"),this.removeAllListeners(_.default.SHOW_PREFERENCE_EXPERIENCE_EVENT),this.on(_.default.SHOW_PREFERENCE_EXPERIENCE_EVENT,e)}))}hasConsent(){return this._consent.isFulfilled()}changeConsent(e){return n.__awaiter(this,void 0,void 0,(function*(){return c.default.debug("changeConsent",e),this._watcher.stop(),yield this._watcher.start(),this.setConsent(e)}))}setConsent(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=(0,p.wrapLogger)(c.default,"setConsent");if(t.debug(e),!e||(0,u.default)(e))return t.trace("reset"),this._consent.reset(),{};if(this.hasConsent()){t.trace("has consent");const i=this._consent.value;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&!Object.prototype.hasOwnProperty.call(e,t)&&(e.purposes[t]=i.purposes[t])}this._consent.value=e;const i=yield this.getIdentities();return yield this.updateConsent(i,e),e}))}setProvisionalConsent(e){return n.__awaiter(this,void 0,void 0,(function*(){c.default.debug("setProvisionalConsent",e),this._provisionalConsent=e}))}overrideWithProvisionalConsent(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=(0,p.wrapLogger)(c.default,"overrideWithProvisionalConsent");t.debug(e);let i=!1;if(!this._provisionalConsent)return t.trace("no provisional consent"),[e,i];for(const t in this._provisionalConsent.purposes)e.purposes[t]!==this._provisionalConsent.purposes[t]&&(e.purposes[t]=this._provisionalConsent.purposes[t],i=!0);return this._provisionalConsent=void 0,t.trace("merged",e),[e,i]}))}getConsent(){return n.__awaiter(this,void 0,void 0,(function*(){const e=(0,p.wrapLogger)(c.default,"getConsent");if(this.hasConsent())return e.trace("has consent"),this._consent.fulfilled;e.debug("obtaining consent");const t=yield this.getIdentities(),i=yield this.fetchConsent(t),[n,r]=yield this.overrideWithProvisionalConsent(i);let o=r;const u=this.selectExperience(n);if(this._config.purposes)for(const e of this._config.purposes)void 0!==n.purposes[e.code]||e.requiresOptIn||(n.purposes[e.code]=!0,o=!0);switch(e.debug("shouldCreatePermits",o),o?yield this.setConsent(n):this._consent.value=n,u){case s.ExperienceType.Consent:return this.showConsentExperience();case s.ExperienceType.Preference:return this.showPreferenceExperience()}return this.emit(_.default.HIDE_EXPERIENCE_EVENT,s.ExperienceClosedReason.WILL_NOT_SHOW),this._consent.value}))}retrieveConsent(){return n.__awaiter(this,void 0,void 0,(function*(){return c.default.debug("retrieveConsent"),this._consent.isFulfilled()?this._consent.fulfilled:{purposes:{},vendors:[]}}))}fetchConsent(e){var t,i,r;return n.__awaiter(this,void 0,void 0,(function*(){const n=(0,p.wrapLogger)(c.default,"fetchConsent");if(n.debug(e),!e||0===Object.keys(e).length)throw a.default.noIdentitiesError;if(!(this._config&&this._config.property&&this._config.organization&&this._config.environment&&this._config.purposes&&this._config.jurisdiction&&0!==this._config.purposes.length))throw a.default.noPurposesError;const o={organizationCode:null!==(t=this._config.organization.code)&&void 0!==t?t:"",propertyCode:null!==(i=this._config.property.code)&&void 0!==i?i:"",environmentCode:this._config.environment.code,jurisdictionCode:null!==(r=this._config.jurisdiction.code)&&void 0!==r?r:"",identities:e,purposes:{}};for(const e of this._config.purposes)o.purposes[e.code]={legalBasisCode:e.legalBasisCode};let s=yield(0,f.getCachedConsent)(o);const u=Math.floor(Date.now()/1e3-f.CACHED_CONSENT_TTL);let d=!1;0===Object.keys(s.purposes).length?n.debug("cached consent is empty"):(null==s?void 0:s.collectedAt)&&s.collectedAt<u?n.debug("revalidating cached consent"):(0,h.default)(e,s.identities)?(n.debug("using cached consent"),d=!0):n.debug("cached consent discarded due to identity mismatch"),d||(s=(e=>{var t;if(n.trace("normalizeConsent",e),!e.purposes)return e.purposes={},e;for(const i of Object.keys(e.purposes)){const n=e.purposes[i];"string"==typeof n&&(e.purposes[i]={allowed:n,legalBasisCode:null===(t=o.purposes[i])||void 0===t?void 0:t.legalBasisCode})}return n.trace("normalized",e),e})(yield this._api.getConsent(o)),yield(0,f.setCachedConsent)(s),yield(0,f.setPublicConsent)(s,this._config));const l={purposes:{}};if(this._config.purposes&&s.purposes)for(const e of this._config.purposes)if(s.purposes[e.code]){const t=s.purposes[e.code];"string"==typeof t?l.purposes[e.code]="true"===t:t.allowed&&(l.purposes[e.code]="true"===t.allowed)}return s.vendors&&(l.vendors=s.vendors),l}))}updateConsent(e,t){var i,r,o;return n.__awaiter(this,void 0,void 0,(function*(){const n=(0,p.wrapLogger)(c.default,"updateConsent");if(n.debug(e,t),!e||0===Object.keys(e).length)return void n.debug("no identities");if(!(this._config&&this._config.organization&&this._config.property&&this._config.environment&&this._config.jurisdiction&&this._config.purposes&&0!==this._config.purposes.length))return void n.debug("invalid configuration");if((0,u.default)(t)||(0,u.default)(t.purposes))return void n.debug("empty consent");const s={organizationCode:null!==(i=this._config.organization.code)&&void 0!==i?i:"",propertyCode:null!==(r=this._config.property.code)&&void 0!==r?r:"",environmentCode:this._config.environment.code,identities:e,jurisdictionCode:null!==(o=this._config.jurisdiction.code)&&void 0!==o?o:"",purposes:{},vendors:t.vendors,collectedAt:Math.floor(Date.now()/1e3)};if(this._config.purposes&&t)for(const e of this._config.purposes)void 0!==t.purposes[e.code]&&(s.purposes[e.code]={allowed:t.purposes[e.code].toString(),legalBasisCode:e.legalBasisCode});if(!(0,u.default)(s.purposes))return yield(0,f.setCachedConsent)(s),yield(0,f.setPublicConsent)(s,this._config),this._api.setConsent(s);n.debug("calculated consents empty")}))}getSubscriptions(){var e,t,i,r,o,s,u,a;return n.__awaiter(this,void 0,void 0,(function*(){const n=(0,p.wrapLogger)(c.default,"getSubscriptions");if(void 0===this._config.organization||void 0===this._config.property||void 0===this._config.environment)return n.trace("exiting because invalid config",this._config),this._subscriptions.value={},{};if(this._subscriptions.isFulfilled())return n.trace("cached",this._subscriptions.value),this._subscriptions;const d=yield this.getSubscriptionConfiguration();if(0===d.topics.length||void 0===d.identities||0===Object.keys(d.identities).length)return n.trace("exiting because invalid subscription config",d,d.topics.length,d.identities,Object.keys(d.identities)),this._subscriptions.value={},{};const l={organizationCode:null!==(i=null===(t=null===(e=this._config)||void 0===e?void 0:e.organization)||void 0===t?void 0:t.code)&&void 0!==i?i:"",controllerCode:"",propertyCode:null!==(s=null===(o=null===(r=this._config)||void 0===r?void 0:r.property)||void 0===o?void 0:o.code)&&void 0!==s?s:"",environmentCode:null===(a=null===(u=this._config)||void 0===u?void 0:u.environment)||void 0===a?void 0:a.code,collectedAt:Math.floor(Date.now()/1e3),identities:{}},f=yield this.getIdentities();for(const e of Object.keys(d.identities))f[e]&&(l.identities[e]=f[e]);if(0===Object.keys(l.identities).length)return n.trace("exiting because no identities"),this._subscriptions.value={},{};const h=yield this._api.getSubscriptions(l);return this._subscriptions.value=h,n.trace("loaded",h),h}))}setSubscriptions(e){var t,i,r,o,s,u,a,d;return n.__awaiter(this,void 0,void 0,(function*(){const n=(0,p.wrapLogger)(c.default,"setSubscriptions");if(n.trace("subscriptions",e,this._config),void 0===this._config.organization||void 0===this._config.property||void 0===this._config.environment)return void n.trace("exiting because of invalid config");const l=yield this.getSubscriptionConfiguration();if(0===l.topics.length||void 0===l.identities||0===Object.keys(l.identities).length)return void n.trace("exiting because of invalid subscription config",l,0===l.topics.length,l.identities,Object.keys(l.identities));const f={organizationCode:null!==(r=null===(i=null===(t=this._config)||void 0===t?void 0:t.organization)||void 0===i?void 0:i.code)&&void 0!==r?r:"",controllerCode:"",propertyCode:null!==(u=null===(s=null===(o=this._config)||void 0===o?void 0:o.property)||void 0===s?void 0:s.code)&&void 0!==u?u:"",environmentCode:null===(d=null===(a=this._config)||void 0===a?void 0:a.environment)||void 0===d?void 0:d.code,topics:e.topics,controls:e.controls,collectedAt:Math.floor(Date.now()/1e3),identities:{}},h=yield this.getIdentities();for(const e of Object.keys(l.identities))h[e]&&(f.identities[e]=h[e]);return 0===Object.keys(f.identities).length?(n.trace("exiting because no identities"),void(this._subscriptions.value={})):(this._subscriptions.value=e,this._api.setSubscriptions(f))}))}getSubscriptionConfiguration(){var e,t,i,r,o,s,u,a;return n.__awaiter(this,void 0,void 0,(function*(){const n=(0,p.wrapLogger)(c.default,"getSubscriptionConfiguration");if(n.trace("config",this._config),this._subscriptionConfig.isFulfilled())return n.trace("cached",this._subscriptionConfig.value),this._subscriptionConfig;const d=yield this._api.getSubscriptionsConfiguration({organizationCode:null!==(i=null===(t=null===(e=this._config)||void 0===e?void 0:e.organization)||void 0===t?void 0:t.code)&&void 0!==i?i:"",propertyCode:null!==(s=null===(o=null===(r=this._config)||void 0===r?void 0:r.property)||void 0===o?void 0:o.code)&&void 0!==s?s:"",languageCode:null!==(a=null===(u=this._config)||void 0===u?void 0:u.language)&&void 0!==a?a:""});return n.trace("loaded",d),this._subscriptionConfig.value=d,d}))}setEnvironment(e){return n.__awaiter(this,void 0,void 0,(function*(){return c.default.debug("setEnvironment",e),this._environment.value=e,this._environment.fulfilled}))}getEnvironment(){return n.__awaiter(this,void 0,void 0,(function*(){return c.default.debug("getEnvironment"),this._environment.fulfilled}))}setGeoIP(e){return n.__awaiter(this,void 0,void 0,(function*(){return c.default.debug("setGeoIP",e),this._geoip.value=e,this._geoip.fulfilled}))}getGeoIP(){return n.__awaiter(this,void 0,void 0,(function*(){return c.default.debug("getGeoIP"),this._geoip.fulfilled}))}setIdentities(e){return n.__awaiter(this,void 0,void 0,(function*(){const t=(0,p.wrapLogger)(c.default,"setIdentities");t.debug(e);let i={};this._identities.isFulfilled()&&(i=this._identities.value);for(const t in e)i[t]=e[t];if(this._identities.value=i,this._isExperienceDisplayed)return t.trace("experience displayed"),i;const n=yield this.retrieveConsent();if(0==Object.keys(n.purposes).length)return i;const r=yield this.fetchConsent(i);if((0,h.default)(r.purposes,n.purposes)){let e=!1;for(const t in r)if(r.purposes[t]!==n.purposes[t]){e=!0;break}if(!e)return i}return this._hasExperienceBeenDisplayed?(t.trace("updating consent because experience displayed"),yield this.updateConsent(i,n),i):(yield this.showConsentExperience(),i)}))}collectIdentities(){var e,t,i;return n.__awaiter(this,void 0,void 0,(function*(){const n=(0,p.wrapLogger)(c.default,"collectIdentities");n.debug(this._config.identities);const r=this._config.identities;if(!this._config||!this._config.organization||void 0===r||(0,u.default)(r))return n.trace("invalid configuration"),void(this._identities.value={});const o=this._watcher;let a=(e,t)=>{o.add(e,t)};if(null===(e=this._config.property)||void 0===e?void 0:e.proxy)try{const e=new URL(null===(t=this._config.property)||void 0===t?void 0:t.proxy),i=new URL(window.location.href);e.origin!==i.origin&&(a=(e,t)=>{r[e].type!==s.IdentityType.IDENTITY_TYPE_LOCAL_STORAGE&&o.add(e,t)})}catch(e){n.error(`error checking proxy '${null===(i=this._config.property)||void 0===i?void 0:i.proxy}'`,e)}for(const e of Object.keys(r))a(e,r[e]);n.info("starting watcher"),yield this._watcher.start()}))}getIdentities(){return n.__awaiter(this,void 0,void 0,(function*(){return c.default.debug("getIdentities"),this._identities.isFulfilled()||(yield this.collectIdentities()),this._identities.fulfilled}))}setJurisdiction(e){return n.__awaiter(this,void 0,void 0,(function*(){return c.default.debug("setJurisdiction",e),this._jurisdiction.value=e,this._jurisdiction.fulfilled}))}getJurisdiction(){return n.__awaiter(this,void 0,void 0,(function*(){return c.default.debug("getJurisdiction"),this._jurisdiction.fulfilled}))}setRegionInfo(e){return n.__awaiter(this,void 0,void 0,(function*(){return c.default.debug("setRegionInfo",e),this._regionInfo.value=e,this._regionInfo.fulfilled}))}getRegionInfo(){return n.__awaiter(this,void 0,void 0,(function*(){return c.default.debug("getRegionInfo"),this._regionInfo.fulfilled}))}invokeRight(e){var t,i,r;return n.__awaiter(this,void 0,void 0,(function*(){const n=(0,p.wrapLogger)(c.default,"invokeRight");if(n.debug(e),!e.subject||!e.subject.email||""===e.subject.email||!e.right||""===e.right)return void n.warn("invalid right invocation request");let o={};if(this._identities.isFulfilled()&&(o=this._identities.value),o.email=e.subject.email,!(this._config&&this._config.organization&&this._config.property&&this._config.environment&&this._config.jurisdiction&&this._config.rights&&0!==this._config.rights.length))return void n.warn("invalid configuration");const s=e.subject,u={organizationCode:null!==(t=this._config.organization.code)&&void 0!==t?t:"",propertyCode:null!==(i=this._config.property.code)&&void 0!==i?i:"",environmentCode:this._config.environment.code,controllerCode:"",identities:o,jurisdictionCode:null!==(r=this._config.jurisdiction.code)&&void 0!==r?r:"",rightCode:e.right,user:s,recaptchaToken:e.recaptchaToken};return this.emit(_.default.RIGHT_INVOKED_EVENT,u),this._api.invokeRight(u)}))}emit(e,...t){var i,n,r;const o=(0,p.wrapLogger)(c.default,"emit");if(o.trace(e,t),window.androidListener||(null===(i=window.webkit)||void 0===i?void 0:i.messageHandlers)){const i=e.toString(),s=[];for(const e of t)e!==this&&s.push(e);let u;1===s.length&&"string"==typeof s[0]?u=s[0]:1===s.length?u=JSON.stringify(s[0]):s.length>1&&(u=JSON.stringify(s)),window.androidListener&&i in window.androidListener?(o.trace("androidListener",window.androidListener,u),0===s.length?window.androidListener[i]():window.androidListener[i](u)):(null===(n=window.webkit)||void 0===n?void 0:n.messageHandlers)&&i in window.webkit.messageHandlers?(o.trace("webkitMessageHandlers",null===(r=window.webkit)||void 0===r?void 0:r.messageHandlers,u),window.webkit.messageHandlers[i].postMessage(u)):o.warn(`Can't pass message to native code because "${i}" handler is not registered`)}if(this._config&&this._config.options&&this._config.options.externalListener&&window[this._config.options.externalListener]){const i=window[this._config.options.externalListener],n=e.toString(),r=[];for(const e of t)e!==this&&r.push(e);let o;1===r.length&&"string"==typeof r[0]||1===r.length?o=r[0]:r.length>1&&(o=r);let s={event:n,data:o};s=JSON.stringify(s),"function"==typeof i?i(s):"postMessage"in i&&"function"==typeof i.postMessage?i.postMessage(s):"object"==typeof i&&n in i&&("function"===i[n]?i[n](o):"postMessage"in i[n]&&i[n].postMessage(o))}return super.emit(e,...t)}addListener(e,t){return this.on(e,t)}on(e,t){c.default.trace("on",e,t);const i=this.mapEvent(e);return void 0!==i?(i.on(_.default.FULFILLED_EVENT,t),this):(this.isSingletonEvent(e)&&super.removeAllListeners(e),super.on(e,t))}once(e,t){c.default.trace("once",e,t);const i=this.mapEvent(e);return void 0!==i?(i.once(_.default.FULFILLED_EVENT,t),this):(this.isSingletonEvent(e)&&super.removeAllListeners(e),super.once(e,t))}removeListener(e,t){c.default.trace("off",e,t);const i=this.mapEvent(e);return void 0!==i?(i.removeListener(_.default.FULFILLED_EVENT,t),this):super.removeListener(e,t)}off(e,t){return this.removeListener(e,t)}isSingletonEvent(e){return e===_.default.SHOW_CONSENT_EXPERIENCE_EVENT||e===_.default.SHOW_PREFERENCE_EXPERIENCE_EVENT}mapEvent(e){switch(e){case _.default.CONSENT_EVENT:return this._consent;case _.default.ENVIRONMENT_EVENT:return this._environment;case _.default.GEOIP_EVENT:return this._geoip;case _.default.IDENTITIES_EVENT:return this._identities;case _.default.JURISDICTION_EVENT:return this._jurisdiction;case _.default.REGION_INFO_EVENT:return this._regionInfo;case _.default.SUBSCRIPTIONS_EVENT:return this._subscriptions;case _.default.SUBSCRIPTION_CONFIG_EVENT:return this._subscriptionConfig}}}t.Ketch=g},8805:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655),r=n.__importDefault(i(9440)),o=n.__importDefault(i(5274)),s=n.__importDefault(i(4128)),u=n.__importDefault(i(1911)),c=i(7040);t.default=class{constructor(e){this._ketch=e}push(e){if(void 0===e)return;let t;"string"==typeof e?(t=e,e=[]):(e=Array.from(e),t=e.shift()),r.default.trace(t),this.route(t,...e).then((()=>{r.default.trace(`${t} completed`)})).catch((e=>{r.default.warn(`${t} failed: ${e}`)}))}route(e,...t){return n.__awaiter(this,void 0,void 0,(function*(){const i=(0,c.wrapLogger)((0,c.wrapLogger)(r.default,"route"),e);if("push"===e||"route"===e)throw o.default.actionNotFoundError(e);const n=this[e];if(void 0===n)throw o.default.actionNotFoundError(e);if(i.debug(t,t.length,n.length),t.length<=n.length)return n.apply(this,t);if(t.length==n.length+1){const i=t.pop();if(!(0,s.default)(i))throw o.default.expectedFunctionError(e);return n.apply(this,t).then(i)}const u=t.pop();if(!(0,s.default)(u))throw o.default.expectedFunctionError(e);const a=t.pop();if(!(0,s.default)(a))throw o.default.expectedFunctionError(e);return n.apply(this,t).then(a).catch(u)}))}getConfig(){return this._ketch.getConfig()}getConsent(){return this._ketch.getConsent()}getEnvironment(){return this._ketch.getEnvironment()}getGeoIP(){return this._ketch.getGeoIP()}getIdentities(){return this._ketch.getIdentities()}getJurisdiction(){return this._ketch.getJurisdiction()}getRegionInfo(){return this._ketch.getRegionInfo()}onConsent(e){return r.default.debug(`onConsent is deprecated - use ketch("on", "${u.default.CONSENT_EVENT}", listener) instead`),this._ketch.on(u.default.CONSENT_EVENT,e),Promise.resolve()}onEnvironment(e){return r.default.debug(`onEnvironment is deprecated - use ketch("on", "${u.default.ENVIRONMENT_EVENT}", listener) instead`),this._ketch.on(u.default.ENVIRONMENT_EVENT,e),Promise.resolve()}onGeoIP(e){return r.default.debug(`onGeoIP is deprecated - use ketch("on", "${u.default.GEOIP_EVENT}", listener) instead`),this._ketch.on(u.default.GEOIP_EVENT,e),Promise.resolve()}onHideExperience(e){return r.default.debug(`onHideExperience is deprecated - use ketch("on", "${u.default.HIDE_EXPERIENCE_EVENT}", listener) instead`),this._ketch.on(u.default.HIDE_EXPERIENCE_EVENT,e),Promise.resolve()}onWillShowExperience(e){return r.default.debug('onWillShowExperience is deprecated - use ketch("on", "'+u.default.WILL_SHOW_EXPERIENCE_EVENT+'", listener) instead'),this._ketch.on(u.default.WILL_SHOW_EXPERIENCE_EVENT,e),Promise.resolve()}onIdentities(e){return r.default.debug(`onIdentities is deprecated - use ketch("on", "${u.default.IDENTITIES_EVENT}", listener) instead`),this._ketch.on(u.default.IDENTITIES_EVENT,e),Promise.resolve()}onJurisdiction(e){return r.default.debug(`onJurisdiction is deprecated - use ketch("on", "${u.default.JURISDICTION_EVENT}", listener) instead`),this._ketch.on(u.default.JURISDICTION_EVENT,e),Promise.resolve()}onRegionInfo(e){return r.default.debug(`onRegionInfo is deprecated - use ketch("on", "${u.default.REGION_INFO_EVENT}", listener) instead`),this._ketch.on(u.default.REGION_INFO_EVENT,e),Promise.resolve()}setEnvironment(e){return r.default.warn("setEnvironment is deprecated"),this._ketch.setEnvironment(e).then((()=>{}))}setGeoIP(e){return r.default.warn("setGeoIP is deprecated"),this._ketch.setGeoIP(e).then((()=>{}))}setIdentities(e){return r.default.warn("setIdentities is deprecated"),this._ketch.setIdentities(e).then((()=>{}))}setJurisdiction(e){return r.default.warn("setJurisdiction is deprecated"),this._ketch.setJurisdiction(e).then((()=>{}))}setRegionInfo(e){return r.default.warn("setRegionInfo is deprecated"),this._ketch.setRegionInfo(e).then((()=>{}))}showConsent(){return this._ketch.showConsentExperience().then((()=>{}))}showPreferences(e){return this._ketch.showPreferenceExperience(e).then((()=>{}))}registerPlugin(e,t){return this._ketch.registerPlugin(e,t)}registerIdentityProvider(e,t){return this._ketch.registerIdentityProvider(e,t)}registerExperienceServer(e){return this._ketch.registerExperienceServer(e)}registerStorageProvider(e,t){return this._ketch.registerStorageProvider(e,t)}setConsent(e){return this._ketch.setConsent(e).then((()=>{}))}showExperience(e){return this._ketch.showExperience(e)}emit(e,...t){return this._ketch.emit(e,...t),Promise.resolve()}on(e,t){return this._ketch.on(e,t),Promise.resolve()}once(e,t){return this._ketch.once(e,t),Promise.resolve()}addListener(e,t){return this._ketch.addListener(e,t),Promise.resolve()}removeListener(e,t){return this._ketch.removeListener(e,t),Promise.resolve()}off(e,t){return this._ketch.off(e,t),Promise.resolve()}removeAllListeners(e){return this._ketch.removeAllListeners(e),Promise.resolve()}}},2078:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boot=void 0;const n=i(655),r=n.__importDefault(i(1329)),o=n.__importDefault(i(9440)),s=n.__importDefault(i(7394));t.boot=function(){return n.__awaiter(this,void 0,void 0,(function*(){window.semaphore=window.semaphore||[],window.ketch=window.ketch||s.default;const e=()=>n.__awaiter(this,void 0,void 0,(function*(){try{yield(0,r.default)()}catch(e){o.default.error(e)}}));"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e,{once:!0}):yield e()}))}},2315:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setPublicConsent=t.setCachedConsent=t.getCachedConsent=t.PUBLIC_CONSENT_TTL=t.CACHED_CONSENT_TTL=t.PUBLIC_CONSENT_KEY_V1=t.CACHED_CONSENT_KEY=void 0;const n=i(655),r=i(4458),o=i(1815);t.CACHED_CONSENT_KEY="_swb_consent_",t.PUBLIC_CONSENT_KEY_V1="_ketch_consent_v1_",t.CACHED_CONSENT_TTL=300,t.PUBLIC_CONSENT_TTL=3456e4;const s=(0,r.getDefaultCacher)();t.getCachedConsent=function(e){return n.__awaiter(this,void 0,void 0,(function*(){const i={organizationCode:e.organizationCode,propertyCode:e.propertyCode,environmentCode:e.environmentCode,jurisdictionCode:e.jurisdictionCode,identities:e.identities,purposes:{},collectedAt:0},n=yield s.getItem(t.CACHED_CONSENT_KEY);return n?0===Object.keys(n).length?i:n.collectedAt?n:i:i}))},t.setCachedConsent=function(e){return n.__awaiter(this,void 0,void 0,(function*(){0!==Object.keys(e).length&&(e.collectedAt=Math.floor(Date.now()/1e3),yield s.setItem(t.CACHED_CONSENT_KEY,e))}))},t.setPublicConsent=function(e,i){return n.__awaiter(this,void 0,void 0,(function*(){if(0===Object.keys(e).length)return;const n={};if(i.purposes){for(const t of i.purposes){if(!Object.prototype.hasOwnProperty.call(e.purposes,t.code))continue;const i=e.purposes[t.code];let r="";"string"==typeof i?r="true"===i?"granted":"denied":i.allowed&&(r="true"===i.allowed?"granted":"denied"),0!=r.length&&(n[t.code]={status:r},t.canonicalPurposeCode&&t.canonicalPurposeCode.length>0&&(n[t.code].canonicalPurposes=[t.canonicalPurposeCode]))}if(Object.keys(n).length>0){const e=btoa(JSON.stringify(n));null===localStorage||void 0===localStorage||localStorage.setItem(t.PUBLIC_CONSENT_KEY_V1,e),(0,o.setCookie)(window,t.PUBLIC_CONSENT_KEY_V1,e,t.PUBLIC_CONSENT_TTL)}}}))}},1911:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={FULFILLED_EVENT:"fulfilled",CONSENT_EVENT:"consent",ENVIRONMENT_EVENT:"environment",GEOIP_EVENT:"geoip",IDENTITIES_EVENT:"identities",IDENTITY_EVENT:"identity",JURISDICTION_EVENT:"jurisdiction",REGION_INFO_EVENT:"regionInfo",SUBSCRIPTIONS_EVENT:"subscriptions",SUBSCRIPTION_CONFIG_EVENT:"subscriptionConfig",RIGHT_INVOKED_EVENT:"rightInvoked",WILL_SHOW_EXPERIENCE_EVENT:"willShowExperience",SHOW_CONSENT_EXPERIENCE_EVENT:"showConsentExperience",SHOW_PREFERENCE_EXPERIENCE_EVENT:"showPreferenceExperience",HIDE_EXPERIENCE_EVENT:"hideExperience",NONE:"none",ENV:"env",PRODUCTION:"production",REGION:"region",JURISDICTION:"jurisdiction",LANGUAGE:"lang",SHOW:"show",PREFERENCES_TAB:"preferences_tab",PREFERENCES_TABS:"preferences_tabs",CONSENT:"cd",PREFERENCES:"preferences",API_SERVER:"shoreline",API_SERVER_BASE_URL:"https://global.ketchcdn.com/web/v2"}},6100:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return window.dataLayer=window.dataLayer||[]}},5274:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={actionNotFoundError:e=>new Error(`action "${e}" not found`),expectedFunctionError:e=>new Error(`action "${e}" expected a function`),unrecognizedLocationError:new Error("unrecognized location"),noIdentitiesError:new Error("no identities"),noPurposesError:new Error("no purposes"),noEnvironmentError:new Error("no environment"),noJurisdictionError:new Error("no jurisdiction"),invalidConfigurationError:new Error("invalid configuration")}},7218:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655).__importDefault(i(1911));t.default=function(e){if(e.services){let t=e.services[n.default.API_SERVER];return t.endsWith("/")&&(t=t.slice(0,-1)),t.endsWith("/web/v2")||(t+="/web/v2"),t}return n.default.API_SERVER_BASE_URL}},4371:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ketch=t.boot=void 0;const n=i(5574);Object.defineProperty(t,"Ketch",{enumerable:!0,get:function(){return n.Ketch}});const r=i(2078);Object.defineProperty(t,"boot",{enumerable:!0,get:function(){return r.boot}})},1329:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(655),r=n.__importDefault(i(9440)),o=n.__importDefault(i(7865)),s=n.__importDefault(i(8805));t.default=function(){return n.__awaiter(this,void 0,void 0,(function*(){const e=window.semaphore||[],t=e.shift();if(!Array.isArray(t)||2!=t.length||"init"!=t[0])throw Error("ketch tag command queue is not configured correctly");const i=t[1];r.default.debug("init",i);const n=new o.default(i),u=yield n.build(),c=new s.default(u);for(;e.length>0;)c.push(e.shift());window.semaphore.push=c.push.bind(c),window.semaphore.loaded=!0,yield u.getConsent()}))}},5887:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}},4128:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return!!(e&&e.constructor&&e.call&&e.apply)}},7394:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,...t){(window.semaphore=window.semaphore||[]).push([e,...t])}},9440:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(7040);t.default=(0,n.getLogger)("ketch",(0,n.getLogLevel)((0,n.getParams)(window.location.search,["ketch_","swb_"])))},737:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=(0,i(7040).getParams)(window.location.search,["ketch_","swb_"]);t.default=n},5752:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonVariant=t.SubscriptionStatus=t.SubscriptionExperienceItemType=t.FormFieldVariant=t.FormFieldType=t.FormFieldCategory=t.FormFieldWidth=t.StorageOriginPolicy=t.ExperienceActionKind=t.ModalPosition=t.BannerPosition=t.SwitchTextRenderLogic=t.IdentityFormat=t.IdentityType=t.CookieCategory=t.CookieProvenance=t.CookieDuration=t.MigrationOption=t.ExperiencePrimaryButtonAction=t.ExperienceButtonDestination=t.ExperienceDefault=t.ExperienceClosedReason=t.ConsentExperienceType=t.ExperienceType=t.isTab=t.Tab=void 0,function(e){e.Overview="overviewTab",e.Rights="rightsTab",e.Consents="consentsTab",e.Subscriptions="subscriptionsTab"}(i=t.Tab||(t.Tab={}));const n=Object.values(i).map((e=>e.toString()));var r,o,s,u,c,a,d,l,f,h,_,p,v,g,E,y,b,m,w,T,C,I,O,N;t.isTab=function(e){return n.includes(e)},(N=t.ExperienceType||(t.ExperienceType={})).Consent="experiences.consent",N.Preference="experiences.preference",(O=t.ConsentExperienceType||(t.ConsentExperienceType={})).Banner="experiences.consent.banner",O.Modal="experiences.consent.modal",O.JIT="experiences.consent.jit",(I=t.ExperienceClosedReason||(t.ExperienceClosedReason={})).SET_CONSENT="setConsent",I.INVOKE_RIGHT="invokeRight",I.CLOSE="close",I.WILL_NOT_SHOW="willNotShow",I.SET_SUBSCRIPTIONS="setSubscriptions",(C=t.ExperienceDefault||(t.ExperienceDefault={}))[C.BANNER=1]="BANNER",C[C.MODAL=2]="MODAL",(T=t.ExperienceButtonDestination||(t.ExperienceButtonDestination={}))[T.GOTO_MODAL=1]="GOTO_MODAL",T[T.GOTO_PREFERENCE=2]="GOTO_PREFERENCE",T[T.REJECT_ALL=3]="REJECT_ALL",(w=t.ExperiencePrimaryButtonAction||(t.ExperiencePrimaryButtonAction={}))[w.SAVE_CURRENT_STATE=1]="SAVE_CURRENT_STATE",w[w.ACCEPT_ALL=2]="ACCEPT_ALL",(m=t.MigrationOption||(t.MigrationOption={}))[m.MIGRATE_DEFAULT=0]="MIGRATE_DEFAULT",m[m.MIGRATE_NEVER=1]="MIGRATE_NEVER",m[m.MIGRATE_FROM_ALLOW=2]="MIGRATE_FROM_ALLOW",m[m.MIGRATE_FROM_DENY=3]="MIGRATE_FROM_DENY",m[m.MIGRATE_ALWAYS=4]="MIGRATE_ALWAYS",(b=t.CookieDuration||(t.CookieDuration={}))[b.SESSION=1]="SESSION",b[b.PERSISTENT=2]="PERSISTENT",(y=t.CookieProvenance||(t.CookieProvenance={}))[y.FIRST_PARTY=1]="FIRST_PARTY",y[y.THIRD_PARTY=2]="THIRD_PARTY",(E=t.CookieCategory||(t.CookieCategory={}))[E.STRICTLY_NECESSARY=1]="STRICTLY_NECESSARY",E[E.FUNCTIONAL=2]="FUNCTIONAL",E[E.PERFORMANCE=3]="PERFORMANCE",E[E.MARKETING=4]="MARKETING",(g=t.IdentityType||(t.IdentityType={})).IDENTITY_TYPE_UNDEFINED="",g.IDENTITY_TYPE_DATA_LAYER="dataLayer",g.IDENTITY_TYPE_WINDOW="window",g.IDENTITY_TYPE_COOKIE="cookie",g.IDENTITY_TYPE_MANAGED="managedCookie",g.IDENTITY_TYPE_LOCAL_STORAGE="localStorage",g.IDENTITY_TYPE_SESSION_STORAGE="sessionStorage",g.IDENTITY_TYPE_QUERY_STRING="queryString",(v=t.IdentityFormat||(t.IdentityFormat={})).IDENTITY_FORMAT_UNDEFINED="",v.IDENTITY_FORMAT_STRING="string",v.IDENTITY_FORMAT_JSON="json",v.IDENTITY_FORMAT_JWT="jwt",v.IDENTITY_FORMAT_QUERY="query",v.IDENTITY_FORMAT_SEMICOLON="semicolon",(p=t.SwitchTextRenderLogic||(t.SwitchTextRenderLogic={}))[p.SWITCH_TEXT_RENDER_ALL=1]="SWITCH_TEXT_RENDER_ALL",p[p.SWITCH_TEXT_RENDER_LEGAL_BASIS=2]="SWITCH_TEXT_RENDER_LEGAL_BASIS",p[p.SWITCH_TEXT_RENDER_CHANGE=3]="SWITCH_TEXT_RENDER_CHANGE",p[p.SWITCH_TEXT_RENDER_NEVER=4]="SWITCH_TEXT_RENDER_NEVER",(_=t.BannerPosition||(t.BannerPosition={}))[_.BOTTOM=1]="BOTTOM",_[_.TOP=2]="TOP",_[_.BOTTOM_LEFT=3]="BOTTOM_LEFT",_[_.BOTTOM_RIGHT=4]="BOTTOM_RIGHT",(h=t.ModalPosition||(t.ModalPosition={}))[h.CENTER=1]="CENTER",h[h.LEFT_FULL_HEIGHT=2]="LEFT_FULL_HEIGHT",h[h.RIGHT_FULL_HEIGHT=3]="RIGHT_FULL_HEIGHT",(f=t.ExperienceActionKind||(t.ExperienceActionKind={}))[f.ShowExperience=0]="ShowExperience",f[f.HideExperience=1]="HideExperience",f[f.SetConsent=2]="SetConsent",f[f.SetSubscription=3]="SetSubscription",f[f.InvokeRight=4]="InvokeRight",(l=t.StorageOriginPolicy||(t.StorageOriginPolicy={})).CrossOrigin="cross-origin",l.SameOrigin="same-origin,",(d=t.FormFieldWidth||(t.FormFieldWidth={})).UNSPECIFIED="unspecified",d.HALF="half",d.FULL="full",(a=t.FormFieldCategory||(t.FormFieldCategory={})).UNSPECIFIED="unspecified",a.DEFAULT="default",a.CUSTOM="custom",(c=t.FormFieldType||(t.FormFieldType={})).UNSPECIFIED="unspecified",c.TEXT="text",c.DROPDOWN="dropdown",(u=t.FormFieldVariant||(t.FormFieldVariant={})).UNSPECIFIED="unspecified",u.INPUT="input",u.TEXTAREA="textarea",(s=t.SubscriptionExperienceItemType||(t.SubscriptionExperienceItemType={}))[s.SUBSCRIPTION_EXPERIENCE_ITEM_TYPE_UNKNOWN=0]="SUBSCRIPTION_EXPERIENCE_ITEM_TYPE_UNKNOWN",s[s.SUBSCRIPTION_EXPERIENCE_ITEM_TYPE_TOPIC=1]="SUBSCRIPTION_EXPERIENCE_ITEM_TYPE_TOPIC",s[s.SUBSCRIPTION_EXPERIENCE_ITEM_TYPE_CONTROL=2]="SUBSCRIPTION_EXPERIENCE_ITEM_TYPE_CONTROL",(o=t.SubscriptionStatus||(t.SubscriptionStatus={})).Denied="denied",o.Granted="granted",(r=t.ButtonVariant||(t.ButtonVariant={})).Outlined="outlined",r.Contained="contained"},7808:e=>{"use strict";e.exports=JSON.parse('{"version":"2.13.17"}')}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,i),o.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";const e=i(655),t=i(4371),n=e.__importDefault(i(3857));window.semaphore=window.semaphore||[],window.semaphore.push(["registerPlugin",n.default]),(0,t.boot)()})()})();