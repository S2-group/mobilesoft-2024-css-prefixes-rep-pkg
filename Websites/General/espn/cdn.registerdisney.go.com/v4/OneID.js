/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={0:e=>{var t={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};e.exports&&(e.exports=t),"function"===typeof window.define&&window.define([],(function(){return t})),t.cipher.aes=function(e){this._tables[0][0][0]||this._precompute();var n,o,r,s,i,a=this._tables[0][4],c=this._tables[1],u=e.length,l=1;if(4!==u&&6!==u&&8!==u)throw new t.exception.invalid("invalid aes key size");for(this._key=[s=e.slice(0),i=[]],n=u;n<4*u+28;n++)r=s[n-1],(n%u===0||8===u&&n%u===4)&&(r=a[r>>>24]<<24^a[r>>16&255]<<16^a[r>>8&255]<<8^a[255&r],n%u===0&&(r=r<<8^r>>>24^l<<24,l=l<<1^283*(l>>7))),s[n]=s[n-u]^r;for(o=0;n;o++,n--)r=s[3&o?n:n-4],i[o]=n<=4||o<4?r:c[0][a[r>>>24]]^c[1][a[r>>16&255]]^c[2][a[r>>8&255]]^c[3][a[255&r]]},t.cipher.aes.prototype={encrypt:function(e){return this._crypt(e,0)},decrypt:function(e){return this._crypt(e,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var e,t,n,o,r,s,i,a,c=this._tables[0],u=this._tables[1],l=c[4],d=u[4],p=[],f=[];for(e=0;e<256;e++)f[(p[e]=e<<1^283*(e>>7))^e]=e;for(t=n=0;!l[t];t^=o||1,n=f[n]||1)for(s=(s=n^n<<1^n<<2^n<<3^n<<4)>>8^255&s^99,l[t]=s,d[s]=t,a=16843009*p[r=p[o=p[t]]]^65537*r^257*o^16843008*t,i=257*p[s]^16843008*s,e=0;e<4;e++)c[e][t]=i=i<<24^i>>>8,u[e][s]=a=a<<24^a>>>8;for(e=0;e<5;e++)c[e]=c[e].slice(0),u[e]=u[e].slice(0)},_crypt:function(e,n){if(4!==e.length)throw new t.exception.invalid("invalid aes block size");var o,r,s,i,a=this._key[n],c=e[0]^a[0],u=e[n?3:1]^a[1],l=e[2]^a[2],d=e[n?1:3]^a[3],p=a.length/4-2,f=4,h=[0,0,0,0],g=this._tables[n],E=g[0],_=g[1],m=g[2],y=g[3],I=g[4];for(i=0;i<p;i++)o=E[c>>>24]^_[u>>16&255]^m[l>>8&255]^y[255&d]^a[f],r=E[u>>>24]^_[l>>16&255]^m[d>>8&255]^y[255&c]^a[f+1],s=E[l>>>24]^_[d>>16&255]^m[c>>8&255]^y[255&u]^a[f+2],d=E[d>>>24]^_[c>>16&255]^m[u>>8&255]^y[255&l]^a[f+3],f+=4,c=o,u=r,l=s;for(i=0;i<4;i++)h[n?3&-i:i]=I[c>>>24]<<24^I[u>>16&255]<<16^I[l>>8&255]<<8^I[255&d]^a[f++],o=c,c=u,u=l,l=d,d=o;return h}},t.bitArray={bitSlice:function(e,n,o){return e=t.bitArray._shiftRight(e.slice(n/32),32-(31&n)).slice(1),void 0===o?e:t.bitArray.clamp(e,o-n)},extract:function(e,t,n){var o=Math.floor(-t-n&31);return(-32&(t+n-1^t)?e[t/32|0]<<32-o^e[t/32+1|0]>>>o:e[t/32|0]>>>o)&(1<<n)-1},concat:function(e,n){if(0===e.length||0===n.length)return e.concat(n);var o=e[e.length-1],r=t.bitArray.getPartial(o);return 32===r?e.concat(n):t.bitArray._shiftRight(n,r,0|o,e.slice(0,e.length-1))},bitLength:function(e){var n,o=e.length;return 0===o?0:(n=e[o-1],32*(o-1)+t.bitArray.getPartial(n))},clamp:function(e,n){if(32*e.length<n)return e;var o=(e=e.slice(0,Math.ceil(n/32))).length;return n&=31,o>0&&n&&(e[o-1]=t.bitArray.partial(n,e[o-1]&2147483648>>n-1,1)),e},partial:function(e,t,n){return 32===e?t:(n?0|t:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,n){if(t.bitArray.bitLength(e)!==t.bitArray.bitLength(n))return!1;var o,r=0;for(o=0;o<e.length;o++)r|=e[o]^n[o];return 0===r},_shiftRight:function(e,n,o,r){var s,i,a;for(void 0===r&&(r=[]);n>=32;n-=32)r.push(o),o=0;if(0===n)return r.concat(e);for(s=0;s<e.length;s++)r.push(o|e[s]>>>n),o=e[s]<<32-n;return i=e.length?e[e.length-1]:0,a=t.bitArray.getPartial(i),r.push(t.bitArray.partial(n+a&31,n+a>32?o:r.pop(),1)),r},_xor4:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,n;for(t=0;t<e.length;++t)n=e[t],e[t]=n>>>24|n>>>8&65280|(65280&n)<<8|n<<24;return e}},t.codec.utf8String={fromBits:function(e){var n,o,r="",s=t.bitArray.bitLength(e);for(n=0;n<s/8;n++)0===(3&n)&&(o=e[n/4]),r+=String.fromCharCode(o>>>24),o<<=8;return decodeURIComponent(escape(r))},toBits:function(e){e=unescape(encodeURIComponent(e));var n,o=[],r=0;for(n=0;n<e.length;n++)r=r<<8|e.charCodeAt(n),3===(3&n)&&(o.push(r),r=0);return 3&n&&o.push(t.bitArray.partial(8*(3&n),r)),o}},t.codec.hex={fromBits:function(e){var n,o="";for(n=0;n<e.length;n++)o+=(0xf00000000000+(0|e[n])).toString(16).substr(4);return o.substr(0,t.bitArray.bitLength(e)/4)},toBits:function(e){var n,o,r=[];for(o=(e=e.replace(/\s|0x/g,"")).length,e+="00000000",n=0;n<e.length;n+=8)r.push(0^parseInt(e.substr(n,8),16));return t.bitArray.clamp(r,4*o)}},t.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,n,o){var r,s="",i=0,a=t.codec.base64._chars,c=0,u=t.bitArray.bitLength(e);for(o&&(a=a.substr(0,62)+"-_"),r=0;6*s.length<u;)s+=a.charAt((c^e[r]>>>i)>>>26),i<6?(c=e[r]<<6-i,i+=26,r++):(c<<=6,i-=6);for(;3&s.length&&!n;)s+="=";return s},toBits:function(e,n){e=e.replace(/\s|=/g,"");var o,r,s=[],i=0,a=t.codec.base64._chars,c=0;for(n&&(a=a.substr(0,62)+"-_"),o=0;o<e.length;o++){if((r=a.indexOf(e.charAt(o)))<0)throw new t.exception.invalid("this isn't base64!");i>26?(i-=26,s.push(c^r>>>i),c=r<<32-i):c^=r<<32-(i+=6)}return 56&i&&s.push(t.bitArray.partial(56&i,c,1)),s}},t.codec.base64url={fromBits:function(e){return t.codec.base64.fromBits(e,1,1)},toBits:function(e){return t.codec.base64.toBits(e,1)}},t.hash.sha256=function(e){this._key[0]||this._precompute(),e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},t.hash.sha256.hash=function(e){return(new t.hash.sha256).update(e).finalize()},t.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){"string"===typeof e&&(e=t.codec.utf8String.toBits(e));var n,o=this._buffer=t.bitArray.concat(this._buffer,e),r=this._length,s=this._length=r+t.bitArray.bitLength(e);for(n=512+r&-512;n<=s;n+=512)this._block(o.splice(0,16));return this},finalize:function(){var e,n=this._buffer,o=this._h;for(e=(n=t.bitArray.concat(n,[t.bitArray.partial(1,1)])).length+2;15&e;e++)n.push(0);for(n.push(Math.floor(this._length/4294967296)),n.push(0|this._length);n.length;)this._block(n.splice(0,16));return this.reset(),o},_init:[],_key:[],_precompute:function(){var e,t=0,n=2;function o(e){return 4294967296*(e-Math.floor(e))|0}e:for(;t<64;n++){for(e=2;e*e<=n;e++)if(n%e===0)continue e;t<8&&(this._init[t]=o(Math.pow(n,.5))),this._key[t]=o(Math.pow(n,1/3)),t++}},_block:function(e){var t,n,o,r,s=e.slice(0),i=this._h,a=this._key,c=i[0],u=i[1],l=i[2],d=i[3],p=i[4],f=i[5],h=i[6],g=i[7];for(t=0;t<64;t++)t<16?n=s[t]:(o=s[t+1&15],r=s[t+14&15],n=s[15&t]=(o>>>7^o>>>18^o>>>3^o<<25^o<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+s[15&t]+s[t+9&15]|0),n=n+g+(p>>>6^p>>>11^p>>>25^p<<26^p<<21^p<<7)+(h^p&(f^h))+a[t],g=h,h=f,f=p,p=d+n|0,d=l,l=u,c=n+((u=c)&l^d&(u^l))+(u>>>2^u>>>13^u>>>22^u<<30^u<<19^u<<10)|0;i[0]=i[0]+c|0,i[1]=i[1]+u|0,i[2]=i[2]+l|0,i[3]=i[3]+d|0,i[4]=i[4]+p|0,i[5]=i[5]+f|0,i[6]=i[6]+h|0,i[7]=i[7]+g|0}},t.mode.ccm={name:"ccm",encrypt:function(e,n,o,r,s){var i,a,c=n.slice(0),u=t.bitArray,l=u.bitLength(o)/8,d=u.bitLength(c)/8;if(s=s||64,r=r||[],l<7)throw new t.exception.invalid("ccm: iv must be at least 7 bytes");for(i=2;i<4&&d>>>8*i;i++);return i<15-l&&(i=15-l),o=u.clamp(o,8*(15-i)),a=t.mode.ccm._computeTag(e,n,o,r,s,i),c=t.mode.ccm._ctrMode(e,c,o,a,s,i),u.concat(c.data,c.tag)},decrypt:function(e,n,o,r,s){s=s||64,r=r||[];var i,a,c=t.bitArray,u=c.bitLength(o)/8,l=c.bitLength(n),d=c.clamp(n,l-s),p=c.bitSlice(n,l-s);if(l=(l-s)/8,u<7)throw new t.exception.invalid("ccm: iv must be at least 7 bytes");for(i=2;i<4&&l>>>8*i;i++);if(i<15-u&&(i=15-u),o=c.clamp(o,8*(15-i)),d=t.mode.ccm._ctrMode(e,d,o,p,s,i),a=t.mode.ccm._computeTag(e,d.data,o,r,s,i),!c.equal(d.tag,a))throw new t.exception.corrupt("ccm: tag doesn't match");return d.data},_computeTag:function(e,n,o,r,s,i){var a,c,u,l=[],d=t.bitArray,p=d._xor4;if((s/=8)%2||s<4||s>16)throw new t.exception.invalid("ccm: invalid tag length");if(r.length>4294967295||n.length>4294967295)throw new t.exception.bug("ccm: can't deal with 4GiB or more data");if(a=[d.partial(8,(r.length?64:0)|s-2<<2|i-1)],(a=d.concat(a,o))[3]|=d.bitLength(n)/8,a=e.encrypt(a),r.length)for((c=d.bitLength(r)/8)<=65279?l=[d.partial(16,c)]:c<=4294967295&&(l=d.concat([d.partial(16,65534)],[c])),l=d.concat(l,r),u=0;u<l.length;u+=4)a=e.encrypt(p(a,l.slice(u,u+4).concat([0,0,0])));for(u=0;u<n.length;u+=4)a=e.encrypt(p(a,n.slice(u,u+4).concat([0,0,0])));return d.clamp(a,8*s)},_ctrMode:function(e,n,o,r,s,i){var a,c,u,l=t.bitArray,d=l._xor4,p=n.length,f=l.bitLength(n);if(u=l.concat([l.partial(8,i-1)],o).concat([0,0,0]).slice(0,4),r=l.bitSlice(d(r,e.encrypt(u)),0,s),!p)return{tag:r,data:[]};for(c=0;c<p;c+=4)u[3]++,a=e.encrypt(u),n[c]^=a[0],n[c+1]^=a[1],n[c+2]^=a[2],n[c+3]^=a[3];return{tag:r,data:l.clamp(n,f)}}},t.mode.ocb2={name:"ocb2",encrypt:function(e,n,o,r,s,i){if(128!==t.bitArray.bitLength(o))throw new t.exception.invalid("ocb iv must be 128 bits");var a,c,u,l,d=t.mode.ocb2._times2,p=t.bitArray,f=p._xor4,h=[0,0,0,0],g=d(e.encrypt(o)),E=[];for(r=r||[],s=s||64,a=0;a+4<n.length;a+=4)h=f(h,c=n.slice(a,a+4)),E=E.concat(f(g,e.encrypt(f(g,c)))),g=d(g);return c=n.slice(a),u=p.bitLength(c),l=e.encrypt(f(g,[0,0,0,u])),c=p.clamp(f(c.concat([0,0,0]),l),u),h=f(h,f(c.concat([0,0,0]),l)),h=e.encrypt(f(h,f(g,d(g)))),r.length&&(h=f(h,i?r:t.mode.ocb2.pmac(e,r))),E.concat(p.concat(c,p.clamp(h,s)))},decrypt:function(e,n,o,r,s,i){if(128!==t.bitArray.bitLength(o))throw new t.exception.invalid("ocb iv must be 128 bits");s=s||64;var a,c,u,l,d=t.mode.ocb2._times2,p=t.bitArray,f=p._xor4,h=[0,0,0,0],g=d(e.encrypt(o)),E=t.bitArray.bitLength(n)-s,_=[];for(r=r||[],a=0;a+4<E/32;a+=4)c=f(g,e.decrypt(f(g,n.slice(a,a+4)))),h=f(h,c),_=_.concat(c),g=d(g);if(u=E-32*a,l=e.encrypt(f(g,[0,0,0,u])),c=f(l,p.clamp(n.slice(a),u).concat([0,0,0])),h=f(h,c),h=e.encrypt(f(h,f(g,d(g)))),r.length&&(h=f(h,i?r:t.mode.ocb2.pmac(e,r))),!p.equal(p.clamp(h,s),p.bitSlice(n,E)))throw new t.exception.corrupt("ocb: tag doesn't match");return _.concat(p.clamp(c,u))},pmac:function(e,n){var o,r,s=t.mode.ocb2._times2,i=t.bitArray,a=i._xor4,c=[0,0,0,0],u=e.encrypt([0,0,0,0]);for(u=a(u,s(s(u))),o=0;o+4<n.length;o+=4)u=s(u),c=a(c,e.encrypt(a(u,n.slice(o,o+4))));return r=n.slice(o),i.bitLength(r)<128&&(u=a(u,s(u)),r=i.concat(r,[-2147483648,0,0,0])),c=a(c,r),e.encrypt(a(s(a(u,s(u))),c))},_times2:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^135*(e[0]>>>31)]}},t.mode.gcm={name:"gcm",encrypt:function(e,n,o,r,s){var i,a=n.slice(0),c=t.bitArray;return s=s||128,r=r||[],i=t.mode.gcm._ctrMode(!0,e,a,r,o,s),c.concat(i.data,i.tag)},decrypt:function(e,n,o,r,s){var i,a,c=n.slice(0),u=t.bitArray,l=u.bitLength(c);if(r=r||[],(s=s||128)<=l?(a=u.bitSlice(c,l-s),c=u.bitSlice(c,0,l-s)):(a=c,c=[]),i=t.mode.gcm._ctrMode(!1,e,c,r,o,s),!u.equal(i.tag,a))throw new t.exception.corrupt("gcm: tag doesn't match");return i.data},_galoisMultiply:function(e,n){var o,r,s,i,a,c=t.bitArray._xor4;for(s=[0,0,0,0],i=n.slice(0),o=0;o<128;o++){for(0!==(e[Math.floor(o/32)]&1<<31-o%32)&&(s=c(s,i)),a=0!==(1&i[3]),r=3;r>0;r--)i[r]=i[r]>>>1|(1&i[r-1])<<31;i[0]=i[0]>>>1,a&&(i[0]=i[0]^225<<24)}return s},_ghash:function(e,n,o){var r,s,i=o.length;for(r=n.slice(0),s=0;s<i;s+=4)r[0]^=4294967295&o[s],r[1]^=4294967295&o[s+1],r[2]^=4294967295&o[s+2],r[3]^=4294967295&o[s+3],r=t.mode.gcm._galoisMultiply(r,e);return r},_ctrMode:function(e,n,o,r,s,i){var a,c,u,l,d,p,f,h,g,E,_,m,y=t.bitArray;for(g=o.length,E=y.bitLength(o),_=y.bitLength(r),m=y.bitLength(s),a=n.encrypt([0,0,0,0]),96===m?(c=s.slice(0),c=y.concat(c,[1])):(c=t.mode.gcm._ghash(a,[0,0,0,0],s),c=t.mode.gcm._ghash(a,c,[0,0,Math.floor(m/4294967296),4294967295&m])),u=t.mode.gcm._ghash(a,[0,0,0,0],r),p=c.slice(0),f=u.slice(0),e||(f=t.mode.gcm._ghash(a,u,o)),d=0;d<g;d+=4)p[3]++,l=n.encrypt(p),o[d]^=l[0],o[d+1]^=l[1],o[d+2]^=l[2],o[d+3]^=l[3];return o=y.clamp(o,E),e&&(f=t.mode.gcm._ghash(a,u,o)),h=[Math.floor(_/4294967296),4294967295&_,Math.floor(E/4294967296),4294967295&E],f=t.mode.gcm._ghash(a,f,h),l=n.encrypt(c),f[0]^=l[0],f[1]^=l[1],f[2]^=l[2],f[3]^=l[3],{tag:y.bitSlice(f,0,i),data:o}}},t.misc.hmac=function(e,n){this._hash=n=n||t.hash.sha256;var o,r=[[],[]],s=n.prototype.blockSize/32;for(this._baseHash=[new n,new n],e.length>s&&(e=n.hash(e)),o=0;o<s;o++)r[0][o]=909522486^e[o],r[1][o]=1549556828^e[o];this._baseHash[0].update(r[0]),this._baseHash[1].update(r[1]),this._resultHash=new n(this._baseHash[0])},t.misc.hmac.prototype.encrypt=t.misc.hmac.prototype.mac=function(e){if(this._updated)throw new t.exception.invalid("encrypt on already updated hmac called!");return this.update(e),this.digest(e)},t.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},t.misc.hmac.prototype.update=function(e){this._updated=!0,this._resultHash.update(e)},t.misc.hmac.prototype.digest=function(){var e=this._resultHash.finalize(),t=new this._hash(this._baseHash[1]).update(e).finalize();return this.reset(),t},t.misc.pbkdf2=function(e,n,o,r,s){if(o=o||1e3,r<0||o<0)throw t.exception.invalid("invalid params to pbkdf2");"string"===typeof e&&(e=t.codec.utf8String.toBits(e)),"string"===typeof n&&(n=t.codec.utf8String.toBits(n));var i,a,c,u,l,d=new(s=s||t.misc.hmac)(e),p=[],f=t.bitArray;for(l=1;32*p.length<(r||1);l++){for(i=a=d.encrypt(f.concat(n,[l])),c=1;c<o;c++)for(a=d.encrypt(a),u=0;u<a.length;u++)i[u]^=a[u];p=p.concat(i)}return r&&(p=f.clamp(p,r)),p},t.prng=function(e){this._pools=[new t.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=e,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},t.prng.prototype={randomWords:function(e,n){var o,r,s=[],i=this.isReady(n);if(i===this._NOT_READY)throw new t.exception.notReady("generator isn't seeded");for(i&this._REQUIRES_RESEED&&this._reseedFromPools(!(i&this._READY)),o=0;o<e;o+=4)(o+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),r=this._gen4words(),s.push(r[0],r[1],r[2],r[3]);return this._gate(),s.slice(0,e)},setDefaultParanoia:function(e,t){if(0===e&&"Setting paranoia=0 will ruin your security; use it only for testing"!==t)throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=e},addEntropy:function(e,n,o){o=o||"user";var r,s,i,a,c=(new Date).valueOf(),u=this._robins[o],l=this.isReady(),d=0;switch(void 0===(r=this._collectorIds[o])&&(r=this._collectorIds[o]=this._collectorIdNext++),void 0===u&&(u=this._robins[o]=0),this._robins[o]=(this._robins[o]+1)%this._pools.length,typeof e){case"number":void 0===n&&(n=1),this._pools[u].update([r,this._eventId++,1,n,c,1,0|e]);break;case"object":if("[object Uint32Array]"===(a=Object.prototype.toString.call(e))){for(i=[],s=0;s<e.length;s++)i.push(e[s]);e=i}else for("[object Array]"!==a&&(d=1),s=0;s<e.length&&!d;s++)"number"!==typeof e[s]&&(d=1);if(!d){if(void 0===n)for(n=0,s=0;s<e.length;s++)for(i=e[s];i>0;)n++,i>>>=1;this._pools[u].update([r,this._eventId++,2,n,c,e.length].concat(e))}break;case"string":void 0===n&&(n=e.length),this._pools[u].update([r,this._eventId++,3,n,c,e.length]),this._pools[u].update(e);break;default:d=1}if(d)throw new t.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[u]+=n,this._poolStrength+=n,l===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(e){var t=this._PARANOIA_LEVELS[void 0!==e?e:this._defaultParanoia];return this._strength&&this._strength>=t?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=t?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(e){var t=this._PARANOIA_LEVELS[e||this._defaultParanoia];return this._strength>=t||this._poolStrength>t?1:this._poolStrength/t},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector),touchCollector:this._bind(this._touchCollector)},window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.addEventListener("touchmove",this._eventListener.touchCollector,!1);else{if(!document.attachEvent)throw new t.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.removeEventListener("touchmove",this._eventListener.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(e,t){this._callbacks[e][this._callbackI++]=t},removeEventListener:function(e,t){var n,o,r=this._callbacks[e],s=[];for(o in r)r.hasOwnProperty(o)&&r[o]===t&&s.push(o);for(n=0;n<s.length;n++)delete r[o=s[n]]},_bind:function(e){var t=this;return function(){e.apply(t,arguments)}},_gen4words:function(){for(var e=0;e<4&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new t.cipher.aes(this._key)},_reseed:function(e){this._key=t.hash.sha256.hash(this._key.concat(e)),this._cipher=new t.cipher.aes(this._key);for(var n=0;n<4&&(this._counter[n]=this._counter[n]+1|0,!this._counter[n]);n++);},_reseedFromPools:function(e){var n,o=[],r=0;for(this._nextReseed=o[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,n=0;n<16;n++)o.push(4294967296*Math.random()|0);for(n=0;n<this._pools.length&&(o=o.concat(this._pools[n].finalize()),r+=this._poolEntropy[n],this._poolEntropy[n]=0,e||!(this._reseedCount&1<<n));n++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new t.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=r,r>this._strength&&(this._strength=r),this._reseedCount++,this._reseed(o)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(e){var n,o;try{n=e.x||e.clientX||e.offsetX||0,o=e.y||e.clientY||e.offsetY||0}catch(e){n=0,o=0}0!=n&&0!=o&&t.random.addEntropy([n,o],2,"mouse"),this._addCurrentTimeToEntropy(0)},_touchCollector:function(e){var n=e.touches[0]||e.changedTouches[0],o=n.pageX||n.clientX,r=n.pageY||n.clientY;t.random.addEntropy([o,r],1,"touch"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(e){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?t.random.addEntropy(window.performance.now(),e,"loadtime"):t.random.addEntropy((new Date).valueOf(),e,"loadtime")},_accelerometerCollector:function(e){var n=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z;if(window.orientation){var o=window.orientation;"number"===typeof o&&t.random.addEntropy(o,1,"accelerometer")}n&&t.random.addEntropy(n,2,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(e,n){var o,r=t.random._callbacks[e],s=[];for(o in r)r.hasOwnProperty(o)&&s.push(r[o]);for(o=0;o<s.length;o++)s[o](n)}},t.random=new t.prng(6),function(){try{var n,o,r;if(e.exports&&(o=null)&&o.randomBytes)n=o.randomBytes(128),n=new Uint32Array(new Uint8Array(n).buffer),t.random.addEntropy(n,1024,"crypto.randomBytes");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){if(r=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(r);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)return;window.msCrypto.getRandomValues(r)}t.random.addEntropy(r,1024,"crypto.getRandomValues")}}catch(e){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}}(),t.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},_encrypt:function(e,n,o,r){o=o||{},r=r||{};var s,i,a,c=t.json,u=c._add({iv:t.random.randomWords(4,0)},c.defaults);if(c._add(u,o),a=u.adata,"string"===typeof u.salt&&(u.salt=t.codec.base64.toBits(u.salt)),"string"===typeof u.iv&&(u.iv=t.codec.base64.toBits(u.iv)),!t.mode[u.mode]||!t.cipher[u.cipher]||"string"===typeof e&&u.iter<=100||64!==u.ts&&96!==u.ts&&128!==u.ts||128!==u.ks&&192!==u.ks&&256!==u.ks||u.iv.length<2||u.iv.length>4)throw new t.exception.invalid("json encrypt: invalid parameters");return"string"===typeof e?(e=(s=t.misc.cachedPbkdf2(e,u)).key.slice(0,u.ks/32),u.salt=s.salt):t.ecc&&e instanceof t.ecc.elGamal.publicKey&&(s=e.kem(),u.kemtag=s.tag,e=s.key.slice(0,u.ks/32)),"string"===typeof n&&(n=t.codec.utf8String.toBits(n)),"string"===typeof a&&(u.adata=a=t.codec.utf8String.toBits(a)),i=new t.cipher[u.cipher](e),c._add(r,u),r.key=e,u.ct=t.mode[u.mode].encrypt(i,n,u.iv,a,u.ts),u},encrypt:function(e,n,o,r){if(e&&n){var s=t.json,i=s._encrypt.apply(s,arguments);return s.encode(i)}},_decrypt:function(e,n,o,r){o=o||{},r=r||{};var s,i,a,c=t.json,u=c._add(c._add(c._add({},c.defaults),n),o,!0),l=u.adata;if("string"===typeof u.salt&&(u.salt=t.codec.base64.toBits(u.salt)),"string"===typeof u.iv&&(u.iv=t.codec.base64.toBits(u.iv)),!t.mode[u.mode]||!t.cipher[u.cipher]||"string"===typeof e&&u.iter<=100||64!==u.ts&&96!==u.ts&&128!==u.ts||128!==u.ks&&192!==u.ks&&256!==u.ks||!u.iv||u.iv.length<2||u.iv.length>4)throw new t.exception.invalid("json decrypt: invalid parameters");return"string"===typeof e?(e=(i=t.misc.cachedPbkdf2(e,u)).key.slice(0,u.ks/32),u.salt=i.salt):t.ecc&&e instanceof t.ecc.elGamal.secretKey&&(e=e.unkem(t.codec.base64.toBits(u.kemtag)).slice(0,u.ks/32)),"string"===typeof l&&(l=t.codec.utf8String.toBits(l)),a=new t.cipher[u.cipher](e),s=t.mode[u.mode].decrypt(a,u.ct,u.iv,l,u.ts),c._add(r,u),r.key=e,1===o.raw?s:t.codec.utf8String.fromBits(s)},decrypt:function(e,n,o,r){if(e&&n){var s=t.json;return s._decrypt(e,s.decode(n),o,r)}},encode:function(e){var n,o="{",r="";for(n in e)if(e.hasOwnProperty(n)){if(!n.match(/^[a-z0-9]+$/i))throw new t.exception.invalid("json encode: invalid property name");switch(o+=r+'"'+n+'":',r=",",typeof e[n]){case"number":case"boolean":o+=e[n];break;case"string":o+='"'+escape(e[n])+'"';break;case"object":o+='"'+t.codec.base64.fromBits(e[n],0)+'"';break;default:throw new t.exception.bug("json encode: unsupported type")}}return o+"}"},decode:function(e){if(!(e=e.replace(/\s/g,"")).match(/^\{.*\}$/))throw new t.exception.invalid("json decode: this isn't json!");var n,o,r=e.replace(/^\{|\}$/g,"").split(/,/),s={};for(n=0;n<r.length;n++){if(!(o=r[n].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new t.exception.invalid("json decode: this isn't json!");o[3]?s[o[2]]=parseInt(o[3],10):o[4]?s[o[2]]=o[2].match(/^(ct|adata|salt|iv)$/)?t.codec.base64.toBits(o[4]):unescape(o[4]):o[5]&&(s[o[2]]="true"===o[5])}return s},_add:function(e,n,o){if(void 0===e&&(e={}),void 0===n)return e;var r;for(r in n)if(n.hasOwnProperty(r)){if(o&&void 0!==e[r]&&e[r]!==n[r])throw new t.exception.invalid("required parameter overridden");e[r]=n[r]}return e},_subtract:function(e,t){var n,o={};for(n in e)e.hasOwnProperty(n)&&e[n]!==t[n]&&(o[n]=e[n]);return o},_filter:function(e,t){var n,o={};for(n=0;n<t.length;n++)void 0!==e[t[n]]&&(o[t[n]]=e[t[n]]);return o}},t.encrypt=t.json.encrypt,t.decrypt=t.json.decrypt,t.misc._pbkdf2Cache={},t.misc.cachedPbkdf2=function(e,n){var o,r,s,i,a=t.misc._pbkdf2Cache;return i=(n=n||{}).iter||1e3,(o=(r=a[e]=a[e]||{})[i]=r[i]||{firstSalt:n.salt&&n.salt.length?n.salt.slice(0):t.random.randomWords(2,0)})[s=void 0===n.salt?o.firstSalt:n.salt]=o[s]||t.misc.pbkdf2(e,s,n.iter),{key:o[s].slice(0),salt:s.slice(0)}}},698:(e,t,n)=>{"use strict";n.d(t,{tV:()=>_,h$:()=>m,uP:()=>y,d9:()=>l,kn:()=>g,_A:()=>u,U2:()=>d,hK:()=>c,KT:()=>h,kH:()=>I,Cd:()=>R,m8:()=>w,t8:()=>E,Vj:()=>p});var o=n(742);function r(){}function s(){}function i(e,t){let n;t=t||1/0;const{length:o}=e;let r=null;const s=[];let i=0;for(;i<o;i++){if(n=e.charCodeAt(i),n>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(i+1===o){(t-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&((t-=3)>-1&&s.push(239,191,189),r=null);if(n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<2097152))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function a(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function c(e){if("string"===typeof e)return e.replace(/_/g,"-").toLowerCase()}function u(e){return null===e||"object"!==typeof e?e:(Object.keys(e).forEach((t=>{null!==e[t]&&"object"===typeof e[t]&&(e[t]=u(e[t]))})),Object.isFrozen(e)?e:Object.freeze(e))}function l(e){let t;if(null===e||"object"!==typeof e)return e;if("[object Date]"===Object.prototype.toString.call(e))return new Date(e.getTime());try{t=new e.constructor}catch(e){return}return Object.keys(e).forEach((n=>{t[n]=l(e[n])})),t}function d(e,t,n){const o=t.split(".").reduce(((e,t)=>e&&void 0!==e[t]?e[t]:void 0),e);return o&&n?o[n]:o}function p(){return`${f()}${f()}-${f()}-${f("4")}-${f((Math.floor(10*Math.random())%4+8).toString(16))}-${f()}${f()}${f()}`}function f(e){let t=Math.floor(65535*Math.random()).toString(16);for(let e=4-t.length;e>0;e--)t=`0${t}`;return e=`${e}`.substring(0,4),!Number.isNaN(parseInt(e,16))&&e.length?e+t.substr(e.length):t}function h(e=""){const t=e.match(/[^.]+(?:\.com?(?:\.[a-z]{2})?|(?:\.[a-z]+))?$/i);if(t&&t.length)return t[0].replace(/:[0-9]+$/,"")}function g(e=""){if("string"!==typeof e)return 0;let t=-1;const n=function(){const e=new Array(256);for(let t=0;t<e.length;t++){let n=t;for(let e=0;e<8;e++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n>>>0}return e}();for(let o=0;o<e.length;o++)t=t>>>8^n[255&(t^e.charCodeAt(o))];return(-1^t)>>>0}function E(e,t,n){let o,r;for("string"===typeof t&&(t=t.split(".")),o=0,r=t.length-1;o<r;o++)"undefined"!==typeof e[t[o]]&&null!==e[t[o]]||(e[t[o]]={}),e=e[t[o]];return e[t[r]]=n,e}function _(e){const t=o.b$(e);return new s("utf-8").decode(t)}function m(e){const t=new r("utf-8").encode(e);return o.JQ(t)}function y(e){if(null!==e&&"object"===typeof e&&0!==Object.keys(e).length)return btoa(JSON.stringify(e))}function I(e){return("string"===typeof e||e instanceof String)&&/^([a-zA-Z\d]|-|_)+$/.test(e)}function R(e,t){return e.length<=t?e:`...${e.substring(e.length-t)}`}function w(e){return e.reduce(((e,[t,n])=>(e[t]=n,e)),{})}r.prototype.encode=function(e){return"undefined"===typeof Uint8Array?i(e):new Uint8Array(i(e))},s.prototype.decode=function(e){return function(e,t,n){let o="",r="";n=Math.min(e.length,n||1/0);for(let s=t=t||0;s<n;s++)e[s]<=127?(o+=a(r)+String.fromCharCode(e[s]),r=""):r+=`%${e[s].toString(16)}`;return o+a(r)}(e,0,e.length)}},742:(e,t)=>{"use strict";t.b$=function(e){var t,n,s=c(e),i=s[0],a=s[1],u=new r(function(e,t,n){return 3*(t+n)/4-n}(0,i,a)),l=0,d=a>0?i-4:i;for(n=0;n<d;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===a&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,u[l++]=255&t);1===a&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.JQ=function(e){for(var t,o=e.length,r=o%3,s=[],i=16383,a=0,c=o-r;a<c;a+=i)s.push(u(e,a,a+i>c?c:a+i));1===r?(t=e[o-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2===r&&(t=(e[o-2]<<8)+e[o-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return s.join("")};for(var n=[],o=[],r="undefined"!==typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,a=s.length;i<a;++i)n[i]=s[i],o[s.charCodeAt(i)]=i;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,o){for(var r,s,i=[],a=t;a<o;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(n[(s=r)>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return i.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},961:(e,t,n)=>{var o,r=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={};function r(e,t){if(!o[e]){o[e]={};for(var n=0;n<e.length;n++)o[e][e.charAt(n)]=n}return o[e][t]}var s={compressToBase64:function(e){if(null==e)return"";var n=s._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:s._decompress(e.length,32,(function(n){return r(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":s._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:s._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=s.compress(e),n=new Uint8Array(2*t.length),o=0,r=t.length;o<r;o++){var i=t.charCodeAt(o);n[2*o]=i>>>8,n[2*o+1]=i%256}return n},decompressFromUint8Array:function(t){if(null===t||void 0===t)return s.decompress(t);for(var n=new Array(t.length/2),o=0,r=n.length;o<r;o++)n[o]=256*t[2*o]+t[2*o+1];var i=[];return n.forEach((function(t){i.push(e(t))})),s.decompress(i.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":s._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),s._decompress(e.length,32,(function(t){return r(n,e.charAt(t))})))},compress:function(t){return s._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var o,r,s,i={},a={},c="",u="",l="",d=2,p=3,f=2,h=[],g=0,E=0;for(s=0;s<e.length;s+=1)if(c=e.charAt(s),Object.prototype.hasOwnProperty.call(i,c)||(i[c]=p++,a[c]=!0),u=l+c,Object.prototype.hasOwnProperty.call(i,u))l=u;else{if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(o=0;o<f;o++)g<<=1,E==t-1?(E=0,h.push(n(g)),g=0):E++;for(r=l.charCodeAt(0),o=0;o<8;o++)g=g<<1|1&r,E==t-1?(E=0,h.push(n(g)),g=0):E++,r>>=1}else{for(r=1,o=0;o<f;o++)g=g<<1|r,E==t-1?(E=0,h.push(n(g)),g=0):E++,r=0;for(r=l.charCodeAt(0),o=0;o<16;o++)g=g<<1|1&r,E==t-1?(E=0,h.push(n(g)),g=0):E++,r>>=1}0==--d&&(d=Math.pow(2,f),f++),delete a[l]}else for(r=i[l],o=0;o<f;o++)g=g<<1|1&r,E==t-1?(E=0,h.push(n(g)),g=0):E++,r>>=1;0==--d&&(d=Math.pow(2,f),f++),i[u]=p++,l=String(c)}if(""!==l){if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(o=0;o<f;o++)g<<=1,E==t-1?(E=0,h.push(n(g)),g=0):E++;for(r=l.charCodeAt(0),o=0;o<8;o++)g=g<<1|1&r,E==t-1?(E=0,h.push(n(g)),g=0):E++,r>>=1}else{for(r=1,o=0;o<f;o++)g=g<<1|r,E==t-1?(E=0,h.push(n(g)),g=0):E++,r=0;for(r=l.charCodeAt(0),o=0;o<16;o++)g=g<<1|1&r,E==t-1?(E=0,h.push(n(g)),g=0):E++,r>>=1}0==--d&&(d=Math.pow(2,f),f++),delete a[l]}else for(r=i[l],o=0;o<f;o++)g=g<<1|1&r,E==t-1?(E=0,h.push(n(g)),g=0):E++,r>>=1;0==--d&&(d=Math.pow(2,f),f++)}for(r=2,o=0;o<f;o++)g=g<<1|1&r,E==t-1?(E=0,h.push(n(g)),g=0):E++,r>>=1;for(;;){if(g<<=1,E==t-1){h.push(n(g));break}E++}return h.join("")},decompress:function(e){return null==e?"":""==e?null:s._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,o){var r,s,i,a,c,u,l,d=[],p=4,f=4,h=3,g="",E=[],_={val:o(0),position:n,index:1};for(r=0;r<3;r+=1)d[r]=r;for(i=0,c=Math.pow(2,2),u=1;u!=c;)a=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=o(_.index++)),i|=(a>0?1:0)*u,u<<=1;switch(i){case 0:for(i=0,c=Math.pow(2,8),u=1;u!=c;)a=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=o(_.index++)),i|=(a>0?1:0)*u,u<<=1;l=e(i);break;case 1:for(i=0,c=Math.pow(2,16),u=1;u!=c;)a=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=o(_.index++)),i|=(a>0?1:0)*u,u<<=1;l=e(i);break;case 2:return""}for(d[3]=l,s=l,E.push(l);;){if(_.index>t)return"";for(i=0,c=Math.pow(2,h),u=1;u!=c;)a=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=o(_.index++)),i|=(a>0?1:0)*u,u<<=1;switch(l=i){case 0:for(i=0,c=Math.pow(2,8),u=1;u!=c;)a=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=o(_.index++)),i|=(a>0?1:0)*u,u<<=1;d[f++]=e(i),l=f-1,p--;break;case 1:for(i=0,c=Math.pow(2,16),u=1;u!=c;)a=_.val&_.position,_.position>>=1,0==_.position&&(_.position=n,_.val=o(_.index++)),i|=(a>0?1:0)*u,u<<=1;d[f++]=e(i),l=f-1,p--;break;case 2:return E.join("")}if(0==p&&(p=Math.pow(2,h),h++),d[l])g=d[l];else{if(l!==f)return null;g=s+s.charAt(0)}E.push(g),d[f++]=s+g.charAt(0),s=g,0==--p&&(p=Math.pow(2,h),h++)}}};return s}();void 0===(o=function(){return r}.call(t,n,t,e))||(e.exports=o)},486:e=>{!function(t){"use strict";"function"===typeof bootstrap?bootstrap("promise",t):e.exports=t()}((function(){"use strict";var e=!1;try{throw new Error}catch(t){e=!!t.stack}var t,n=w(),o=function(){},r=function(){var e={task:void 0,next:null},t=e,n=!1,o=void 0,s=!1,i=[];function a(){for(var t,o;e.next;)t=(e=e.next).task,e.task=void 0,(o=e.domain)&&(e.domain=void 0,o.enter()),c(t,o);for(;i.length;)c(t=i.pop());n=!1}function c(e,t){try{e()}catch(e){if(s)throw t&&t.exit(),setTimeout(a,0),t&&t.enter(),e;setTimeout((function(){throw e}),0)}t&&t.exit()}if(r=function(e){t=t.next={task:e,domain:s&&process.domain,next:null},n||(n=!0,o())},"object"===typeof process&&"[object process]"===process.toString()&&process.nextTick)s=!0,o=function(){process.nextTick(a)};else if("function"===typeof setImmediate)o="undefined"!==typeof window?setImmediate.bind(window,a):function(){setImmediate(a)};else if("undefined"!==typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=function(){o=l,u.port1.onmessage=a,a()};var l=function(){u.port2.postMessage(0)};o=function(){setTimeout(a,0),l()}}else o=function(){setTimeout(a,0)};return r.runAfter=function(e){i.push(e),n||(n=!0,o())},r}(),s=Function.call;function i(e){return function(){return s.apply(e,arguments)}}var a,c=i(Array.prototype.slice),u=i(Array.prototype.reduce||function(e,t){var n=0,o=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=o)throw new TypeError}for(;n<o;n++)n in this&&(t=e(t,this[n],n));return t}),l=i(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),d=i(Array.prototype.map||function(e,t){var n=this,o=[];return u(n,(function(r,s,i){o.push(e.call(t,s,i,n))}),void 0),o}),p=Object.create||function(e){function t(){}return t.prototype=e,new t},f=Object.defineProperty||function(e,t,n){return e[t]=n.value,e},h=i(Object.prototype.hasOwnProperty),g=Object.keys||function(e){var t=[];for(var n in e)h(e,n)&&t.push(n);return t},E=i(Object.prototype.toString);function _(e){return"[object StopIteration]"===E(e)||e instanceof a}a="undefined"!==typeof ReturnValue?ReturnValue:function(e){this.value=e};function m(t,n){if(e&&n.stack&&"object"===typeof t&&null!==t&&t.stack){for(var o=[],r=n;r;r=r.source)r.stack&&(!t.__minimumStackCounter__||t.__minimumStackCounter__>r.stackCounter)&&(f(t,"__minimumStackCounter__",{value:r.stackCounter,configurable:!0}),o.unshift(r.stack));o.unshift(t.stack);var s=function(e){for(var t=e.split("\n"),n=[],o=0;o<t.length;++o){var r=t[o];R(r)||y(r)||!r||n.push(r)}return n.join("\n")}(o.join("\nFrom previous event:\n"));f(t,"stack",{value:s,configurable:!0})}}function y(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function I(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var o=/.*@(.+):(\d+)$/.exec(e);return o?[o[1],Number(o[2])]:void 0}function R(e){var o=I(e);if(!o)return!1;var r=o[0],s=o[1];return r===t&&s>=n&&s<=Y}function w(){if(e)try{throw new Error}catch(e){var n=e.stack.split("\n"),o=I(n[0].indexOf("@")>0?n[1]:n[2]);if(!o)return;return t=o[0],o[1]}}function O(e){return e instanceof C?e:P(e)?function(e){var t=A();return O.nextTick((function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}})),t.promise}(e):j(e)}O.resolve=O,O.nextTick=r,O.longStackSupport=!1;var T=1;function A(){var t,n=[],o=[],r=p(A.prototype),s=p(C.prototype);if(s.promiseDispatch=function(e,r,s){var i=c(arguments);n?(n.push(i),"when"===r&&s[1]&&o.push(s[1])):O.nextTick((function(){t.promiseDispatch.apply(t,i)}))},s.valueOf=function(){if(n)return s;var e=S(t);return b(e)&&(t=e),e},s.inspect=function(){return t?t.inspect():{state:"pending"}},O.longStackSupport&&e)try{throw new Error}catch(e){s.stack=e.stack.substring(e.stack.indexOf("\n")+1),s.stackCounter=T++}function i(r){t=r,O.longStackSupport&&e&&(s.source=r),u(n,(function(e,t){O.nextTick((function(){r.promiseDispatch.apply(r,t)}))}),void 0),n=void 0,o=void 0}return r.promise=s,r.resolve=function(e){t||i(O(e))},r.fulfill=function(e){t||i(j(e))},r.reject=function(e){t||i(M(e))},r.notify=function(e){t||u(o,(function(t,n){O.nextTick((function(){n(e)}))}),void 0)},r}function v(e){if("function"!==typeof e)throw new TypeError("resolver must be a function.");var t=A();try{e(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}return t.promise}function N(e){return v((function(t,n){for(var o=0,r=e.length;o<r;o++)O(e[o]).then(t,n)}))}function C(e,t,n){void 0===t&&(t=function(e){return M(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var o=p(C.prototype);if(o.promiseDispatch=function(n,r,s){var i;try{i=e[r]?e[r].apply(o,s):t.call(o,r,s)}catch(e){i=M(e)}n&&n(i)},o.inspect=n,n){var r=n();"rejected"===r.state&&(o.exception=r.reason),o.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?o:e.value}}return o}function k(e,t,n,o){return O(e).then(t,n,o)}function S(e){if(b(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function b(e){return e instanceof C}function P(e){return(t=e)===Object(t)&&"function"===typeof e.then;var t}"object"===typeof process&&process&&process.env&&process.env.Q_DEBUG&&(O.longStackSupport=!0),O.defer=A,A.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(c(arguments,1)):e.resolve(n)}},O.Promise=v,O.promise=v,v.race=N,v.all=W,v.reject=M,v.resolve=O,O.passByCopy=function(e){return e},C.prototype.passByCopy=function(){return this},O.join=function(e,t){return O(e).join(t)},C.prototype.join=function(e){return O([this,e]).spread((function(e,t){if(e===t)return e;throw new Error("Q can't join: not the same: "+e+" "+t)}))},O.race=N,C.prototype.race=function(){return this.then(O.race)},O.makePromise=C,C.prototype.toString=function(){return"[object Promise]"},C.prototype.then=function(e,t,n){var o=this,r=A(),s=!1;return O.nextTick((function(){o.promiseDispatch((function(t){s||(s=!0,r.resolve(function(t){try{return"function"===typeof e?e(t):t}catch(e){return M(e)}}(t)))}),"when",[function(e){s||(s=!0,r.resolve(function(e){if("function"===typeof t){m(e,o);try{return t(e)}catch(e){return M(e)}}return M(e)}(e)))}])})),o.promiseDispatch(void 0,"when",[void 0,function(e){var t,o=!1;try{t=function(e){return"function"===typeof n?n(e):e}(e)}catch(e){if(o=!0,!O.onerror)throw e;O.onerror(e)}o||r.notify(t)}]),r.promise},O.tap=function(e,t){return O(e).tap(t)},C.prototype.tap=function(e){return e=O(e),this.then((function(t){return e.fcall(t).thenResolve(t)}))},O.when=k,C.prototype.thenResolve=function(e){return this.then((function(){return e}))},O.thenResolve=function(e,t){return O(e).thenResolve(t)},C.prototype.thenReject=function(e){return this.then((function(){throw e}))},O.thenReject=function(e,t){return O(e).thenReject(t)},O.nearer=S,O.isPromise=b,O.isPromiseAlike=P,O.isPending=function(e){return b(e)&&"pending"===e.inspect().state},C.prototype.isPending=function(){return"pending"===this.inspect().state},O.isFulfilled=function(e){return!b(e)||"fulfilled"===e.inspect().state},C.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},O.isRejected=function(e){return b(e)&&"rejected"===e.inspect().state},C.prototype.isRejected=function(){return"rejected"===this.inspect().state};var L,D,U,G=[],x=[],$=[],F=!0;function V(){G.length=0,x.length=0,F||(F=!0)}function M(e){var t=C({when:function(t){return t&&function(e){if(F){var t=l(x,e);-1!==t&&("object"===typeof process&&"function"===typeof process.emit&&O.nextTick.runAfter((function(){var n=l($,e);-1!==n&&(process.emit("rejectionHandled",G[t],e),$.splice(n,1))})),x.splice(t,1),G.splice(t,1))}}(this),t?t(e):this}},(function(){return this}),(function(){return{state:"rejected",reason:e}}));return function(e,t){F&&("object"===typeof process&&"function"===typeof process.emit&&O.nextTick.runAfter((function(){-1!==l(x,e)&&(process.emit("unhandledRejection",t,e),$.push(e))})),x.push(e),t&&"undefined"!==typeof t.stack?G.push(t.stack):G.push("(no stack) "+t))}(t,e),t}function j(e){return C({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},delete:function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return g(e)}},void 0,(function(){return{state:"fulfilled",value:e}}))}function B(e,t,n){return O(e).spread(t,n)}function q(e,t,n){return O(e).dispatch(t,n)}function W(e){return k(e,(function(e){var t=0,n=A();return u(e,(function(o,r,s){var i;b(r)&&"fulfilled"===(i=r.inspect()).state?e[s]=i.value:(++t,k(r,(function(o){e[s]=o,0===--t&&n.resolve(e)}),n.reject,(function(e){n.notify({index:s,value:e})})))}),void 0),0===t&&n.resolve(e),n.promise}))}function K(e){if(0===e.length)return O.resolve();var t=O.defer(),n=0;return u(e,(function(o,r,s){var i=e[s];n++,k(i,(function(e){t.resolve(e)}),(function(e){if(0===--n){var o=e||new Error(""+e);o.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+o.message,t.reject(o)}}),(function(e){t.notify({index:s,value:e})}))}),void 0),t.promise}function H(e){return k(e,(function(e){return e=d(e,O),k(W(d(e,(function(e){return k(e,o,o)}))),(function(){return e}))}))}O.resetUnhandledRejections=V,O.getUnhandledReasons=function(){return G.slice()},O.stopUnhandledRejectionTracking=function(){V(),F=!1},V(),O.reject=M,O.fulfill=j,O.master=function(e){return C({isDef:function(){}},(function(t,n){return q(e,t,n)}),(function(){return O(e).inspect()}))},O.spread=B,C.prototype.spread=function(e,t){return this.all().then((function(t){return e.apply(void 0,t)}),t)},O.async=function(e){return function(){function t(e,t){var s;if("undefined"===typeof StopIteration){try{s=n[e](t)}catch(e){return M(e)}return s.done?O(s.value):k(s.value,o,r)}try{s=n[e](t)}catch(e){return _(e)?O(e.value):M(e)}return k(s,o,r)}var n=e.apply(this,arguments),o=t.bind(t,"next"),r=t.bind(t,"throw");return o()}},O.spawn=function(e){O.done(O.async(e)())},O.return=function(e){throw new a(e)},O.promised=function(e){return function(){return B([this,W(arguments)],(function(t,n){return e.apply(t,n)}))}},O.dispatch=q,C.prototype.dispatch=function(e,t){var n=this,o=A();return O.nextTick((function(){n.promiseDispatch(o.resolve,e,t)})),o.promise},O.get=function(e,t){return O(e).dispatch("get",[t])},C.prototype.get=function(e){return this.dispatch("get",[e])},O.set=function(e,t,n){return O(e).dispatch("set",[t,n])},C.prototype.set=function(e,t){return this.dispatch("set",[e,t])},O.del=O.delete=function(e,t){return O(e).dispatch("delete",[t])},C.prototype.del=C.prototype.delete=function(e){return this.dispatch("delete",[e])},O.mapply=O.post=function(e,t,n){return O(e).dispatch("post",[t,n])},C.prototype.mapply=C.prototype.post=function(e,t){return this.dispatch("post",[e,t])},O.send=O.mcall=O.invoke=function(e,t){return O(e).dispatch("post",[t,c(arguments,2)])},C.prototype.send=C.prototype.mcall=C.prototype.invoke=function(e){return this.dispatch("post",[e,c(arguments,1)])},O.fapply=function(e,t){return O(e).dispatch("apply",[void 0,t])},C.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},O.try=O.fcall=function(e){return O(e).dispatch("apply",[void 0,c(arguments,1)])},C.prototype.fcall=function(){return this.dispatch("apply",[void 0,c(arguments)])},O.fbind=function(e){var t=O(e),n=c(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(c(arguments))])}},C.prototype.fbind=function(){var e=this,t=c(arguments);return function(){return e.dispatch("apply",[this,t.concat(c(arguments))])}},O.keys=function(e){return O(e).dispatch("keys",[])},C.prototype.keys=function(){return this.dispatch("keys",[])},O.all=W,C.prototype.all=function(){return W(this)},O.any=K,C.prototype.any=function(){return K(this)},O.allResolved=(L=H,D="allResolved",U="allSettled",function(){return"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(D+" is deprecated, use "+U+" instead.",new Error("").stack),L.apply(L,arguments)}),C.prototype.allResolved=function(){return H(this)},O.allSettled=function(e){return O(e).allSettled()},C.prototype.allSettled=function(){return this.then((function(e){return W(d(e,(function(e){function t(){return e.inspect()}return(e=O(e)).then(t,t)})))}))},O.fail=O.catch=function(e,t){return O(e).then(void 0,t)},C.prototype.fail=C.prototype.catch=function(e){return this.then(void 0,e)},O.progress=function(e,t){return O(e).then(void 0,void 0,t)},C.prototype.progress=function(e){return this.then(void 0,void 0,e)},O.fin=O.finally=function(e,t){return O(e).finally(t)},C.prototype.fin=C.prototype.finally=function(e){if(!e||"function"!==typeof e.apply)throw new Error("Q can't apply finally callback");return e=O(e),this.then((function(t){return e.fcall().then((function(){return t}))}),(function(t){return e.fcall().then((function(){throw t}))}))},O.done=function(e,t,n,o){return O(e).done(t,n,o)},C.prototype.done=function(e,t,n){var o=function(e){O.nextTick((function(){if(m(e,r),!O.onerror)throw e;O.onerror(e)}))},r=e||t||n?this.then(e,t,n):this;"object"===typeof process&&process&&process.domain&&(o=process.domain.bind(o)),r.then(void 0,o)},O.timeout=function(e,t,n){return O(e).timeout(t,n)},C.prototype.timeout=function(e,t){var n=A(),o=setTimeout((function(){t&&"string"!==typeof t||((t=new Error(t||"Timed out after "+e+" ms")).code="ETIMEDOUT"),n.reject(t)}),e);return this.then((function(e){clearTimeout(o),n.resolve(e)}),(function(e){clearTimeout(o),n.reject(e)}),n.notify),n.promise},O.delay=function(e,t){return void 0===t&&(t=e,e=void 0),O(e).delay(t)},C.prototype.delay=function(e){return this.then((function(t){var n=A();return setTimeout((function(){n.resolve(t)}),e),n.promise}))},O.nfapply=function(e,t){return O(e).nfapply(t)},C.prototype.nfapply=function(e){var t=A(),n=c(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},O.nfcall=function(e){var t=c(arguments,1);return O(e).nfapply(t)},C.prototype.nfcall=function(){var e=c(arguments),t=A();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},O.nfbind=O.denodeify=function(e){if(void 0===e)throw new Error("Q can't wrap an undefined function");var t=c(arguments,1);return function(){var n=t.concat(c(arguments)),o=A();return n.push(o.makeNodeResolver()),O(e).fapply(n).fail(o.reject),o.promise}},C.prototype.nfbind=C.prototype.denodeify=function(){var e=c(arguments);return e.unshift(this),O.denodeify.apply(void 0,e)},O.nbind=function(e,t){var n=c(arguments,2);return function(){var o=n.concat(c(arguments)),r=A();function s(){return e.apply(t,arguments)}return o.push(r.makeNodeResolver()),O(s).fapply(o).fail(r.reject),r.promise}},C.prototype.nbind=function(){var e=c(arguments,0);return e.unshift(this),O.nbind.apply(void 0,e)},O.nmapply=O.npost=function(e,t,n){return O(e).npost(t,n)},C.prototype.nmapply=C.prototype.npost=function(e,t){var n=c(t||[]),o=A();return n.push(o.makeNodeResolver()),this.dispatch("post",[e,n]).fail(o.reject),o.promise},O.nsend=O.nmcall=O.ninvoke=function(e,t){var n=c(arguments,2),o=A();return n.push(o.makeNodeResolver()),O(e).dispatch("post",[t,n]).fail(o.reject),o.promise},C.prototype.nsend=C.prototype.nmcall=C.prototype.ninvoke=function(e){var t=c(arguments,1),n=A();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},O.nodeify=function(e,t){return O(e).nodeify(t)},C.prototype.nodeify=function(e){if(!e)return this;this.then((function(t){O.nextTick((function(){e(null,t)}))}),(function(t){O.nextTick((function(){e(t)}))}))},O.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var Y=w();return O}))}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(698);if(!!!window.Promise){const e="This browser is not supported by OneID because it does not honor Promise.";throw console.warn(e),new Error(e)}Object.fromEntries=Object.fromEntries||e.m8})(),(()=>{"use strict";const e={ERROR:5,WARN:4,INFO:3,DEBUG:2,LOG:1,OFF:100};let t=e.INFO,o=!1;const r={ERROR:"color:#FC0C1B;background-color:#FFEFEF",WARN:"color:#5B3A06;background-color:#FFFBE6",INFO:"color:#363F47;background-color:#e1e9ff",DEBUG:"color:#444;background-color:#eee",LOG:"color:#000;background-color:transparent",DEFAULT:"color:#000;background-color:transparent;font-weight:",ONEID:"color:#2887b4;background-color:transparent;font-weight:bold"};let s=c();function i(e){"number"===typeof e&&(t=e,s=c())}function a(n){return t>e[n]?(e="",t={})=>{}:o?function(e){const t=["%c[OneID]%c %c[%s]%c: ",r.ONEID,r.DEFAULT,r[e],e,r.DEFAULT];return window.console[e.toLowerCase()].bind(window.console,...t)}(n):function(e){return window.console[e.toLowerCase()].bind(window.console,"[OneID] [%s]: ",e)}(n)}function c(){return{error:a("ERROR"),warn:a("WARN"),info:a("INFO"),debug:a("DEBUG"),log:a("LOG")}}var u=n(698);const l=/^\.?www/,d=/^\./,p=/^(.+)@([a-z0-9-]+)(\.([a-z]+))+$/i,f=/^[a-z]{2}-[A-Z]{2}$/,h=/LOGIN_FLOW|RECOVERY_FLOW|CONTACT_CSR_FLOW/i,g=/-(DEV|VALID|VAL|QA|STAGE|PROD)$/,E=/^{?[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}}?$/,_="oid_loglevel",m="oid_feature";function y(e){return e&&document.cookie.replace(new RegExp(`(?:(?:^|.*;\\s*)${e}\\s*\\=\\s*([^;]*).*$)|^.*$`),"$1")||null}function I(e,t,n){if(document.cookie=`${encodeURIComponent(e)}=; expires=Thu, 01 Jan 1970 00:00:00 GMT${t?`; domain=${t}`:""}${n?`; path=${n}`:""}`,t&&!l.test(t)){const o=`www${/^\./.test(t)?"":"."}${t}`;s.debug(`also deleting cookie from ${o}`),I(e,o,n)}return!0}function R(e,t,n,o,r,i){let a,c=!1;if(l.test(n)&&(n=n.replace(l,""),c=!0),!e||/^(?:expires|max-age|path|domain|secure)$/i.test(e))return!1;if(a=`${e}=${t}`,r&&r instanceof Date&&(a+=`; expires=${r.toUTCString()}`),n&&(a+=`; domain=${n}`),o&&(a+=`; path=${o}`),i&&(a+="; secure"),document.cookie=a,c){const t=`www${/^\./.test(n)?"":"."}${n}`;s.debug(`calling delete on domain ${t}`),I(e,t,o||"")}return!0}const w={getCookieDomain:function(){const e=(0,u.KT)(window.location.hostname);return e?`.${e}`:".go.com"}};function O(){let e=window.location.hostname;return"localhost"===e?e:(e=e.replace(l,"").replace(d,""),`.${e}`)}const T={};function A(){return T}function v(e,t){Array.isArray(T[e])||(T[e]=[]),T[e].push(t)}function N(e,t){if(Array.isArray(T[e]))if("undefined"!==typeof t)for(let n=0;n<T[e].length;n++)T[e][n]===t&&T[e].splice(n,1);else T[e]=[]}function C(e,t){const n=A();Array.isArray(n[e])&&n[e].forEach((e=>{try{e(t)}catch(e){}}))}function k(e,t,n,o,r){return{status:e,response:t,statusText:o,headers:(s=n,(s||"").split("\n").map((e=>{const t=e.indexOf(":")||0;return[e.substr(0,t).trim(),e.substr(t+1).trim()]})).filter((e=>!!e[0])).reduce(((e,t)=>{const[n,o]=t;return{[n]:o,...e}}),{})),debug:{xhrFailureReason:r}};var s}function S(e,t,n,o,r){return new Promise((s=>{const i=new XMLHttpRequest;let a;i.open(e,t,!0),Object.keys(o||{}).forEach((e=>{const t=o[e];"undefined"!==typeof t&&i.setRequestHeader((e||"").toLowerCase(),t)})),i.onload=()=>{clearTimeout(a),s(function(e){const t=e.statusText||"",n="response"in e?e.response:e.responseText,o=e.getAllResponseHeaders();let{status:r}=e;return 0===r&&(r=n?200:0),k(r,n,o,t)}(i))},i.onabort=()=>{clearTimeout(a),s(k(-1,null,null,"","onabort"))},i.onerror=()=>{clearTimeout(a),s(k(-1,null,null,"","onerror"))},i.send("undefined"!==n?n:null),"number"===typeof r&&r>0&&(a=setTimeout((()=>{s(k(-1,null,null,"","setTimeout"))}),r))}))}function b(e){const t=e||{},{responseData:n,headers:o,status:r}=function(e){let t;try{t={...JSON.parse(e.response)}}catch(e){t={}}return{responseData:t,headers:e.headers||{},status:e.status||-1}}(e),s=n.data||n||null,i=n.error||null,a=-1===r,c=!a&&!!i,u=a||c,{debug:l}=t,d={status:r,data:s,error:i,headers:o,isError:u,isNetworkError:a,isAppError:c,debug:l};if(a)throw d;return d}function P(e){let{url:t}=e.request;const{method:n,body:o,headers:r,query:s,timeoutMs:i}=e.request,a=function(e={}){const t=[];return Object.keys(e).forEach((n=>{Array.isArray(e[n])?e[n].forEach((e=>{t.push([n,e])})):t.push([n,e[n]])})),t.map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}(s);return a&&(t+=`?${a}`),S(n,t,JSON.stringify(o),r,i).then((t=>Object.assign(e,{response:b(t)})))}function L(e,t){const n=this[e];if("function"!==typeof t)throw new Error("Mutator must be a function");-1===n.indexOf(t)&&n.push(t)}function D(e){return async t=>{const n=await e(t);return void 0===n?t:n}}function U(e,...t){const n=e(...t),o=this.request,r=this.response;let s=Promise.resolve({request:n,response:null});o.forEach((e=>{s=s.then(D(e))}));let i=s.then(P);return r.forEach((e=>{i=i.then(D(e))})),i.then((e=>e.response))}function G(e){const t={request:[],response:[]},n={};return Object.keys(e).forEach((o=>{n[o]=U.bind(t,e[o])})),n.addRequestMutator=L.bind(t,"request"),n.addResponseMutator=L.bind(t,"response"),n}let x;const $={langPref:"en-US",cssOverride:""};function F(){return x}const V="ac",M="api",j="idn",B="mtx",q="obo",W="s2",K="SWID",H="swid",Y="SWID_NT",z="token",Q="ts";function Z(e,t=!1){if(!e)return;const n=new Date(Date.now());n.setFullYear(n.getFullYear()+1),R(K,e,w.getCookieDomain(),"/",n),t&&R(Y,1,w.getCookieDomain(),"/",n)}function X(){return y(K)}const J="|",ee="=",te="#",ne="$",oe="-",re="string",se="date",ie="int",ae="boolean",ce="uuid",ue="json",le="string_raw",de={currentVersion:"5",versions:{4:[{key:"token.access_token",type:re},{key:"token.swid",type:ce},{key:"token.refresh_token",type:re},{key:"token.ttl",type:ie},{key:"token.refresh_ttl",type:ie},{key:"token.sso",type:ce},{key:"token.created",type:re},{key:"token.lastChecked",type:re},{key:"token.expires",type:re},{key:"token.refresh_expires",type:re},{key:"token.authenticator",type:re},{key:"token.blue_cookie",type:re},{key:"token.high_trust_expires_in",type:ie},{key:"token.initial_grant_in_chain_time",type:ie},{key:"token.id_token",type:re},{key:"token.sessionTransferKey",type:re}],5:[{key:"token",type:ue},{key:"id_token",type:le}]},vals:{4:" !\"'()+./?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{}~",5:" !\"'()+./?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{}~"}};function pe(e,t=de.currentVersion){const n=de.versions[t];if(!n)return;const o={token:(0,u.d9)(e.token),id_token:e.token.id_token};return delete o.token.id_token,delete o.token.scope,t+ee+function(e,t){return t.map((t=>function(e,t){let n;const o=de.vals[de.currentVersion];if(!e||!t||!t.key||!t.type)return;if(n=(0,u.U2)(e,t.key),"undefined"===typeof n||null===n)return;switch(t.type){case re:n=a(n);break;case se:n=c(n);break;case ie:n=s(n);break;case ae:n=d(n);break;case ce:n=l(n);break;case le:break;case ue:n=r(n);break;default:n=a(n)}return n;function r(e){return"object"!==typeof e?e:(0,u.h$)(JSON.stringify(e))}function s(e){let t="";if(e=parseInt(e,10),!Number.isNaN(e)){if(0===e)return o.charAt(0);for(e<0&&(t=oe,e*=-1);e>0;){const n=Math.floor(e/o.length),r=e-n*o.length;t+=o.charAt(r),e=n}return t}}function i(e,t){for(let n=0;n<t;n++)e+=o.charAt(0);return e}function a(e){let t,n="";if("undefined"!==typeof e&&null!==e)return`${e}`.split("").forEach((e=>{t=s(e.charCodeAt()-32),2===t.length?t=te+t:3===t.length&&(t=ne+t),n+=t})),n}function c(e){return"[object Date]"!==Object.prototype.toString.call(e)&&(e=new Date(e)),s(e.getTime())}function l(e){let t="",n="";const r=8;if("[object String]"!==Object.prototype.toString.call(e)||!E.test(e))return a(e);n+=/^{[^}]*}$/.test(e)?"1":"0",n+=/[A-F]/.test(e)?"1":"0",e=e.replace(/[{\-}]/g,"");const c=Math.floor(e.length/r);for(let n=0;n<c;n++){const o=e.substr(n*r,r),a=s(parseInt(o,16));t+=i(a,6-a.length)}return`${o.charAt(parseInt(n,2))}${t}`}function d(e){if("true"===e||"1"===e||!0===e||1===e)e=1;else{if("false"!==e&&"0"!==e&&!1!==e&&0!==e)return;e=0}return s(e)}}(e,t))).join(J)}(o,n)}function fe(e){if(!e)return;const t=e.substring(e.indexOf(ee)+1),n=e.substring(0,e.indexOf(ee)),o=de.versions[n];if(!o)return;const r=function(e,t,n){const o={};return e.split("|").forEach(((e,r)=>{(0,u.t8)(o,t[r].key,function(e,t,n){if(""===e)return null;const o=de.vals[n]||de.vals[de.currentVersion];switch(t.type){case re:e=i(e);break;case se:e=a(e);break;case ie:e=s(e);break;case ae:e=l(e);break;case ce:e=c(e);break;case le:break;case ue:e=r(e)}return e;function r(e){let t;try{const n=(0,u.tV)(e);t=JSON.parse(n)}catch(t){return e}return t}function s(e){let t=0,n=1,r=1;if(0!==(e=(e||"").split("")).length)return e[0]===oe&&(n=-1,e.splice(0,1)),e.forEach((e=>{t+=o.indexOf(e)*r,r*=o.length})),t*n}function i(e){let t=0;const n=e.length;let o,r="";if(0!==n){for(;t<n;){switch(e[t]){case te:o=2,t+=1;break;case ne:o=3,t+=1;break;default:o=1}r+=String.fromCharCode(s(e.substr(t,o))+32),t+=o}return r}}function a(e){if(e=s(e))return new Date(e)}function c(e){let t=parseInt(o.indexOf(e[0]),10),n=!1,r=!1,a="";const c=6,u=e;Number.isNaN(t)||(t=t.toString(2),t.length<2&&(t=`0${t}`),n="1"===t[0],r="1"===t[1],e=e.substring(1));const l=Math.floor(e.length/c);for(let t=0;t<l;t++){let n=s(e.substr(t*c,c)).toString(16);for(;n.length<8;)n=`0${n}`;a+=n}a=r?a.toUpperCase():a.toLowerCase();const d=`${(n?"{":"")+a.substring(0,8)}-${a.substring(8,12)}-${a.substring(12,16)}-${a.substring(16,20)}-${a.substring(20)}${n?"}":""}`;return E.test(d)?d:i(u)}function l(e){return 1===s(e)}}(e,t[r],n))})),o}(t,o,n),{token:s}=r;return s.id_token=r.id_token,s.isExpired=he(s),s}function he(e){return!(ge(e)&&Date.now()<e.exp)}function ge(e){return!!(e&&E.test(e.swid)&&"number"===typeof e.iat&&"string"===typeof e.access_token&&"number"===typeof e.exp&&(!e.refresh_token||"number"===typeof e.refresh_exp))}function Ee(e){const{exp:t,iat:n}=e,o=n+.8*(t-n);return Date.now()>o}function _e(e,t=3e4){const n=Object.keys(e.frames).reduce(((t,n)=>({...t,[n]:{name:n,window:e.frames[n].window,ports:{},origin:e.frames[n].origin}})),{}),o=[];return Object.keys(e.frames).forEach((t=>{const o=n[t];e.frames[t].channels.forEach((e=>{const r=n[e];if(!o.ports[e]){const n=new MessageChannel;o.ports[e]=n.port1,r.ports[t]=n.port2}}))})),Object.keys(n).forEach((e=>{var r;o.push(function(e,t){return new Promise(((n,o)=>{const r=Date.now(),s=setInterval(i,100);function i(){if(Date.now()-r>t)return c(),void o(new Error("Bootstrap timed out"));e.window.postMessage({event:"comm-bootstrap-start",targetName:e.name},e.origin)}function a(t){const o=t.data&&t.data.targetName;t.source===e.window&&o&&o===e.name&&t.data&&"comm-bootstrap-ack"===t.data.event&&(c(),n())}function c(){clearInterval(s),window.removeEventListener("message",a)}window.addEventListener("message",a),i()}))}(n[e],t).then((r=n[e],()=>{const e=Object.keys(r.ports);for(const t of e)r.window.postMessage({event:"comm-bootstrap-data",targetName:r.name,ports:e,port:t},r.origin,[r.ports[t]])})))})),Promise.all(o)}const me=["CALL","CALL_DONE","EVENT"];function ye(){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_=+";let t="";for(let n=0;n<24;n+=1){t+=e[Math.floor(Math.random()*e.length)]}return t}function Ie(e,t="DEFAULT"){const n=`PatchBay[${t}]`,o={},r={},i={};return Object.keys(e).forEach((t=>{e[t].onmessage=function(e){return t=>{if(!t||!t.data||"object"!==typeof t.data)return;const{data:n}=t;-1!==me.indexOf(n.type)&&(a(n.name,e,n),setTimeout(c.bind(null,n.name)))}}(t)})),{addHandler:function(e,t){if("function"!==typeof t)return;o[e]=t,c(e)},message:l,broadcast:function(t,n){const o={id:ye(),type:"EVENT",data:n,name:t};a(t,null,o),setTimeout(c.bind(null,t)),Object.keys(e).forEach((e=>{l(e,t,n)}))},call:function(e,t,o){return new Promise(((r,a)=>{const c=ye();s.debug(`${n}: call() invoked, target=${e}, name=${t}, id=${c}`),i[c]={resolve:r,reject:a},d(e,t,"CALL",o,c)}))}};function a(e,t,o){s.debug(`${n}: queueMessage(name=${e}, source=${t})`),r[e]||(r[e]=[]),r[e].push({source:t,data:o})}function c(e){if(s.debug(`${n}: flushQueue(name=${e})`),!Array.isArray(r[e])||r[e].length<1)return void s.debug(`${n}: Nothing in queue for '${e}', exit early`);const t=[];for(;r[e].length;){const{source:a,data:c}=r[e].pop(),l=c&&c.type||void 0,d=c&&c.id||void 0,p=`${n} - ${d||"NO_ID"}`;if(s.debug(`${p}: flushQueue loop, source=${a}, type=${l}`),"CALL"===l||"EVENT"===l){let n;if(!o[e]){s.debug(`${p}: flushQueue loop, NO HANDLER FOR name=${e}, deferring`),t.push({source:a,data:c});continue}s.debug(`${p}: flushQueue loop, about to call handler for name=${e}`),n=o[e](c&&c.data),s.debug(`${p}: flushQueue loop, obtained return value from name=${e}`),"CALL"===l&&(n&&n.then||(s.debug(`${p}: flushQueue loop, handler for name=${e} returned plain value`),n=Promise.resolve(n)),n.then((t=>{s.debug(`${p}: flushQueue, promise resolved for name=${e}, messaging back`),u(a,e,t,d,"resolved")})).catch((t=>{s.debug(`${p}: flushQueue, promise caught error for name=${e}, messaging back`),u(a,e,t,d,"rejected")})))}if("CALL_DONE"===l){const{status:e}=c;if(!i[d]){s.debug(`${p}: flushQueue loop, pendingCalls EMPTY FOR id=${d}!!!`);continue}"resolved"===e?(s.debug(`${p}: flushQueue loop, resolving promise for id=${d}`),i[d].resolve(c.data)):(s.debug(`${p}: flushQueue loop, rejecting promise for id=${d}`),i[d].reject(c.data)),delete i[d]}}for(const o of t)s.debug(`${n}: flushQueue, pushing deferred item back into queue, name=${e}`),r[e].push(o)}function u(e,t,n,o,r){d(e,t,"CALL_DONE",n,o,r)}function l(e,t,n){d(e,t,"EVENT",n)}function d(o,r,i,u,l,d){if(l=l||ye(),o===t)return s.debug(`${n}: Target is self...`),a(r,o,{id:l,type:i,name:r,data:u,status:d}),void setTimeout(c.bind(null,r));e[o]?e[o].postMessage({id:l,type:i,name:r,data:u,status:d}):s.debug(`${n}: Target '${o}' has not been registered!!!`)}}const Re=(we="outer",new Promise((e=>{const t={};window.addEventListener("message",(function n(o){o.data&&o.data.targetName===we&&("comm-bootstrap-start"===o.data.event&&o.source.postMessage({event:"comm-bootstrap-ack",targetName:we},"*"),"comm-bootstrap-data"===o.data.event&&(t[o.data.port]=o.ports[0],Object.keys(t).length>=o.data.ports.length&&(window.removeEventListener("message",n),e(t))))}))}))).then((e=>new Ie(e,"outer")));var we;const Oe=/^stg-|-stg\.|^stg\.cdn/,Te=/^qa-|-qa\.|:3001$|^qa\.cdn/,Ae=/^val-|-val\.|^val\.cdn/,ve="QA",Ne="STAGE",Ce="VAL";let ke="PROD",Se="";function be(){return ke}const Pe=216e5,Le=3e4,De=33,Ue=5,Ge=5e3,xe=2e4,$e=1e4,Fe=18e5;function Ve(){const e=F(),t=be();return Re.then((n=>n.call("responder","get.cookie",`${e&&e.clientId}-${t}.${z}`).then((e=>fe(e))).catch((e=>{const t=(0,u.U2)(e,"message");s.error(`Error in PatchBay call: ${t}`)}))))}var Me=n(961);const je=[];function Be(){if(!je.length)return"";let e=je.join("|");return e.length>600&&(e=e.slice(-600)),`0|${(0,Me.compressToBase64)(e)}`}function qe(e,t,n,o){let r;const i=`WorkflowManager[${e}]: `;return{runWorkflow:function(){s.debug(`${i}WorkflowManager.runWorkflow`),s.debug(`${i}name :`,e),r=n||Object.keys(t[0])[0],s.debug(`${i}step :`,r),c()}};function a(){const e=t.find((e=>Object.keys(e)[0]===r));return e&&e[r]}function c(){var t;s.debug(`${i}Executing step ${r}`),t=`${e.toUpperCase()}>${r}`,je.push(t);const n=a(),o=Object.keys(n.results);try{n.stepExecution(u,o)}catch(e){throw s.error(e),e}}function u(t){s.debug(`${i}Step complete, result ${t}`);const{results:n}=a()||{};if(r=n&&n[t],r)return c();s.debug(`${i}Workflow complete:`,e),o&&o(t)}}const We={ACTION_NAME:"action_name",ERROR_CATEGORY:"error_category",ERROR_CODES:"error_codes",FLOW:"flow",SUBFLOW:"subflow",INFO:"info",NEW_RELIC:"newRelic",PAGE_VIEW:"pageView",PROBLEM:"problem",STACK_TRACE:"stack_trace",TRANSACTION_ID:"transaction_id",API_FORCE_TOKEN_REFRESH:"api:force:tokenrefresh",API_GET_ACTIVITY_STATUS:"api:get:activitystatus",API_GET_GUEST_DATA:"api:get:guest",API_GET_GUEST_NEWSLETTERS:"api:get:guestnewsletters",API_GET_INLINE_NEWSLETTERS:"api:get:inlinenewsletters",API_GET_LICENSE_PLATE_DATA_BAG:"api:get:licenseplate:databag",API_GET_LOGGED_IN_STATUS:"api:get:loggedinstatus",API_GET_TRUST_STATE_STATUS:"api:get:truststatestatus",API_INIT:"api:init",API_LAUNCH_EMAILVERIFICATION:"api:launch:emailverification",API_LAUNCH_GUESTFLOW:"api:launch:guestflow",API_LAUNCH_IDENTITYFLOW:"api:launch:identityflow",API_LAUNCH_LICENSE_PLATE:"api:launch:licenseplate",API_LAUNCH_LOGIN:"api:launch:login",API_LAUNCH_OTP_ONDEMAND:"api:launch:otp:ondemand",API_LAUNCH_NEWSLETTERS:"api:launch:newsletters",API_LAUNCH_PROFILE:"api:launch:profile",API_LAUNCH_REAUTH:"api:launch:reauth",API_LAUNCH_REGISTRATION:"api:launch:registration",API_LAUNCH_SOCIAL_REGISTRATION:"api:launch:socialregistration",API_LOGOUT:"api:logout",API_REDEEM_LICENSE_PLATE_CODE:"api:redeem:licenseplate:code",API_REDEEM_SESSION_TRANSFER:"api:redeem:sessiontransfer",API_SET_DO_NOT_DISTURB:"api:set:donotdisturb",API_SET_INLINE_NEWSLETTERS:"api:set:inlinenewsletters",API_GET_PPC:"api:get:ppc",API_SET_PPC:"api:set:ppc",EVENT_CLOSE:"event:ui:close",EVENT_LOGOUT:"event:logout",EVENT_AGE_GATED:"event:agegated",EVENT_CREATE:"event:create",EVENT_ERROR:"event:error",EVENT_EXPIRED_SESSION:"event:expiredsession",EVENT_EXTERNAL_LINK_EPC:"event:externallink:epc",EVENT_EXTERNAL_LINK_MYACCOUNT:"event:externallink:myaccount",EVENT_INIT:"event:init",EVENT_LOGIN:"event:login",EVENT_LOGIN_OBO:"event:login:obo",EVENT_LOW_TRUST:"event:lowtrust",EVENT_OPT_IN:"event:optin",EVENT_REAUTH:"event:reauth",EVENT_REGISTRATION_OTP_CLOSE:"event:registration:otp:close",EVENT_REFRESH:"event:refresh",EVENT_UPDATE:"event:update",BU_EVENT_TO_ACTION_NAME:{"age-gated":"EVENT_AGE_GATED",close:"EVENT_CLOSE",create:"EVENT_CREATE",error:"EVENT_ERROR",init:"EVENT_INIT",login:"EVENT_LOGIN",logout:"EVENT_LOGOUT","low-trust":"EVENT_LOW_TRUST","opt-in":"EVENT_OPT_IN",reauth:"EVENT_REAUTH",refresh:"EVENT_REFRESH",update:"EVENT_UPDATE"},CLICK_PASSWORD_CHECK_RESET_PASSWORD:"click:passwordcheck:resetpassword",CLICK_PASSWORD_CHECK_SKIP_RESET:"click:passwordcheck:skipreset",CLICK_REGISTER_BUTTON_ON_LOGIN:"click:button:login:createaccount",CLICK_LOGIN_LINK_ON_REGISTER:"click:link:register:signin",LOG_APPLICATION_ERROR:"log:application:error",LOG_INVALID_DISPLAY_OPTION:"log:invalid:displayoption",LOG_INVALID_LEGAL_CONFIG:"log:invalid:legalconfig",LOG_INVALID_MARKETING_CONFIG:"log:invalid:marketingconfig",LOG_INVALID_OID_CONFIG:"log:invalid:oidconfig",LOG_MISSING_GUEST_DATA_ON_LOGOUT:"log:missing:guestdata:on:logout",LOG_MISSING_L10N:"log:missing:l10n",LOG_PATCHBAY_ERROR:"log:patchbay:error",LOG_PPU:"log:ppu",LOG_UNEXPECTED_ERROR:"log:unexpected:error",LOG_VERSION_MISMATCH:"log:version:mismatch",LOG_MOBILE_DATA_MISMATCH:"log:mobile:data:mismatch",SERVICE_CHECK_AUTHORIZATION:"service:checkauthorization",SERVICE_CREATE:"service:register",SERVICE_DATE_OF_BIRTH_VALIDATE:"service:dob:validate",SERVICE_DISPLAY_NAME_VALIDATE:"service:displayname:validate",SERVICE_DOWNLOAD_CONFIG:"service:download:config",SERVICE_EMAIL_VALIDATE:"service:email:validate",SERVICE_GUEST_FLOW:"service:guestflow",SERVICE_LICENSE_PLATE_PEEK:"service:licenseplate:peek",SERVICE_LICENSE_PLATE_REDEEM:"service:licenseplate:redeem",SERVICE_LOGIN:"service:login",SERVICE_LOGIN_RECOVERY:"service:login:recovery",SERVICE_LOGOUT:"service:logout",SERVICE_NEWSLETTERS_GALC:"service:newsletters:galc",SERVICE_NEWSLETTERS_GEOGATED:"service:newsletters:geogated",SERVICE_OTP_EMAIL_VERIFICATION:"service:otprequest:emailverification",SERVICE_OTP_EMAIL_VERIFICATION_REDEEM:"service:otpredeem:emailverification",SERVICE_OTP_EMAIL_VERIFICATION_RESEND:"service:otprequest:emailverification:resend",SERVICE_OTP_EMAIL_UPDATE:"service:otprequest:update:email",SERVICE_OTP_EMAIL_UPDATE_REDEEM:"service:otpredeem:update:email",SERVICE_OTP_EMAIL_UPDATE_RESEND:"service:otprequest:update:email:resend",SERVICE_OTP_LOGIN_RECOVERY_METHODS:"service:otplogin:recovery:methods",SERVICE_OTP_LOGIN_REDEEM:"service:otpredeem",SERVICE_OTP_LOGIN_REQUEST_OTP:"service:otprecovery",SERVICE_OTP_LOGIN_RESEND_EMAIL:"service:otplogin:resend:email",SERVICE_OTP_LOGIN_RESEND_SMS:"service:otplogin:resend:sms",SERVICE_OTP_LOGIN_RESET_PASSWORD:"service:otplogin:resetpassword",SERVICE_OTP_LOGIN_UPGRADE_NRT:"service:otplogin:upgradenrt",SERVICE_OTP_ONDEMAND_REQUEST:"service:otp:ondemand:request",SERVICE_OTP_ONDEMAND_REDEEM:"service:otp:ondemand:redeem",SERVICE_OTP_ONDEMAND_RECOVERY_METHODS:"service:otp.ondemand:recovery:methods",SERVICE_OTP_SECURITY_FLAG_LOGIN_REQUEST:"service:otprequest:securityflag:login",SERVICE_OTP_SECURITY_FLAG_LOGIN_REDEEM:"service:otpredeem:securityflag:login",SERVICE_OTP_SECURITY_FLAG_RECOVERY_REQUEST:"service:otprequest:securityflag:recovery",SERVICE_OTP_SECURITY_FLAG_RECOVERY_REDEEM:"service:otpredeem:securityflag:recovery",SERVICE_OTP_PASSWORD_UPDATE:"service:otprequest:update:password",SERVICE_OTP_PASSWORD_UPDATE_REDEEM:"service:otpredeem:update:password",SERVICE_OTP_PASSWORD_UPDATE_RESEND:"service:otprequest:update:password:resend",SERVICE_OTP_PHONE_VERIFICATION:"service:otprequest:phoneverification",SERVICE_OTP_PHONE_VERIFICATION_REDEEM:"service:otpredeem:phoneverification",SERVICE_OTP_PHONE_VERIFICATION_RESEND:"service:otprequest:phoneverification:resend",SERVICE_PASSWORD_VALIDATE:"service:password:validate",SERVICE_PPU_PROFILE:"service:update:ppu:profile",SERVICE_PPU_PASSWORD:"service:update:ppu:password",SERVICE_REAUTH:"service:reauth",SERVICE_RECAPTCHA_CHECKBOX:"service:recaptchacheckbox",SERVICE_REFRESH_GUEST:"service:refresh:guest",SERVICE_REFRESH_TOKEN:"service:refresh:token",SERVICE_REGISTRATION_AGEGATED:"service:registration:agegated",SERVICE_REGISTRATION_GALC:"service:registration:galc",SERVICE_REGISTRATION_PIL2_NOTIFY:"service:registration:pil2:notify",SERVICE_SESSION_TRANSFER_ACTIVATE:"service:sessiontransfer:activate",SERVICE_REGISTRATION_OTP_SENT:"service:registration:otp:sent",SERVICE_REGISTRATION_OTP_RESEND:"service:registration:otp:resend",SERVICE_UPDATE_GUEST:"service:update:guest",SERVICE_UPDATE_GUEST_CREDENTIALS:"service:update:guestcredentials",SERVICE_UPDATE_MARKETING:"service:update:marketing",SERVICE_USERNAME_VALIDATE:"service:username:validate",ID_TOKEN_MASK_LENGTH:6},Ke={action_name:"string",alternateConfig:"string",anon:"string",appid:"string",browser:"string - added by Log.go service",client_id:"string",connection_type:"string",context:"string",conversation_id:"string",error_category:"string",error_codes:"string",experience:"string",flow:"string",id_token:"string",info:"string",os:"string - added by Log.go service",platform:"string - added by Log.go service",problem:"string",process_time:"string",referrer_host:"string - added by Log.go service",reporting:"string",sdk_version:"string",source:"string",stack_trace:"string",subflow:"string",swid:"string",timestamp:"string",trace:"string",transaction_id:"string",user_agent:"string - added by Log.go service"};const He={appid:"DTCI-ONEID-UI"};let Ye;let ze=!1,Qe={},Ze={},Xe=!0;function Je(){const{clientId:e,langPref:t,debug:n}=F()||{};He.client_id=`${e}-${be()}`,He.locale=t,He.sdk_version=`web ${window.ONEID_WEB_SDK_VERSION}`,function(){const e="https://feet-qa.segds.engsvc.go.com/",t="https://feet-stg.segds.engsvc.go.com/",n="https://log.go.com/",o=be();Ye=o!==ve?o!==Ne?n:t:e}(),n&&n.experimentalFeatures&&(window.newRelicRequests=[],Xe=!1),ze=!0}function et(e={}){let t=(0,u.U2)(e,"optionalConfigs.reporting"),n=(0,u.U2)(e,"optionalConfigs.experience");t&&!st(t)&&(t=null),n&&!it(n)&&(s.warn("optionalConfigs.experience does not pass validation, values will be ignored"),n=null),Ze=t||n?{reporting:t,...n&&{experience:n}}:{},Ze.conversationId=(0,u.Vj)()}function tt(){let e={...Qe.reporting,...Ze.reporting};return st(e)||(s.warn("Combined reporting config does not pass validation, values will be ignored"),e={...Qe.reporting}),e.experience=Ze.experience||Qe.experience,e.conversationId=Ze.conversationId,{optionalConfigs:{reporting:e}}}function nt(e){ze||Je();const t=Date.now(),n={action_name:e};return{send:(e={})=>rt({...n,...e,process_time:Date.now()-t||1})}}const ot={[We.API_GET_ACTIVITY_STATUS]:2,[We.API_GET_GUEST_DATA]:2,[We.API_GET_GUEST_NEWSLETTERS]:2,[We.API_GET_LOGGED_IN_STATUS]:2,[We.API_GET_TRUST_STATE_STATUS]:2,[We.API_INIT]:2,[We.API_SET_DO_NOT_DISTURB]:2,[We.EVENT_CLOSE]:2,[We.EVENT_INIT]:2,[We.EVENT_LOW_TRUST]:2};function rt(e){s.debug("metricsNewRelic.sendNewRelicLog"),ze||Je(),e={...He,timestamp:Date.now(),...e};const{context:t,source:n,experience:o,conversationId:r,mid:i,...a}=(e.hasOwnProperty("reporting")?e.reporting:(0,u.U2)(tt(),"optionalConfigs.reporting"))||{};t&&(e.context=t),n&&(e.source=n),e.conversation_id=r||(0,u.Vj)(),o&&(e.experience=o),e.reporting=function(e,t){const n=[];Object.keys(t).forEach((e=>{n.push(`${e}(${t[e]})`)})),e&&n.push(`m-id(${e})`);return n.join(",")}(i,a),e.reporting||delete e.reporting,window.ONEID_WEB_SDK_MIGRATION&&(e[We.INFO]=e[We.INFO]?`${e[We.INFO]},isV4Migration(true)`:"isV4Migration(true)");const c=("string"===typeof e.action_name?e.action_name:"").toLowerCase(),l=ot[c];if(Xe&&"number"===typeof l&&Math.random()>l/100)return void s.debug("not sending log - coin toss was tails.");const d=Be();var p;!e.trace&&d.length&&(e.trace=d),p=e,Object.keys(p).forEach((e=>{Ke[e]&&(p[e]||!1===p[e])||(s.debug(`analyticsUtils.removeInvalidNewRelicField: Removing key/value pair ${e}/${p[e]}`),delete p[e])}));const f=X();e.swid=f,e.anon=/{.+}/.test(f)?"false":"true";const h=Ve().then((t=>{const n=(0,u.U2)(t,"id_token");n&&(e.id_token=(0,u.Cd)(n,We.ID_TOKEN_MASK_LENGTH));return new G({sendLog:e=>({method:"GET",url:`${Ye}log`,body:{},headers:{},query:e})}).sendLog(e)}));if(window.newRelicRequests){const e=new Promise((e=>{h.finally(e)})).then((()=>{window.newRelicRequests=window.newRelicRequests.filter((t=>t!==e)),s.debug(`Removed resolved promise from 'newRelicRequests', ${window.newRelicRequests.length} remain`)}));window.newRelicRequests=[...window.newRelicRequests,e],s.debug(`Added promise to 'newRelicRequests', ${window.newRelicRequests.length} are now currently outstanding`)}return h}function st(e){let t=0;for(const n in e){if(!/^[a-zA-Z0-9_]{1,30}$/.test(n))return!1;if(e[n].length>100)return!1;if(t+=1,t>10)return!1}return!0}function it(e){return!(!e||"string"!==typeof e)&&!!/^[A-Z0-9\.\-\_]+\.EXP$/g.test(e)}function at(e,t,n){let o=`payload-included(${!!t})`;(e&&"error"===e.toLowerCase()||!1)&&t&&(o=`${o},event-payload(${t})`),n&&(o=`${o},${n}`),rt({[We.ACTION_NAME]:We[We.BU_EVENT_TO_ACTION_NAME[e]]||e,[We.INFO]:o}),C(e,t)}function ct(){return Re.then((e=>e.call("inner","config.getSiteConfig"))).then(u._A)}const ut={getGuest:"getGuest",guestLogin:"guestLogin",guestMarketingOptIn:"guestMarketingOptIn",guestRecoveryMethods:"guestRecoveryMethods",guestRegister:"guestRegister",guestUpdateBySWID:"guestUpdateBySWID",loginWithRecoveryToken:"loginWithRecoveryToken",requestOTPCodePhoneVerification:"requestOTPCodePhoneVerification",notificationOTPRecovery:"notificationOTPRecovery",notificationOTPUpdateCredentials:"notificationOTPUpdateCredentials",loginWithRecoveryTokenForSecurityFlagResolutionUpdateCredentialsBySWID:"loginWithRecoveryToken",otpRedeem:"otpRedeem",otpRedeemEmailVerification:"otpRedeemEmailVerification",otpRedeemUpdateCredentials:"otpRedeemUpdateCredentials",otpChangePassword:"otpChangePassword",otpUpgradeNRT:"otpUpgradeNRT",parentNotification:"parentNotification",validateDateOfBirth:"validateDateOfBirth",validateEmail:"validateEmail",validatePassword:"validatePassword",validateDisplayName:"validateDisplayName",activateSessionTransfer:"activateSessionTransfer"};const lt="ACCOUNT_MAPPING_NOT_MAPPED_PROFILE_DELETE_REQUESTED",dt="AUTHORIZATION_ACCOUNT_LOCKED_OUT",pt="AUTHORIZATION_CREDENTIALS",ft="DISALLOWED_VALUE",ht="GUEST_GATED_AGEBAND",gt="GUEST_GATED_BOTH_EMAIL_VERIFICATION",Et="GUEST_GATED_EMAIL_VERIFICATION",_t="GUEST_GATED_LOCATION",mt="GUEST_GATED_PARENT_EMAIL_VERIFICATION",yt="INVALID_VALUE",It="MISSING_VALUE",Rt="PPU_LEGAL",wt="PPU_MARKETING",Ot="PROFILE_DISABLED",Tt="PROFILE_USER_BANNED",At="SYSTEM_UNAVAILABLE",vt="UNKNOWN_ERROR",Nt={isPPU:[wt,Rt],isMarketingPPU:[wt],isGating:[ht,"GUEST_GATED_UNKNOWN","GUEST_GATED_EMBARGOED","GUEST_GATED_EMAIL",_t,gt,Et,mt,dt,lt,Ot,"ACCOUNT_IS_CHILDED",Tt],isGeoGated:[_t],isVerifyEmailGated:[gt,Et,mt],isAgebandGated:[ht],isBanned:[Tt],isDisabled:[Ot,lt],isSecurityFlagged:["AUTHORIZATION_ACCOUNT_SECURITY_LOCKED_OUT"],isPil2:["AUTHORIZATION_PARENTAL_CONSENT_REQUIRED"],isAccountMappingError:["ACCOUNT_MAPPING_NOT_FOUND_BUT_EMAIL_FOUND","NRT_ACCOUNT",ft,"UNKNOWN_ACCOUNT_STATUS"],isActionableInputError:[It,yt,"INUSE_VALUE",ft],isAccountMappingNotFoundError:["ACCOUNT_MAPPING_NOT_FOUND","ACCOUNT_MAPPING_NOT_FOUND_AND_EMAIL_NOT_FOUND"],isAuthorizationError:[pt,"AUTHORIZATION_BAD_EXTERNAL_TOKEN","AUTHORIZATION_EXTERNAL_ID_MISMATCH"],isMarketingLongform:["MARKETING_LONG_FORM_ENABLED"],isEtagMismatch:["VALID_ETAG_REQUIRED"],isServiceError:["SERVICE_ERROR",vt,At],isLockedOut:[dt],isMase:["AUTHORIZATION_MASE_ERROR"],isOtpAuthError:["PHONE_NOT_FOUND","PHONE_NOT_VERIFIED","PHONE_VERIFICATION_NOT_ALLOWED"],isOtpCodeLockedOut:["DEVICE_LINK_LOCKOUT_REACHED"],isOtpRequired:["AUTHORIZATION_INVALID_NETWORK","ACCOUNT_INACTIVE_VERIFICATION_REQUIRED"],isInvalidLoginValue:["LOGIN_VALUE_INVALID","PROFILE_NOT_FOUND"],isInvalidOtpCode:["DEVICE_LINK_INVALID_OTP_CODE"],isInvalidAccessToken:["AUTHORIZATION_INVALID_OR_EXPIRED_TOKEN"],isInvalidRefreshToken:["AUTHORIZATION_INVALID_REFRESH_TOKEN"],isInvalidRecaptchaToken:["TOKEN_TOO_SHORT"],isInvalidSessionTransferKeyError:["INVALID_SESSION_TRANSFER_KEY"],isRateLimited:["RATE_LIMITED","RATE_LIMITED_API"]},Ct="ACTIONABLE_INPUT",kt="ADVISORY",St="FAILURE_BY_DESIGN",bt="PPU_ACTIONABLE_INPUT",Pt="CHILD",Lt="reduced",Dt="MACHINE_GENERATED";function Ut(e){const t=(0,u.U2)(e,"error.errors"),n=(0,u.U2)(e,"error.keyCategory");return!t||!n||!(0,u.U2)(t,"length")?[]:t.filter((function(e){return e.category===n}))}function Gt(e){const t={[It]:e=>e.inputName,[Rt]:e=>{var t;return((null===(t=e.data)||void 0===t?void 0:t.disclosures)||[]).map((e=>e.disclosureCode)).join()},[wt]:e=>{var t;return((null===(t=e.data)||void 0===t?void 0:t.entities)||[]).map((e=>e.code)).join()}};return e.map((e=>{const n=t[e.code]&&t[e.code](e);return n?`${e.code}:${n}`:e.code})).join(";")}function xt(e,t){return function(e,t,n=null){if(!Array.isArray(e))return[];Array.isArray(t)||(t=[t]);n&&!Array.isArray(n)&&(n=[n]);return(e||[]).filter((e=>-1!==t.indexOf(e.code)&&(!n||-1!==n.indexOf(e.inputName))))}(e,t)[0]}const $t={};function Ft(e,t){$t[e]=t}function Vt(e){return $t[e]}function Mt(e){delete $t[e]}function jt(){for(const e in $t)delete $t[e]}function Bt(e){if(e)return qt().then((t=>{const{s2CookieName:n,s2Domain:o}=t,r=w.getCookieDomain(),s=new Date(Date.now());s.setFullYear(s.getFullYear()+De),R(n,e,o,"/",s),y(n)!==e&&r&&R(n,e,r,"/",s)}))}function qt(){return ct().then((e=>{const{clientInfo:t={}}=e,n=t["s2-domain"]||window.location.hostname,o=t["s2-namespace"];return{s2CookieName:o?`${o}_${W}`:W,s2Domain:n,s2Namespace:o}}))}let Wt={language:null,featureFlags:["no-password-reuse"],endpoint:null,clientId:null};const Kt=new G({checkAuthorization:function({accessToken:e,swid:t}){const n={method:"",url:"",body:{},headers:{},query:{}},o=`/guest/check-authorization/${t}`;return n.headers.authorization=`BEARER ${e}`,{...n,method:"GET",url:o,eventName:We.SERVICE_CHECK_AUTHORIZATION}},getGuest:function({accessToken:e,swid:t}){const n={method:"",url:"",body:{},headers:{},query:{}},o=`/guest/${t}`;return n.query.feature="always-get-entitlements",n.query.expand=["profile","displayname","linkedaccounts","marketing","entitlements","s2"],n.headers.authorization=`BEARER ${e}`,{...n,method:"GET",url:o,eventName:We.SERVICE_REFRESH_GUEST,storeResponseKey:ut.getGuest}},guestFlow:function(e,t=We.SERVICE_GUEST_FLOW){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/guest-flow",body:{email:e},eventName:t}},guestLogin:function({deviceId:e,loginValue:t,password:n,recaptchaToken:o}){const r={method:"",url:"",body:{},headers:{},query:{}};e&&(r.headers["device-id"]=e);o&&(r.headers["g-recaptcha-token"]=o);return{...r,method:"POST",url:"/guest/login",body:{loginValue:t,password:n},eventName:We.SERVICE_LOGIN,storeResponseKey:ut.guestLogin}},guestReauth:function({deviceId:e,loginValue:t,password:n,recaptchaToken:o,accessToken:r}){const s={method:"",url:"",body:{},headers:{},query:{}};s.headers.authorization=`BEARER ${r}`,e&&(s.headers["device-id"]=e);o&&(s.headers["g-recaptcha-token"]=o);return{...s,method:"POST",url:"/guest/reauth",body:{loginValue:t,password:n},eventName:We.SERVICE_REAUTH,storeResponseKey:ut.guestLogin}},guestMarketingOptIn:function(e={}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/marketing",body:e,eventName:We.SERVICE_UPDATE_MARKETING,storeResponseKey:ut.guestMarketingOptIn}},guestRecoveryMethods:function({loginValue:e,eventName:t=We.SERVICE_OTP_LOGIN_RECOVERY_METHODS}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/guest/recovery-methods",body:{loginValue:e},eventName:t,storeResponseKey:ut.guestRecoveryMethods}},guestRegister:function(e={}){const{password:t,profile:{username:n}={}}=e,o={autogeneratePassword:!t,autogenerateUsername:!n},r={method:"",url:"",body:{},headers:{},query:{}};e.recaptchaToken&&(r.headers["g-recaptcha-token"]=e.recaptchaToken);return{...r,method:"POST",url:"/guest/register",body:e,query:o,eventName:We.SERVICE_CREATE,storeResponseKey:ut.guestRegister}},guestUpdateBySWID:function({guest:e,swid:t,accessToken:n,eventName:o}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${n}`},query:{feature:"no-password-reuse"},method:"POST",url:`/guest/${t}`,body:(0,u.d9)(e),eventName:o,storeResponseKey:ut.guestUpdateBySWID}},guestValidate:function({body:e,eventName:t,storeResponseKey:n}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/validate",body:e,eventName:t,storeResponseKey:n}},licensePlatePeek:function(e){return{method:"",url:"",body:{},headers:{},query:{},method:"GET",url:`/license-plate/code/${e}`,eventName:We.SERVICE_LICENSE_PLATE_PEEK}},licensePlateRedeem:function(e,t){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:`/license-plate/code/${e}/activate`,body:{refreshToken:t},eventName:We.SERVICE_LICENSE_PLATE_REDEEM}},loginWithRecoveryToken:function({swid:e,recoveryToken:t,deviceId:n}){const o={method:"",url:"",body:{},headers:{},query:{}};n&&(o.headers["device-id"]=n);return o.query.expand=["profile","displayname","linkedaccounts","marketing","entitlements","s2"],{...o,method:"POST",url:"/guest/login/recoveryToken",body:{swid:e,recoveryToken:t},eventName:We.SERVICE_LOGIN_RECOVERY,storeResponseKey:ut.loginWithRecoveryToken}},logout:function({swid:e,tokenAndClientIds:t=[]}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:`/guest/${e}/logout`,body:{tokenAndClientIds:t},eventName:We.SERVICE_LOGOUT}},notificationOTPEmailVerification:function({accessToken:e,eventName:t}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/notification/otp/email-verification",headers:{authorization:`BEARER ${e}`},eventName:t}},notificationOTPRecovery:function({recoveryPayload:e,eventName:t,intent:n}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/notification/otp/recovery",body:e,query:{intent:n},eventName:t,storeResponseKey:ut.notificationOTPRecovery}},notificationOTPUpdateCredentials:function({accessToken:e,eventName:t,body:n=null}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${e}`},method:"POST",url:"/notification/otp/update-credentials",eventName:t,body:n,storeResponseKey:ut.notificationOTPUpdateCredentials}},notificationOTPRegistration:function({email:e,accessToken:t,eventName:n=We.SERVICE_REGISTRATION_OTP_SENT}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${t}`},method:"POST",url:"/notification/otp/registration",body:{email:e},eventName:n}},oboLogin:function({oboToken:e,swid:t}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/guest/login/on-behalf-of",body:{swid:t},headers:{Authorization:`BEARER ${e}`}}},otpRedeem:function({otpCode:e,sessionIds:t,eventName:n,assessmentId:o}){const r={passcode:e,sessionIds:t};o&&(r.assessmentId=o);return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/otp/redeem",body:r,eventName:n,storeResponseKey:ut.otpRedeem}},otpRedeemEmailVerification:function({accessToken:e,otpCode:t,sessionIds:n}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${e}`},method:"POST",url:"/otp/verify-email",body:{passcode:t,sessionIds:n},eventName:We.SERVICE_OTP_EMAIL_VERIFICATION_REDEEM,storeResponseKey:ut.otpRedeemEmailVerification}},otpRedeemUpdateCredentials:function({accessToken:e,otpCode:t,sessionIds:n,eventName:o}){const r={passcode:t,sessionIds:n};return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${e}`},method:"POST",url:"/otp/redeem-update-credentials",body:r,eventName:o,storeResponseKey:ut.otpRedeemUpdateCredentials}},otpChangeEmail:function({recoveryToken:e,swid:t,newEmail:n}){const o=`/guest/${t}/update-credentials`;return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:o,headers:{authorization:`BEARER ${e}`},body:{email:n},eventName:We.SERVICE_UPDATE_GUEST_CREDENTIALS}},otpChangePassword:function({recaptchaToken:e,recoveryToken:t,swid:n,newPassword:o,loginValue:r}){const s=`/clickback-token/change-password/${n}`;return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:s,headers:{"g-recaptcha-token":e,authorization:`BEARER ${t}`},body:{newPassword:o,loginValue:r},eventName:We.SERVICE_OTP_LOGIN_RESET_PASSWORD,storeResponseKey:ut.otpChangePassword}},updateCredentialsBySWID:function({recoveryToken:e,swid:t,newPassword:n,eventName:o}){const r=`/guest/${t}/update-credentials`;return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:r,storeResponseKey:ut.loginWithRecoveryTokenForSecurityFlagResolutionUpdateCredentialsBySWID,headers:{authorization:`BEARER ${e}`},body:{password:n},eventName:o}},otpUpgradeNRT:function({recaptchaToken:e,recoveryToken:t,swid:n,password:o,username:r}){const s=`/clickback-token/upgrade-nrt/${n}`;return{method:"",url:"",body:{},headers:{},query:{},method:"PUT",url:s,headers:{"g-recaptcha-token":e,authorization:`BEARER ${t}`},body:{password:o,username:r},eventName:We.SERVICE_OTP_LOGIN_UPGRADE_NRT,storeResponseKey:ut.otpUpgradeNRT}},refreshAuthorization:function(e){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/guest/refresh-auth",body:{refreshToken:e},eventName:We.SERVICE_REFRESH_TOKEN}},redeemOTPCodePhoneVerification:function({otpCode:e,sessionIds:t,swid:n,accessToken:o,eventName:r}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${o}`},method:"POST",url:`/guest/${n}/verify/otp`,body:{passcode:e,sessionIds:t},eventName:r,storeResponseKey:ut.redeemOTPCodePhoneVerification}},requestOTPCodePhoneVerification:function({phoneGuid:e,accessToken:t,eventName:n}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${t}`},method:"POST",url:"/notification/otp/verification",body:{phoneGuid:e},eventName:n,storeResponseKey:ut.requestOTPCodePhoneVerification}},sendParentNotification:function({swid:e,accessToken:t}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:`/notification/parental-approval/${e}`,headers:{authorization:`BEARER ${t}`},eventName:We.EVENT_REGISTRATION_PIL2_NOTIFY,storeResponseKey:ut.parentNotification}},deleteAccount:function({guest:e,swid:t,accessToken:n,eventName:o}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${n}`},method:"DELETE",url:`/guest/${t}`,body:{},eventName:o,storeResponseKey:ut.deleteAccount}},activateSessionTransfer:function({accessToken:e,refreshToken:t,sessionTransferKey:n}){return{method:"",url:"",body:{},headers:{},query:{},headers:{authorization:`BEARER ${e}`,"Content-Type":"application/json"},method:"POST",url:"/session/transfer/activate",body:{refreshToken:t,sessionTransferKey:n},storeResponseKey:ut.activateSessionTransfer,eventName:We.SERVICE_SESSION_TRANSFER_ACTIVATE}},authenticateViaSessionTransferKey:function({sessionTransferKey:e,eventName:t=We.API_REDEEM_SESSION_TRANSFER}){return{method:"",url:"",body:{},headers:{},query:{},method:"POST",url:"/session/transfer/redeem",body:{sessionTransferKey:e},eventName:t}}}),Ht=Kt;function Yt(e){e.response.parsedErrors=function(e){if(!e)return null;const t=Ut(e),n=(0,u.U2)(e,"error.keyCategory");let o={};switch(Object.keys(Nt).forEach((e=>{xt(t,Nt[e])&&(o[e]=!0)})),n){case bt:o.isPPU=!0;break;case kt:o.isAdvisoryError=!0;break;case Ct:o.isActionableInputError=!0;const e=t.reduce(((e,t)=>{if(!t||!t.inputName)return e;const n=`${t.inputName}`,o=n.startsWith("profile.addresses"),r=(0,u.U2)(t,"data.type");if(o&&r){const o=`addresses.${r}.${n.replace(/.*\./,"")}`;return Object.assign(e,{[o]:t.code})}if(!o){const o=n.replace(/.*\./,"");return Object.assign(e,{[o]:t.code})}return e}),{});o.clientErrors=Object.keys(e).length?e:null,o.clientErrorsRawInputNames=t.filter((e=>e.inputName)).map((e=>e.inputName))}const r=(0,u.U2)(xt(t,pt),"data")||{};o.isAuthorizationError&&r.passwordOrigin===Dt&&(o.isLoginSetPassword=!0);const s=e.isValid&&!e.isValid(),i=500===e.status;return(s||i||n===At)&&(o.isServiceError=!0),t.forEach((e=>{e.code===yt&&"profile.region"===e.inputName&&(o.isInvalidRegionError=!0)})),0===Object.keys(o).length&&(o=null),o&&!o.clientErrors&&(o.clientErrors=null,o.clientErrorsRawInputNames=null),o}(e.response),(0,u.U2)(e.response.parsedErrors,"isPPU")&&Ft("ppuErrors",(0,u.U2)(e.response,"error.errors"))}let zt;Ht.addRequestMutator((e=>{e.request.headers={...e.request.headers,"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache",Expires:"-1"};const t=(0,u.U2)(F(),"debug.geoIP");t&&(e.request.headers["x-forwarded-for"]=t)})),Ht.addRequestMutator((e=>{e.request.query.langPref=Wt.language})),Ht.addRequestMutator((e=>{e.request.query.feature=Wt.featureFlags})),Ht.addRequestMutator((e=>{e.request.url=`${Wt.endpoint}/client/${Wt.clientId}${e.request.url}`})),Ht.addRequestMutator((e=>{zt=(0,u.Vj)();const t=Vt("workflowOptions"),n=(0,u.U2)(t,"options.optionalConfigs.reporting.conversationId")||(0,u.Vj)();e.request.headers={...e.request.headers,"conversation-id":n,"correlation-id":zt}})),Ht.addRequestMutator((e=>{if(!e.request.headers.authorization)return new Promise((t=>{Re.then((n=>{n.call("responder","get.cookie",`${Wt.clientId}.${M}`).then((n=>{n&&(e.request.headers.authorization=`APIKEY ${n}`),t()})).catch((()=>t()))}))}))})),Ht.addRequestMutator((e=>{const t=Vt("workflowOptions");if(t){const n=(0,u.U2)(t,"options.optionalConfigs.reporting");e.request.headers={...e.request.headers,"oneid-reporting":(0,u.uP)(n)}}})),Ht.addRequestMutator((e=>{e.newRelicLog=nt(e.request.eventName||"missing_action_name")})),Ht.addResponseMutator((e=>{const{errorCodes:t,keyCategory:n,statusCode:o}=function(e){const t=(0,u.U2)(e,"error.keyCategory")||"";return{errorCodes:((0,u.U2)(e,"error.errors")||[]).map((e=>{let t=e.code;e.inputName&&(t+=`:${e.inputName}`);const n=(0,u.U2)(e,"data.disclosures");return n&&n.forEach((e=>{t+=`:${e.disclosureCode}`})),t}))||[],keyCategory:t,statusCode:(0,u.U2)(e,"status")||null}}(e.response),r=Vt("logoutType"),i={[We.ERROR_CATEGORY]:n,[We.ERROR_CODES]:t.join(","),[We.TRANSACTION_ID]:zt};r&&(i[We.INFO]=`logoutType(${r})`,Mt("logoutType")),!o||o>=400&&o<500||o>=200&&o<300||(i[We.PROBLEM]=!0),s.debug("sending log : ",JSON.stringify(i,null,2)),e.newRelicLog.send(i),e.request.storeResponseKey&&Ft(e.request.storeResponseKey,e.response)})),Ht.addResponseMutator((e=>{const t=e.response&&e.response.headers["api-key"];if(t){const e=new Date;e.setDate(e.getDate()+1),Re.then((n=>n.message("responder","set.cookie",{key:`${Wt.clientId}.${M}`,value:t,expires:e})))}})),Ht.addResponseMutator((e=>{const t=(0,u.U2)(e.response,"data.s2");t&&Bt(t)})),Ht.addResponseMutator((e=>{Yt(e)}));const Qt="Already initialized",Zt="Configuration options have already been set",Xt="Could not initialize cross frame communication",Jt="`DisneyID` global object is soon to be deprecated. Use `OneID` instead.",en="OneID app timed out",tn="Invalid argument",nn="INVALID_PAIRING_CODE",on="MISSING_PAIRING_CODE",rn="clientId not provided",sn="No configuration options provided",an="NO_DATA",cn="Could not read guest profile data",un="responderPage not provided",ln="Could not get site config",dn="NO_VALID_CAMPAIGN",pn="Not initialized",fn="PROFILE_UPDATE_INVALID",hn="Session already established",gn="Session not established",En="FAILURE_BY_DESIGN",_n="UNKNOWN_ERROR";function mn(e){return new Promise(((t,n)=>{Kt.licensePlatePeek(e).then((e=>{if((0,u.U2)(e,"parsedErrors.isActionableInputError"))return n({errorCodes:nn});t(e)})).catch((()=>n({errorCodes:_n})))}))}function yn(){const{clientId:e,langPref:t,cssOverride:n,debug:o={}}=F(),{country:r,geoIP:s,iOSAutomation:i,testProfileFlag:a,disableFocusLock:c,showL10nKeys:u}=o,l=window.ONEID_WEB_SDK_MIGRATION?"bundleMigration":"bundle",d=y(_)||"INFO",p=y(m),f=Se.replace("https://ui-qa.registerdisney","https://uiv4-qa.registerdisney"),h=new URL(f);return h.pathname=`${h.pathname}/${l}/web/${e}/${t}`,n&&h.searchParams.append("cssOverride",n),r&&h.searchParams.append("countryCode",r),d&&h.searchParams.append("logLevel",d),i&&h.searchParams.append("iOSAutomation","true"),a&&h.searchParams.append("testProfileFlag","Y"),s&&h.searchParams.append("geoIP",s),p&&h.searchParams.append("featureFlags",p),c&&h.searchParams.append("disableFocusLock","true"),u&&h.searchParams.append("showL10nKeys","true"),h.href}function In(){const{clientId:e,responderPage:t}=F(),n=be(),o=new URL(t);return o.searchParams.append("clientId",e),o.searchParams.append("environment",n),o.href}const Rn=function(){const e=document.querySelector("html"),t=document.createElement("style");let n;return{showLightbox:function(){e&&e.classList.add("oneid-lightbox-open"),n.style.display="block",n.classList.add("state-active"),n.querySelector("#oneid-iframe").focus()},hideLightbox:function(){e&&e.classList.remove("oneid-lightbox-open"),n.style.display="none",n.classList.remove("state-active")},createInner:function(){const e=/(ipad|iphone|ipod)/gi.test(navigator.userAgent);t.setAttribute("id","oneid-style"),t.setAttribute("type","text/css"),t.innerHTML=`\n    div#oneid-wrapper {\n      position: ${e?"absolute":"fixed"};\n      display: none;\n      opacity: 0;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n    }\n    div#oneid-wrapper.state-active {\n      z-index: 9999999;\n      opacity: 1;\n      transition: opacity 300ms;\n      -webkit-transition: opacity 300ms;\n    }\n    iframe#oneid-iframe {\n      width: 100%;\n      height: 100%;\n    }\n\n    html.oneid-lightbox-open {\n      overflow: hidden;\n      ${e?"height: 100%;":""}       \n    }\n\n    html.oneid-lightbox-open body {\n      overflow: hidden;\n      ${e?"height: 100%;":""}\n    }\n    `;const r=o({name:"oneid-iframe",title:"Account",documentURL:yn()});return n=document.createElement("div"),n.setAttribute("id","oneid-wrapper"),n.appendChild(r),wn().then((()=>{document.head.appendChild(t),document.body.appendChild(n)})),r},createResponder:function(){const e=o({name:"oneid-secure-responder",documentURL:In()});return e.style.display="none",wn().then((()=>{document.body.appendChild(e)})),e}};function o({name:e,title:t="",documentURL:n}){const o=document.createElement("iframe");return o.setAttribute("id",e),o.setAttribute("name",e),o.setAttribute("frameborder","0"),o.setAttribute("title",t),o.setAttribute("src",n),o}}();function wn(){return new Promise((e=>{const{readyState:t}=document;if("complete"===t||"loaded"===t||"interactive"===t)return e();document.addEventListener("DOMContentLoaded",(()=>e()),{once:!0})}))}function On(){return vn(Le)}function Tn(e,t){if(!t)return!1;const n=e.newsletters;s.debug("newslettersConfig :",n);for(const e of Object.values(n))if(Object.keys(e||{}).includes(t))return!0;return!1}function An(){return ct().then((e=>e?Promise.resolve():Promise.reject({errorCodes:ln})))}function vn(e=3e4,t=en){let n;const o=Object.assign(new Promise(((r,s)=>{n=setTimeout((()=>{s({errorCodes:t}),o.wasRejected=!0}),e)})),{cancel:()=>(clearTimeout(n),this)});return o}function Nn(e,t={}){const n=(0,u.U2)(e,"optionalConfigs.displayOptions.cssContext"),o=(0,u.U2)(e,"optionalConfigs.displayOptions.darkMode"),r=(0,u.U2)(e,"optionalConfigs.displayOptions.suppressCreateAccountOpt");if(void 0!==n)if((0,u.kH)(n))t.displayOptions={...t.displayOptions,cssContext:n};else{nt(We.LOG_INVALID_DISPLAY_OPTION).send({[We.ERROR_CATEGORY]:En,[We.ERROR_CODES]:"cssContext",[We.INFO]:`cssContext(${n})`})}if(void 0!==o)if("boolean"===typeof o)t.displayOptions={...t.displayOptions,darkMode:o};else{nt(We.LOG_INVALID_DISPLAY_OPTION).send({[We.ERROR_CATEGORY]:En,[We.ERROR_CODES]:"darkMode",[We.INFO]:`darkMode(${o})`})}return void 0!==r&&"boolean"===typeof r&&(t.displayOptions={...t.displayOptions,suppressCreateAccountOpt:r}),t.options=tt(),t.allowSkip=!!(0,u.U2)(e,"allowSkip"),t}function Cn(){return y(q)}function kn(){return s.debug("[OBO Cookie] - delete obo cookie",q,O()),I(q,O(),"/")}var Sn=n(0),bn=n.n(Sn);const Pn={ADULT:"X",TEEN:"Y",CHILD:"Z"};function Ln(e){if(!e)return Promise.resolve();const{clientId:t}=F(),n=`${t}-${be()}.${j}`;return Re.then((t=>t.call("responder","set.cookie",{key:n,value:e,expires:0,secure:!0}).catch((e=>{const t=(0,u.U2)(e,"message");s.error(`Error in PatchBay call: ${t}`),rt({[We.ACTION_NAME]:We.LOG_PATCHBAY_ERROR,[We.INFO]:"location(outer-lib-cookies-identity)",[We.STACK_TRACE]:t})}))))}const Dn="00";function Un(){const{clientId:e}=F(),t=be();try{localStorage.removeItem(`${e}-${t}.guest`)}catch(e){}}function Gn(){return Vt("tokenData")?xn():Ve().then((e=>{if(e&&!he(e))return Ft("tokenData",e),xn()}))}function xn(){const{clientId:e}=F(),t=be();return function(){const{clientId:e}=F(),t=`${e}-${be()}.${j}`;return Re.then((e=>e.call("responder","get.cookie",t).catch((e=>{const t=(0,u.U2)(e,"message");s.error(`Error in PatchBay call: ${t}`),rt({[We.ACTION_NAME]:We.LOG_PATCHBAY_ERROR,[We.INFO]:"location(outer-lib-cookies-identity)",[We.STACK_TRACE]:t})}))))}().then((n=>{const o=Vt("tokenData"),r=(0,u.U2)(o,"access_token");if(!r||!n)return;const s=function(e,t,n,o){let r=null;try{r=localStorage.getItem(`${n}-${o}.guest`)}catch(e){}return function(e,t,n){let o=null;try{o=JSON.parse(bn().decrypt(e.substring(Dn.length)+t,n))}catch(e){}return o}(`${e}`,t,r)}(n,r,e,t);if(!s)return $n();return(0,u.t8)(s,"guest.token",o)}))}function $n(){const{clientId:e}=F(),t=be(),n=Vt("tokenData"),o=(0,u.U2)(n,"access_token"),r=(0,u.U2)(n,"swid");return Kt.getGuest({accessToken:o,swid:r}).then((r=>{if(200!==r.status)return null;const s=(0,u.U2)(r.data,"token")||n,i={...r.data,token:s};Ft("getGuestResponse",r),Ft("guest",i);return Ln(Vn({guest:i,token:s},o,e,t)),i}))}function Fn(e,t){return new Promise((n=>{const o=(0,u.U2)(e,"guest");if(!o)return;let r;r=t?function(e){if(!e)return Promise.resolve();const{clientId:t}=F(),n=be(),o=new Date(Date.now());o.setFullYear(o.getFullYear()+De);const r=pe({token:e});return Re.then((e=>e.call("responder","set.cookie",{key:`${t}-${n}.${z}`,value:r,expires:o,secure:!0}).catch((e=>{const t=(0,u.U2)(e,"message");s.error(`Error in PatchBay call: ${t}`)}))))}(e.token):Promise.resolve();const{clientId:i}=F(),a=be();let c;c=(0,u.U2)(e,"token.access_token")?Promise.resolve(e):Ve();const l=function(e){const t=Pn[(0,u.U2)(e,"profile.ageBand")||""],n=(0,u.U2)(e,"profile.region")||(0,u.U2)(e,"profile.countryCodeDetected"),o=t+n,{clientId:r}=F(),i=be();if(!t||!n||!e)return Promise.resolve();const a=new Date(Date.now());return a.setFullYear(a.getFullYear()+De),Re.then((e=>e.call("responder","set.cookie",{key:`${r}-${i}-${V}`,value:o,expires:a}).catch((e=>{const t=(0,u.U2)(e,"message");s.error(`Error in PatchBay call: ${t}`),rt({[We.ACTION_NAME]:We.LOG_PATCHBAY_ERROR,[We.INFO]:"location(outer-lib-cookies-ageBandCountry)",[We.STACK_TRACE]:t})}))))}(o);Promise.all([c,r,l]).then((t=>{Ln(Vn(e,(0,u.U2)(t[0],"token.access_token"),i,a)).then(n),Ft("wasLoggedIn",!0),Ft("guest",o)}))}))}function Vn(e,t,n,o){const r=function(e,t){const n=(0,u.d9)(e),o=JSON.stringify(n),r=(0,u.kn)(JSON.stringify({guest:e.guest})).toString(16);return{data:bn().encrypt(r+t,o),checksum:Dn+r}}({guest:e.guest,created:(new Date).toISOString()},t);try{localStorage.setItem(`${n}-${o}.guest`,r.data)}catch(e){}return r.checksum}const Mn="api",jn="invalid_refresh",Bn="logged_out_in_other_tab",qn="obo_logout",Wn="get_guest_gc_error",Kn="get_guest_session_error",Hn="get_guest_missing_session_data",Yn="unknown";function zn(e,t={}){const{clientId:n}=F(),o=be(),r=t.refresh_token,s=[];return r&&s.push({clientId:`${n}-${o}`,token:r}),e&&s.length?Kt.logout({swid:e,tokenAndClientIds:s}):Promise.resolve()}const Qn="error",Zn="init",Xn="login",Jn="logout",eo="low-trust",to="refresh";function no(e){const t=e||Yn;at(Jn,t,`reason(${t})`)}function oo(e){const{clientId:t}=F(),n=be(),o=Vt("logoutReason");return Ft("loggedIn",!1),Gn().then((r=>(Un(),zn((0,u.U2)(r,"profile.swid"),(0,u.U2)(r,"token")).then((()=>Re.then((r=>(r.message("inner","guest.logout"),Z((0,u.Vj)()),r.call("responder","guest.logout",`${t}-${n}`).finally((()=>(no(o),e("done"))))))))))))}const ro=[{readToken:{stepExecution:function(e){return Ve().then((t=>t?(Ft("tokenData",t),(0,u.U2)(t,"access_token")&&!he(t)?e("readGuestFromLocalStorage"):(Ft("logoutType","norefresh"),Ft("logoutReason",Kn),void e("forceLogout"))):e())).catch((()=>e()))},results:{readGuestFromLocalStorage:"readGuestFromLocalStorage",forceLogout:"forceLogout"}}},{readGuestFromLocalStorage:{stepExecution:function(e){const t=Vt("workflowOptions"),n=(0,u.U2)(t,"forceRefresh"),o=(0,u.U2)(t,"fullPayloadRequested");xn().then((t=>{if(!t)return e("getGuestFromGuestController");t&&Ft("guest",t);const r=(0,u.U2)(t,"token.created"),s=!!r&&new Date(r).getTime()+Pe<Date.now(),i=(0,u.U2)(t,"payload")===Lt;if(s||n||i&&o)return e("getGuestFromGuestController");e()}))},results:{getGuestFromGuestController:"getGuestFromGuestController"}}},{getGuestFromGuestController:{stepExecution:function(e){const t=Vt("tokenData"),n=Vt("guest")||{token:t},o=(0,u.U2)(n,"token.access_token"),r=(0,u.U2)(n,"token.swid")||(0,u.U2)(n,"profile.swid");return o&&r?Kt.getGuest({accessToken:o,swid:r}).then((t=>{Ft("getGuestResponse",t);const o=(0,u.U2)(t.data,"token")||n.token;if(200===t.status)return Ft("guest",{...t.data,token:o}),e("saveSession");const r=(0,u.U2)(t,"parsedErrors")||{};return r.isSecurityFlagged||r.isDisabled||r.isInvalidAccessToken?(Ft("logoutType","getGuest"),Ft("logoutReason",Wn),e("forceLogout")):e()})):(Ft("logoutType","getGuest"),Ft("logoutReason",Hn),e("forceLogout"))},results:{forceLogout:"forceLogout",saveSession:"saveSession"}}},{forceLogout:{stepExecution:oo,results:{}}},{saveSession:{stepExecution:function(e){const t=Vt("guest")||{};return t&&t.token?Fn({guest:t,token:t.token}).then(e):e()},results:{}}}];function so(){const{clientId:e}=F(),t=`${e}-${be()}`;return`${B}${(0,u.kn)(t).toString(16)}`}function io(){return y(so())}function ao(){return new Promise((e=>{if(io())return s.debug("Mutex#cookie already present"),e(!1);setTimeout((()=>{if(io())return s.debug("Mutex#cookie already present"),e(!1);s.debug("Mutex#setting cookie");const t=new Date(Date.now()+xe);return R(so(),"0",w.getCookieDomain(),"/",t),e(!0)}),Math.floor(1e3*Math.random()+1e3))}))}let co=!1;function uo(){return co}function lo(e){co=!!e}function po(e,t){const n=new Date(Date.now());return e.token=t,e.token.created=n.toISOString(),e.token.lastChecked=e.token.created,e.token.expires=new Date(e.token.exp).toISOString(),e.token.refresh_expires=new Date(e.token.refresh_exp).toISOString(),Fn({guest:e,token:e.token},!0)}const fo=[{readToken:{stepExecution:function(e){return Ve().then((n=>n?(Ft("tokenData",n),Ee(n)?(0,u.U2)(n,"refresh_token")?e("acquireMutex"):(Ft("logoutType","norefresh"),t(),void e("ensureLoggedOut")):(t(),e("emitRefreshEvent"))):e())).catch((()=>e()));function t(){Ft("mutexAttempt",0)}},results:{ensureLoggedOut:"ensureLoggedOut",acquireMutex:"acquireMutex",emitRefreshEvent:"emitRefreshEvent"}}},{ensureLoggedOut:{stepExecution:oo,results:{done:"releaseMutex"}}},{acquireMutex:{stepExecution:function(e){const t=Vt("mutexAttempts")+1||1;return Ft("mutexAttempts",t),t>Ue?(s.debug("acquireMutex#max attempts reached"),n(),e("ensureGuestLoggedOut")):ao().then((t=>{if(!t)return s.debug("acquireMutex#could not acquire"),setTimeout((()=>{e("readToken")}),Ge);n(),e("refreshToken")}));function n(){Ft("mutexAttempts",0)}},results:{readToken:"readToken",ensureGuestLoggedOut:"ensureLoggedOut",refreshToken:"refreshToken"}}},{refreshToken:{stepExecution:function(e){const t=Vt("tokenData")||{},n=uo();return Kt.refreshAuthorization(t.refresh_token).then((t=>{Ft("tokenRefreshResponse",t);const o=(0,u.U2)(t,"data.token")||{},r=(0,u.U2)(t,"parsedErrors")||{},s=200===t.status&&o.access_token&&o.refresh_token,i=n&&o.access_token&&o.refresh_token;return s||i?xn().then((t=>(Ft("tokenData",o),t?po(t,o).then((()=>e("emitRefreshEvent"))):$n().then((e=>po(e,o))).then((()=>e("emitRefreshEvent")))))):r.isInvalidRefreshToken?(Ft("logoutType","norefresh"),Ft("logoutReason",jn),e("ensureGuestLoggedOut")):r.isSecurityFlagged?(Ft("logoutType","securityFlagged"),e("ensureGuestLoggedOut")):r.isGating?n?e("ensureGuestLoggedOut"):Re.then((t=>t.call("inner","runWorkflow",{name:"GATING",workflowData:{parsedErrors:r}}).then((()=>(Rn.showLightbox(),e("ensureGuestLoggedOut")))))):r.isPPU?n?e("ensureGuestLoggedOut"):Promise.all([Gn(),Re]).then((([n,o])=>o.call("inner","runWorkflow",{guest:n,name:"LOGIN",step:"ppuSubflow",workflowData:{parsedErrors:r,ppu:{errors:t.error.errors}}}).then((()=>{Rn.showLightbox(),e()})))):void 0})).catch((()=>e("releaseMutex")))},results:{ensureGuestLoggedOut:"ensureLoggedOut",releaseMutex:"releaseMutex",emitRefreshEvent:"emitRefreshEvent"}}},{forceRefresh:{stepExecution:function(e){return Ve().then((t=>{if(!t)return e();Ft("tokenData",t),e("refreshToken")}))},results:{refreshToken:"refreshToken"}}},{emitRefreshEvent:{stepExecution:function(e){const t=Vt("tokenData");return at(to,t),Re.then((n=>{n.message("inner","setGuest",{token:t}),e()})).catch(e)},results:{releaseMutex:"releaseMutex"}}},{releaseMutex:{stepExecution:function(e){I(so(),w.getCookieDomain(),"/"),Mt("tokenData"),e()},results:{}}}];function ho(e){new qe("tokenRefresh",fo,void 0,(()=>e())).runWorkflow()}const go=0,Eo=1;function _o(){return new Promise((e=>{const{clientId:t}=F(),n=be();Re.then((o=>o.call("responder","get.cookie",`${t}-${n}.${Q}`).then((t=>{if(null===t)return e({state:!1});const n=Date.parse(t)-Date.now();e({state:n<1?go:Eo,timeLeft:n})})).catch((e=>{const{message:t}=e||{};s.error(`Error in PatchBay call: ${t}`),rt({[We.ACTION_NAME]:We.LOG_PATCHBAY_ERROR,[We.INFO]:"location(outer-lib-cookies-trustState)",[We.STACK_TRACE]:t})}))))}))}function mo(e=Fe){const{clientId:t}=F(),n=be(),o=new Date(Date.now()+e);return Re.then((e=>e.call("responder","set.cookie",{key:`${t}-${n}.${Q}`,value:o.toISOString(),expires:o}).catch((e=>{const{message:t}=e||{};s.error(`Error in PatchBay call: ${t}`),rt({[We.ACTION_NAME]:We.LOG_PATCHBAY_ERROR,[We.INFO]:"location(outer-lib-cookies-trustState)",[We.STACK_TRACE]:t})}))))}function yo(){const{clientId:e}=F(),t=be();return Re.then((n=>n.call("responder","delete.cookie",{key:`${e}-${t}.${Q}`}).catch((e=>{const{message:t}=e||{};s.error(`Error in PatchBay call: ${t}`),rt({[We.ACTION_NAME]:We.LOG_PATCHBAY_ERROR,[We.INFO]:"location(outer-lib-cookies-trustState)",[We.STACK_TRACE]:t})}))))}const Io=e=>Fn({guest:e,token:e.token},!0);function Ro(e){return function({guest:e,writeSWIDCookie:t,writeGuest:n,writeTrustStateCookie:o}){const r=new Date(Date.now()),s={...e,token:{...e.token,created:r.toISOString(),lastChecked:r.toISOString(),expires:new Date(e.token.exp).toISOString(),refresh_expires:new Date(e.token.refresh_exp).toISOString()}},i=(0,u.U2)(s,"profile.swid"),a=(0,u.U2)(s,"profile.ageBand")===Pt;return Promise.all([t(i,a),n(s),o(1e3*s.token.high_trust_expires_in||void 0)])}({guest:e,writeSWIDCookie:Z,writeGuest:Io,writeTrustStateCookie:mo})}function wo(e,t){s.error(e),rt({[We.ACTION_NAME]:We.EVENT_LOGIN_OBO,[We.ERROR_CATEGORY]:"Unknown",[We.INFO]:`substep(${t}),message(${(null===e||void 0===e?void 0:e.message)||""})`})}const Oo="EMAIL_VERIFICATION",To="GATING",Ao="IDENTITY_FLOW",vo="LICENSE_PLATE",No="LOGIN",Co="NEWSLETTERS",ko="OTP_REQUEST_AND_REDEEM",So="REAUTH",bo="REGISTRATION",Po="UPDATE_PROFILE",Lo="REDEEM_SESSION_TRANSFER",Do="LAUNCH_OTP";const Uo=[{cleanUpSession:{stepExecution:function(e){Ve().then((t=>{t&&(!function(){s.debug("[SESSION TOKEN] - Cookie deletion");const e=F(),t=be();I(`${e&&e.clientId}-${t}.${z}`,O(),"/")}(),rt({[We.ACTION_NAME]:We.EVENT_LOGOUT,[We.INFO]:`reason(${qn})`})),e("done")}))},results:{done:"attemptOBOLogin"}}},{attemptOBOLogin:{stepExecution:function(e){const t=y(H),n=Cn();s.debug("[OBO Login Attempt]: started obo: ",n," swid: ",t);const o=nt(We.EVENT_LOGIN_OBO);return Kt.oboLogin({swid:t,oboToken:n}).then((t=>(s.debug("[OBO Login Attempt]: response ",t),kn(),t.status>=400&&t.status<500||(e=>{var t;return((null===(t=e.error)||void 0===t?void 0:t.errors)||[]).some((e=>e.code===wt))})(t)?(Ft("oboResponse",t),function(e){var t;rt({[We.ACTION_NAME]:We.EVENT_LOGIN_OBO,[We.ERROR_CATEGORY]:(null===(t=e.error)||void 0===t?void 0:t.keyCategory)||"Unknown",[We.ERROR_CODES]:Gt(Ut(e))})}(t),void e("failed")):Ro(t.data).then((()=>{s.debug("[OBO Attempt] - Success create session"),o.send({[We.INFO]:"login_obo_success"}),e("success")})).catch((t=>{wo(t,"createSession"),e("failed")}))))).catch((t=>{wo(t,"oboLogin"),kn(),e("failed")}))},results:{failed:"parseErrors"}}},{parseErrors:{stepExecution:function(e){var t,n;const o=Vt("oboResponse")||{};return(null===o||void 0===o||null===(t=o.parsedErrors)||void 0===t?void 0:t.isPPU)?e("ppu"):(null===o||void 0===o||null===(n=o.parsedErrors)||void 0===n?void 0:n.isGating)?e("gating"):void e()},results:{ppu:"launchPPU",gating:"launchGating"}}},{launchPPU:{stepExecution:function(e){const t=Vt("oboResponse")||{};return Re.then((n=>n.call("inner","runWorkflow",{guest:t.data,name:No,step:"ppuSubflow",workflowData:{parsedErrors:t.parsedErrors,ppu:{errors:t.error.errors}}}).then((()=>{Rn.showLightbox(),e()}))))},results:{}}},{launchGating:{stepExecution:function(e){const t=Vt("oboResponse")||{};return Re.then((n=>n.call("inner","runWorkflow",{name:To,workflowData:{parsedErrors:t.parsedErrors}}).then((()=>{Rn.showLightbox(),e()}))))},results:{}}},{windowReload:{stepExecution:function(e){s.debug("[OBO Reload] - this app will be reloaded in 2 seconds...");const t=window.location.reload.bind(window.location);setTimeout(t,2e3)},results:{}}}];function Go(e){const t={data:{email:null,legal:[]},error_codes:null},n=Vt("workflowOptions")||{};t.data.campaignId=Vt("promotionID"),Ft("workflowOptions",{...n,fullPayloadRequested:!0});new qe("getGuest",ro,null,(()=>{const n=Vt("guest");return n?(t.data.email=n.profile.email,Ft("responsePayload",t),e("guestIsLoggedIn")):(Ft("responsePayload",t),e("guestIsNotLoggedIn"))})).runWorkflow()}const xo="AGE_GATED",$o="ALREADY_OPT_IN",Fo="INVALID_EMAIL",Vo="INVALID_LOCATION",Mo="NO_DATA",jo="NO_VALID_CAMPAIGN",Bo="SERVICE_ERROR";function qo(e){const t=e.errors[0];if("MISSING_VALUE"===t.code){const e=t.inputName.toUpperCase();return`${t.code}_${e}`}return t.code}function Wo(e){const t=Vt("responsePayload");ct().then((n=>{const o=(0,u.U2)(n,"compliance.ageBands.ADULT.country");if("US"!==o)return t.data={},t.error_codes=Vo,Ft("responsePayload",t),e();Ft("defaultLegalCountry",o),e("getLegalData")}))}const Ko=(e,t=!1)=>({code:e.name,content:e.text,subscribed:t,preselected:e.checked});function Ho(e){ct().then((t=>{const n=Vt("guest"),o=(0,u.U2)(n,"profile.region"),r=(0,u.U2)(n,"profile.countryCodeDetected"),s=(0,u.U2)(t,"compliance.defaultCountryCode");Ft("guestLocation",o||r||s||"US"),e("checkProfile")}))}function Yo(e){const t=Vt("responsePayload"),n=Vt("guest"),o=Vt("workflowOptions"),r=function(e,t){if("CHILD"===(0,u.U2)(e,"profile.ageBand"))return xo;if("US"!==Vt("guestLocation"))return Vo;if(null!==t&&t!==(0,u.U2)(e,"profile.email"))return Fo;return!1}(n,(0,u.U2)(o,"buData.email")||null)||!1;if(r)return t.error_codes=r,t.data={},Ft("responsePayload",t),e();e("hasOptedIntoAnything")}const zo=["firstName","gender","lastName","middleName","prefix","suffix","languagePreference","pronunciationName","address.billing","address.home","address.school","address.shipping","address.work","phone.day","phone.mobile","phone.night","proposedDisplayName"],Qo=["email","username","address.other","phone.fax","dateOfBirth","password","displayName","region"],Zo=["line1","line2","line3","city","stateProvince","postalCode","country","preferred"],Xo=["number","internationalPrefix","countryCode","extension","preferred"];function Jo(e,t){const n=Object.keys(e).filter((function(e){return 0===e.indexOf(`${t}.`)})).map((function(t){const n=t.split(".");return{type:n[1].toUpperCase(),field:n[2],value:e[t]}})).reduce((function(e,t){return(0,u.t8)(e,[t.type,t.field].join("."),t.value),e}),{});return Object.keys(n).map((function(e){return Object.assign(n[e],{type:e})}),[])}function er(e){e.forEach((e=>{Object.keys(e).forEach((function(t){null===e[t]&&delete e[t]}))}))}function tr(e,t,n){t.map((function(t){const o=(r=e,s=t.type,r.filter((e=>e.type===s)));var r,s;return o.length&&(t[n]=o[0][n]),t}))}function nr(e){let t=!1;for(const n in e)"addressGuid"!==n&&"type"!==n&&"preferred"!==n&&(t=!0);return t}function or(e){if("string"===typeof e)return e.trim();if("object"===typeof e)for(const t in e)e[t]=or(e[t]);return e}function rr(e,t){const n={};for(const o in t)if(t.hasOwnProperty(o)){null!==e&&"object"===typeof e&&e.hasOwnProperty(o)||(n[o]=t[o]);if(null!==t[o]&&null!==e[o]&&!Array.isArray(t[o])&&!Array.isArray(e[o])&&"object"===typeof t[o]&&"object"===typeof e[o]){const r=rr(e[o],t[o]);Object.keys(r).length>0&&(n[o]=r)}else(e[o]!==t[o]||Array.isArray(t[o]))&&(n[o]=t[o]);null===e[o]&&""===t[o]&&delete n[o]}return n}function sr(e,t){return t=(0,u.d9)(t),Object.keys(t||{}).forEach((function(n){null===(0,u.U2)(t,n)&&(0,u.U2)(e,n)&&(0,u.t8)(t,n,e[n])})),(0,u.t8)(e,"etag",(0,u.U2)(t,"etag")),e.profile=ir(e.profile,t.profile),e.displayName=ir(e.displayName,t.displayName),e.marketing=ir(e.marketing,t.marketing),e}function ir(e,t){if(null===t||"object"!==typeof t||Array.isArray(t))return t;for(const n in t)t.hasOwnProperty(n)&&((e=e||{})[n]=ir(e[n],t[n]));return e}function ar(e,t){return(e=e||[]).reduce(((e,n)=>("undefined"===typeof e[n[t]]&&(e[n[t]]=n),e)),{})}function cr(e){if((e=e||{})&&"EDITABLE"===e.editable){const t=e.type||{};return Object.keys(t).reduce(((e,n)=>{const o=t[n]||{};return e[n]=Object.keys(o).reduce(((e,t)=>("EDITABLE"===o[t].editable&&"type"!==t&&(e[t]=null),e)),{}),e}),{})}return null}function ur(e){const t=e.existingProfile[e.type]||e.template[e.type]||e.template.DEFAULT||null,n=e.config[e.type]||e.config.DEFAULT||null;return t&&n&&Object.keys(t).forEach((o=>{if(e.allowedFields.indexOf(o)>-1){const r=e.fieldName.split(".");r.push(o);const s=r.join(".");e.editableProfile.data[s]=t[o]||null,e.editableProfile.required[s]=(n[o]||{}).required||!1}})),e.editableProfile}let lr;function dr(){return s.log("TrustState#watch"),_o().then((e=>{if(pr(),(0,u.U2)(e,"state")===go)return s.info("In low trust"),fr(),void yo();!function(e=Fe){lr=setTimeout((()=>{fr(),yo()}),e)}((0,u.U2)(e,"timeLeft"))})).catch((()=>{fr(),pr()}))}function pr(){clearTimeout(lr),lr=void 0}function fr(){at(eo)}const hr="EMAIL_VERIFICATION_CALLBACK",gr="LAUNCH_OTP_CALLBACK",Er="LICENSE_PLATE_CALLBACK",_r="REAUTH_CALLBACK",mr="REDEEM_SESSION_TRANSFER_CALLBACK";const yr={INITIALIZATION:[{anonymize:{stepExecution:function(e){X()||Z((0,u.Vj)()),e("done")},results:{done:"checkForOBOToken"}}},{checkForOBOToken:{stepExecution:function(e){s.debug("[checkForOBOToken]: init");const t=Cn();if(!t)return s.debug("[checkForOBOToken]: no OBO Token"),e("notFound");s.debug("[checkForOBOToken]: OBO Token Found: ",t,t.isExpired),e("found")},results:{found:"oboSubflow",notFound:"readSession"}}},{readSession:{stepExecution:function(e){return Ve().then((t=>t?(Ft("tokenData",t),he(t)?(s.info("Starting token refresh"),e("tokenRefresh")):void e("getGuestSubflow")):e()))},results:{getGuestSubflow:"getGuestSubflow",tokenRefresh:"tokenRefreshSubflow"}}},{getGuestSubflow:{stepExecution:function(e){new qe("getGuest",ro,"readGuestFromLocalStorage",(()=>{const t=Vt("guest");if(t)return Re.then((e=>e.message("inner","setGuest",t))).finally(e);e()})).runWorkflow()},results:{}}},{tokenRefreshSubflow:{stepExecution:ho,results:{}}},{oboSubflow:{stepExecution:function(e){new qe("oboSubflow",Uo,void 0,(()=>e("done"))).runWorkflow()},results:{done:"readSession"}}}],GET_GUEST:ro,GUEST_FLOW:[{validate:{stepExecution:function(e){const t=Vt("workflowOptions");let n=(0,u.U2)(t,"guestFlowEmail"),o=!1;if("string"===typeof n&&(n=n.trim().replace(/<|>/gim,""),o=p.test(n)),o)return Ft("guestFlowEmail",n),e("checkForAccount");Mt("guestFlowEmail"),e("launchRegistration")},results:{checkForAccount:"checkForAccount",launchRegistration:"launchRegistration"}}},{checkForAccount:{stepExecution:function(e){const t=Vt("guestFlowEmail");return t?Kt.guestFlow(t).then((t=>{const n=(0,u.U2)(t,"data.guestFlow")||"",o=n.match(h)?"launchLogin":"launchRegistration";Ft("guestFlowCode",n),e(o)})).catch((()=>e("launchRegistration"))):e("launchRegistration")},results:{launchLogin:"launchLogin",launchRegistration:"launchRegistration"}}},{launchRegistration:{stepExecution:function(e){Ft("guestFlowName","REGISTRATION_FLOW");const t=Vt("workflowOptions"),n=Vt("guestFlowEmail")||"",o=Vt("guestFlowCode"),r={profile:{email:n}};return Re.then((n=>n.call("inner","runWorkflow",{name:"REGISTRATION",workflowOptions:t,guestChanges:r,persistentTealiumData:{flow_name:"Guest Flow Registration",guest_flow:o}}).then((()=>{Rn.showLightbox(),e()})).catch((t=>{const n=(0,u.U2)(t,"message");s.error(`Error in PatchBay call: ${n}`),rt({[We.ACTION_NAME]:We.LOG_PATCHBAY_ERROR,[We.INFO]:"location(outer-workflows-guestFlow-launchRegistration)",[We.STACK_TRACE]:n}),e()}))))},results:{}}},{launchLogin:{stepExecution:function(e){Ft("guestFlowName","LOGIN_FLOW");const t=Vt("workflowOptions"),n=Vt("guestFlowCode");return Re.then((o=>o.call("inner","runWorkflow",{name:"LOGIN",workflowData:{loginValue:Vt("guestFlowEmail")},workflowOptions:t,persistentTealiumData:{flow_name:"Guest Flow Login",guest_flow:n}}).then((()=>{Rn.showLightbox(),e()})).catch((t=>{const n=(0,u.U2)(t,"message");s.error(`Error in PatchBay call: ${n}`),rt({[We.ACTION_NAME]:We.LOG_PATCHBAY_ERROR,[We.INFO]:"location(outer-workflows-guestFlow-launchLogin)",[We.STACK_TRACE]:n}),e()}))))},results:{}}}],GET_INLINE_NEWSLETTERS:[{runGetGuestWorkflow:{stepExecution:Go,results:{guestIsLoggedIn:"getGuestLegalCountry",guestIsNotLoggedIn:"getDefaultLegalCountry"}}},{getDefaultLegalCountry:{stepExecution:Wo,results:{getLegalData:"getLegalData"}}},{getLegalData:{stepExecution:function(e){const t=Vt("responsePayload");return Promise.all([ct(),Re.then((e=>e.call("inner","config.getL10n"))).then(u._A)]).then((([n,o])=>{const r=(0,u.U2)(n,"legal.ADULT.disclosures"),s=[];r.forEach((e=>{s.push({code:e.disclosureCode,requiresActiveConsent:e.requiresActiveConsent,accepted:!e.requiresActiveConsent,content:o[`legal.${e.disclosureCode}_create`]})})),t.data.legal=s,Ft("responsePayload",t),e("getMarketingData")}))},results:{getMarketingData:"getMarketingData"}}},{getMarketingData:{stepExecution:function(e){const t=Vt("responsePayload"),n=Vt("promotionID");return ct().then((o=>{const r=(0,u.U2)(Vt("guest"),"profile.ageBand")||"ADULT",s=(0,u.U2)(o,`newsletters.${r}.${n}`),i=new Set,a=[];s.forEach((e=>{i.has(e.name)||(i.add(e.name),a.push(Ko(e)))})),t.data.marketing=a,Ft("responsePayload",t),e()}))},results:{}}},{getGuestLegalCountry:{stepExecution:Ho,results:{checkProfile:"checkProfile"}}},{checkProfile:{stepExecution:Yo,results:{hasOptedIntoAnything:"hasOptedIntoAnything"}}},{hasOptedIntoAnything:{stepExecution:function(e){const t=Vt("guest");e((0,u.U2)(t,"marketing")?"filterOptedInMarketingLists":"getMarketingData")},results:{getMarketingData:"getMarketingData",filterOptedInMarketingLists:"filterOptedInMarketingLists"}}},{filterOptedInMarketingLists:{stepExecution:function(e){ct().then((t=>{const n=Vt("guest"),o=(0,u.U2)(n,"marketing"),r=(0,u.U2)(n,"profile.ageBand"),s=Vt("promotionID"),i=(0,u.U2)(t,`newsletters.${r}.${s}`),a=[];for(const e of i)a.push(...e.lists);const c=new Set(o.filter((e=>e.subscribed)).map((e=>e.code))),l=a.filter((e=>!c.has(e.name))),d=Vt("responsePayload");l.length?d.data.marketing=l.map((e=>Ko(e))):(d.error_codes=$o,d.data={}),Ft("responsePayload",d),e()}))},results:{}}}],SET_INLINE_NEWSLETTERS:[{runGetGuestWorkflow:{stepExecution:Go,results:{guestIsLoggedIn:"getGuestLegalCountry",guestIsNotLoggedIn:"getDefaultLegalCountry"}}},{getDefaultLegalCountry:{stepExecution:Wo,results:{getLegalData:"prepareRequest"}}},{getGuestLegalCountry:{stepExecution:Ho,results:{checkProfile:"checkProfile"}}},{checkProfile:{stepExecution:Yo,results:{hasOptedIntoAnything:"prepareRequest"}}},{prepareRequest:{stepExecution:function(e){const t=(0,u.U2)(Vt("workflowOptions"),"buData"),n=(0,u.U2)(t,"legal"),o=(0,u.U2)(t,"marketing");if(!n||!o)return e();Ft("marketingParams",o);const r=(0,u.U2)(t,"campaignId"),s=Vt("guestLocation")||Vt("defaultLegalCountry");Ft("requestPayload",{profile:{email:t.email,countryCodeDetected:s,region:s},legalAssertions:n.filter((e=>e.accepted)).map((e=>e.code)),campaign:r}),e("prepareMarketingPayload")},results:{prepareMarketingPayload:"prepareMarketingPayload"}}},{prepareMarketingPayload:{stepExecution:function(e){const t=Vt("requestPayload"),{campaign:n}=t,o=Vt("marketingParams"),r=Vt("guest"),s=r&&r.marketing;s&&o.push(...r.marketing);const i=function(e){const t=e.filter((e=>e.subscribed)),n=new Set,o=[];return t.forEach((e=>{n.has(e.code)||(o.push(e),n.add(e.code))})),o}(o);ct().then((o=>{const a=(0,u.U2)(o,"newsletters.ADULT",n);let c=!1;const l=[];if(s){const e=[];a.forEach((t=>e.push(...t.lists)));const t={};e.forEach((e=>t[e.name]=e));for(const e of i){const n=t[e.code];if(!n){c=!0;break}l.push({code:n.name,subscribed:!0,textId:n.textId})}}else{const t={};a.forEach((e=>t[e.name]=e));for(const e of i){const n=t[e.code];if(!n){c=!0;break}{const e=n.lists.map((e=>({code:e.name,subscribed:!0,textId:n.textId})));l.push(...e)}}if(c)return Ft("responsePayload",{data:{},error_codes:"NO_VALID_CAMPAIGN"}),e()}t.marketing=l,Ft("requestPayload",t),e(r?"executeUpdate":"executeRequest")}))},results:{executeUpdate:"executeUpdate",executeRequest:"executeRequest"}}},{executeRequest:{stepExecution:function(e){const t=Vt("requestPayload");return Kt.guestMarketingOptIn(t).then((t=>{const n=(0,u.U2)(t,"error.keyCategory");!t.data||null!==t.error&&"ADVISORY"!==n?Ft("responsePayload",{data:{},error_codes:qo(t.error)}):Ft("responsePayload",{data:"SUCCESS",error_codes:null}),e()})).catch((()=>{Ft("responsePayload",{data:{},error_codes:Bo}),e()}))},results:{}}},{executeUpdate:{stepExecution:function(e){const t=Vt("requestPayload"),{marketing:n}=t,o=Vt("guest"),r=(0,u.U2)(o,"profile.swid"),s=(0,u.U2)(o,"token.access_token"),i=We.SERVICE_UPDATE_GUEST,a={marketing:n};return Kt.guestUpdateBySWID({guest:a,swid:r,accessToken:s,eventName:i}).then((t=>{const n=(0,u.U2)(t,"error.keyCategory");!t.data||null!==t.error&&"ADVISORY"!==n?(Ft("responsePayload",{data:{},error_codes:qo(t.error)}),e()):(Ft("responsePayload",{data:"SUCCESS",error_codes:null}),e("reloadGuest"))})).catch((()=>{Ft("responsePayload",{data:{},error_codes:Bo}),e()}))},results:{reloadGuest:"reloadGuest"}}},{reloadGuest:{stepExecution:function(e){const t=Vt("workflowOptions")||{};t.fullPayloadRequested=!0,t.forceRefresh=!0,Ft("workflowOptions",t),new qe("getGuest",ro,null,(()=>e())).runWorkflow()},results:{}}}],GET_EDITABLE_AND_REQUIRED_FIELDS:[{runGetGuestWorkflow:{stepExecution:Go,results:{guestIsLoggedIn:"getEditableAndRequiredFields",guestIsNotLoggedIn:{}}}},{getEditableAndRequiredFields:{stepExecution:function(e){const t=Vt("guest");let n={data:{},required:{}};try{ct().then((o=>{const r=zo,s=`compliance.ageBands.${t.profile.ageBand}.UPDATE`,i=(0,u.U2)(o,s),a=ar(t.profile.addresses,"type"),c=ar(t.profile.phones,"type"),l=cr((0,u.U2)(o,`${s}.addresses`)),d=cr((0,u.U2)(o,`${s}.phones`)),p=(0,u.U2)(o,"displayName"),f=(0,u.U2)(p,"enabled");for(const e of r){const o=(e.split(".")[1]||"").toUpperCase();e.includes("address")&&i.addresses?n=ur({existingProfile:a,template:l,config:i.addresses.type,allowedFields:Zo,fieldName:e,editableProfile:n,type:o}):e.includes("phone")&&i.phones?n=ur({existingProfile:c,template:d,config:i.phones.type,allowedFields:Xo,fieldName:e,editableProfile:n,type:o}):e.toLowerCase().includes("displayname")&&f?n.data[e]=(0,u.U2)(t,`displayName.${e}`):i[e]&&(n.data[e]=(0,u.U2)(t,`profile.${e}`),n.required[e]=(0,u.U2)(i,e).required||!1)}return Ft("editableFields",n),Promise.resolve(e())}))}catch(e){Ft("editableFields",{error_codes:vt,data:{}})}},results:{}}}],SESSION_STATE_TASKS:[{checkState:{stepExecution:function(e){const t=()=>{if(!0===Vt("wasLoggedIn"))return e("syncLoggedOut");e()};return Ve().then((n=>n?(Ft("loggedIn",!0),!1===Vt("wasLoggedIn")?e("syncLoggedIn"):!ge(n)||Ee(n)?e("tokenRefresh"):void e()):t())).catch(t)},results:{syncLoggedIn:"syncLoggedIn",syncLoggedOut:"syncLoggedOut",tokenRefresh:"tokenRefreshSubflow"}}},{tokenRefreshSubflow:{stepExecution:ho,results:{}}},{syncLoggedIn:{stepExecution:function(e){return Promise.all([Gn(),Re]).then((([t,n])=>n.call("inner","setGuest",t).then((()=>{n.call("inner","reloadConfigFromBundlerIfChanged");const o=(0,u.U2)(t,"profile.ageBand")===Pt;Z((0,u.U2)(t,"profile.swid"),o),at(Xn,t),dr(),Ft("loggedIn",!0),e()})))).catch(e)},results:{}}},{syncLoggedOut:{stepExecution:function(e){const t=X();return Re.then((n=>n.call("inner","guest.logout").then((()=>{pr(),t&&t.startsWith("{")&&Z((0,u.Vj)()),no(Bn),jt(),Ft("loggedIn",!1),e()})).catch(e)))},results:{}}}],SET_PPC:[{runGetGuestWorkflow:{stepExecution:Go,results:{guestIsLoggedIn:"parseInput",guestIsNotLoggedIn:{}}}},{parseInput:{stepExecution:function(e){const t=Vt("workflowData"),n=function(e){return Object.keys(e).filter((function(t){return!("string"!==typeof e[t]||!e[t].trim())})).filter((function(e){for(let t=0;t<Qo.length;t++)if(e.startsWith(Qo[t]))return;return!0})).reduce((function(t,n){return t[n]=e[n].trim(),t}),{})}((0,u.U2)(t,"guestData")||{}),o=function(e){return Object.keys(e).filter((function(e){return!e.includes("address.")&&!e.includes("phone.")&&"proposedDisplayName"!==e})).reduce((function(t,n){return t.profile[n]=e[n],t}),{profile:{}})}(n);o.profile.addresses=Jo(n,"address"),o.profile.phones=Jo(n,"phone"),n.proposedDisplayName&&(o.displayName={proposedDisplayName:n.proposedDisplayName}),(0,u.t8)(t,"parsedGuest",o),Ft("workflowData",t),e("success")},results:{success:"prepareUpdate",error:"close"}}},{prepareUpdate:{stepExecution:function(e){const t=Vt("workflowData"),n=(0,u.U2)(t,"parsedGuest"),o=(0,u.d9)(n),r=(0,u.U2)(t,"guest"),s=(0,u.U2)(r,"profile.addresses"),i=(0,u.U2)(r,"profile.phones"),a=(0,u.U2)(o,"profile.addresses"),c=(0,u.U2)(o,"profile.phones");Array.isArray(s)&&Array.isArray(a)&&tr(s,a,"addressGuid"),Array.isArray(i)&&Array.isArray(c)&&tr(i,c,"phoneGuid");const l=function(e,t){if("undefined"===typeof e||"undefined"===typeof t)return{};const n=or((0,u.d9)({profile:rr(e.profile||{},t.profile||{})||{},displayName:rr(e.displayName||{},t.displayName||{})||{}}));Object.keys(n.profile).forEach((function(e){""===n.profile[e]&&(n.profile[e]=null)})),Object.keys(n.displayName).forEach((function(e){""===n.displayName[e]&&(n.displayName[e]=null)})),(0,u.U2)(n.profile,"dateLastModified")&&delete n.profile.dateLastModified;(0,u.U2)(n.profile,"segmentDeletes")&&delete n.profile.segmentDeletes;return function(e,t,n){const o=["line1","line2","line3","postalCode","stateProvince","country","city","type"],r=(0,u.d9)((0,u.U2)(t,"profile.addresses")||[]),s=[],i={};((0,u.U2)(e,"profile.addresses")||[]).forEach((function(e){i[e.addressGuid]=e})),(0,u.U2)(n,"profile.addresses")&&delete n.profile.addresses;Array.isArray(r)&&r.length&&(r.forEach((function(e){const t=e.addressGuid,n={};o.forEach((function(t){n[t]=e[t]?e[t]:null})),"undefined"!==typeof(0,u.U2)(i,[t,"addressGuid"].join("."))&&(n.addressGuid=t,a(n).forEach((function(o){i[t][o]===e[o]&&delete n[o]}))),a(n).length&&s.push(n)})),s.length&&(0,u.t8)(n,"profile.addresses",s));function a(e){return Object.keys(e).filter((function(e){return-1===["preferred","addressGuid","type"].indexOf(e)}))}}(e,t,n),function(e,t,n){if(!(0,u.U2)(n,"profile"))return;"undefined"!==typeof(0,u.U2)(n,"profile.phones")&&delete n.profile.phones;if(Array.isArray((0,u.U2)(t,"profile.phones"))){const s=[];t.profile.phones.forEach((function(t){let n,i;t.phoneGuid&&!t.number?s.push({phoneGuid:t.phoneGuid}):t.number&&t.type&&(n=r(e,t),n?(i=rr(n,t),Object.keys(i).length>0&&(i.phoneGuid=t.phoneGuid,i.type=t.type,s.push(i))):s.push(o({number:t.number,type:t.type,internationalPrefix:t.internationalPrefix,countryCode:t.countryCode})))})),s.length&&(n.profile.phones=s)}function o(e){const t={};return Object.keys(e).forEach((function(n){let r;"object"===typeof e[n]?(r=o(e[n]),Object.keys(r).length>0&&(t[n]=r)):null!=e[n]&&(t[n]=e[n])})),t}function r(e,t){let n;const o=(0,u.U2)(e,"profile.phones");return t.phoneGuid&&o&&(n=o.filter((function(e){return e.phoneGuid===t.phoneGuid}))[0]),n}}(e,t,n),function(e,t,n){const o=(0,u.U2)(e,"marketing");let r=(0,u.U2)(t,"marketing");const s={};if((o||[]).forEach((function(e){s[e.code]=e})),Array.isArray(r)&&r.length&&(r=r.filter((function(e){return e.subscribed!==(0,u.U2)(s,[e.code,"subscribed"].join("."))})),r.length))return n.marketing=r,n.marketing}(e,t,n),function(e,t,n){const o=e.legalAssertions||[],r=[];(t.legalAssertions||[]).forEach((function(e){-1===o.indexOf(e)&&r.push(e)})),r.length>0&&(n.legalAssertions=r)}(e,t,n),Object.keys(n).forEach((function(e){"object"!==typeof n[e]||n[e]&&0!==Object.keys(n[e]).length||delete n[e]})),n}(r,o);if(Array.isArray((0,u.U2)(l,"profile.addresses"))){er(l.profile.addresses);const e=l.profile.addresses.filter(nr);e.length>0?l.profile.addresses=e:delete l.profile.addresses}Array.isArray((0,u.U2)(l,"profile.phones"))&&er(l.profile.phones),(0,u.t8)(t,"modifiedGuest",l),Ft("workflowData",t),e("success")},results:{success:"execute"}}},{execute:{stepExecution:function(e){const t=Vt("workflowData"),n=(0,u.U2)(t,"guest"),o=(0,u.U2)(n,"etag"),r={...(0,u.U2)(t,"modifiedGuest"),etag:o},s=(0,u.U2)(n,"profile.swid"),i=(0,u.U2)(n,"token.access_token");return Kt.guestUpdateBySWID({guest:r,swid:s,accessToken:i,etag:o,eventName:We.API_SET_PPC}).then((t=>{const o=(0,u.U2)(t,"error.keyCategory");!t.data||null!==t.error&&"ADVISORY"!==o||Ft("workflowData",{...Vt("workflowData"),guest:sr(n,t.data)}),Ft("workflowErrors",(0,u.U2)(t,"error.errors")),e()}),(t=>{Ft("workflowErrors",(0,u.U2)(t,"error.errors")),e()}))},results:{}}}],TOKEN_REFRESH:fo,REDEEM_SESSION_TRANSFER:[{redeemSessionTransfer:{stepExecution:function(e){const t=Vt("workflowData"),n=(0,u.U2)(t,"sessionTransferKey")||"";return Kt.authenticateViaSessionTransferKey({sessionTransferKey:n}).then((t=>{t&&Ft("redeemResponse",{...t});if(((0,u.U2)(t,"error.errors")||[]).length)return e("parseErrors");e("createSession")})).catch(e)},results:{createSession:"createSession",parseErrors:"parseErrors"}}},{parseErrors:{stepExecution:function(e){const t=Vt("redeemResponse")||{},n=t.parsedErrors||{};return n.isInvalidSessionTransferKeyError?e():n.isPPU&&200===t.status||200===t.status||n.isAdvisoryError?e("createSession"):n.isPPU&&400===t.status?e("ppu"):n.isGating?e("gatingSubflow"):void e()},results:{ppu:"ppuSubflow",createSession:"createSession",gatingSubflow:"gatingSubflow"}}},{ppuSubflow:{stepExecution:function(e){const t=Vt("redeemResponse")||{};return v(mr,(()=>{N(mr),e()})),Re.then((e=>{e.call("inner","runWorkflow",{apiCallback:{name:mr},name:No,step:"ppuSubflow",guest:t.data,workflowData:{parsedErrors:t.parsedErrors,ppu:{errors:t.error.errors}}}).then((()=>{Rn.showLightbox()}))}))},results:{}}},{createSession:{stepExecution:function(e){const t=Vt("redeemResponse").data;if(t)return Ro(t).then((()=>{Ft("redeemSuccess",!0),e()})).catch((t=>{const n=(0,u.U2)(t,"message")||"";s.error(`Error in session-transfer create session call: ${n}`),e("error")}))},results:{error:"parseErrors"}}},{gatingSubflow:{stepExecution:function(e){const t=Vt("redeemResponse")||{};return v(mr,(()=>{N(mr),e()})),Re.then((e=>{e.call("inner","runWorkflow",{apiCallback:{name:mr},name:No,step:"gatingSubflow",guest:t.data,workflowData:{parsedErrors:t.parsedErrors,ppu:{errors:t.error.errors}}}).then((()=>{Rn.showLightbox()}))}))},results:{}}}]};function Ir({name:e,step:t=null,workflowOptions:n=null,onComplete:o=null,persistWorkflowOptions:r=!1}){n&&Ft("workflowOptions",n);new qe(e,yr[e],t,(()=>{r||Mt("workflowOptions"),o&&o()})).runWorkflow()}const Rr={LOCAL:"https://qa.registerdisney.go.com/jgc/v8",DEV:"https://qa.registerdisney.go.com/jgc/v8",QA:"https://qa.registerdisney.go.com/jgc/v8",STAGE:"https://stg.registerdisney.go.com/jgc/v8",VALID:"https://val.registerdisney.go.com/jgc/v8",PROD:"https://registerdisney.go.com/jgc/v8"};let wr;function Or(){Ft("sessionTimerPaused",!0),clearTimeout(wr)}function Tr(e){Ft("sessionTimerPaused",!1),Ft("loggedIn",e),Ar()}function Ar(){clearTimeout(wr),Ft("wasLoggedIn",Vt("loggedIn")||!1),Ir({name:"SESSION_STATE_TASKS",onComplete:()=>{wr=setTimeout(Ar,$e)},persistWorkflowOptions:!0})}var vr=n(486),Nr=n.n(vr);let Cr,kr,Sr;function br(e=""){s.debug(`api/init: innerVersion "${e}"`),s.debug(`api/init: window.ONEID_WEB_SDK_VERSION "${window.ONEID_WEB_SDK_VERSION}"`),e!==window.ONEID_WEB_SDK_VERSION&&rt({[We.ACTION_NAME]:We.LOG_VERSION_MISMATCH,[We.INFO]:`outer(${window.ONEID_WEB_SDK_VERSION}),inner(${e})`}),Sr=!0,kr()}function Pr(){return Sr}function Lr(){if(Sr){if(at(Qn,Qt),window.ONEID_WEB_SDK_MIGRATION){const e=Nr().defer();return e.reject(Qt),e.promise}return Promise.reject(Qt)}et({conversationId:(0,u.Vj)()});const e=nt(We.API_INIT),t=vn(9e4),n=function(){const e=new Promise((e=>{const t=Rn.createInner();t.onload=()=>{e(t)}})),t=new Promise((e=>{const t=Rn.createResponder();t.onload=()=>{e(t)}}));return Promise.all([e,t])}().then(Dr).then(Ur),o=Promise.race([n,t]).then((()=>new Promise((n=>{((0,u.U2)(F(),"debug")||{}).tealiumDebug&&Re.then((e=>e.message("inner","turnOnDebugTealiumTracking")));const o=be()||"PROD",r=F()||{},{clientId:i}=r,a=r.langPref;var c;c={clientId:`${i}-${o}`,endpoint:Rr[o],language:a},Wt={...Wt,...c},Ir({name:"INITIALIZATION",onComplete:function(){t.cancel(),s.debug("OneID initialization complete"),e.send();const o=Vt("guest"),r={loggedIn:!!(o||{}).token,guest:o||null};var i;at(Zn,r),jt(),i=r.loggedIn,s.log("SessionTimer#startTimer"),Ft("loggedIn",i),Ar(),r.loggedIn&&dr(),n(r)}.bind(this)})})))).catch((({errorCodes:t,errorCategory:n})=>(e.send({[We.ERROR_CATEGORY]:n||En,[We.ERROR_CODES]:t||pn}),at(Qn,`${pn}: ${t}`),Promise.reject(`${pn}: ${t}`))));if(window.ONEID_WEB_SDK_MIGRATION){const e=Nr().defer();return o.then((t=>e.resolve(t))).catch((t=>e.reject(t))),e.promise}return o}function Dr([e,t]=frames){return new Promise(((n,o)=>{const r={frames:{outer:{window,origin:window.origin||window.location&&window.location.origin,channels:["inner","responder"]},inner:{window:e.contentWindow,origin:new URL(e.src).origin,channels:["outer","responder"]},responder:{window:t.contentWindow,origin:new URL(t.src).origin,channels:["inner","outer"]}}};Promise.all([_e(r),Re]).then((()=>{s.debug("Cross frame communication initialized"),n()})).catch((()=>o({errorCodes:Xt})))}))}function Ur(){return Cr}Cr=new Promise((e=>kr=e)),Sr=!1;const Gr={doNotDisturb:Xr({preConditions:[qr],method:function([e]){if("boolean"!==typeof e)return Promise.reject({errorCodes:tn});return lo(e),Promise.resolve()},actionName:We.API_SET_DO_NOT_DISTURB,logInfoKey:"flag"}),forceTokenRefresh:Xr({preConditions:[qr,jr],method:function([e]){Mt("tokenRefreshResponse"),et(e);const t=On(),n=new Promise((e=>{Ir({name:"TOKEN_REFRESH",step:"forceRefresh",onComplete:()=>{const t=Vt("tokenRefreshResponse"),n=(0,u.U2)(t,"data.token"),o=(0,u.U2)(t,"error.keyCategory")||"",r=[];((0,u.U2)(t,"error.errors")||[]).forEach((e=>{r.includes(e.code)||r.push(e.code)})),Mt("tokenRefreshResponse"),e({errorCategory:o,errorCodes:r,newTokens:n})}})}));return Promise.race([n,t]).then((({errorCategory:e,errorCodes:n,newTokens:o})=>(t.cancel(),o?Promise.resolve(o):e||n.length?Promise.reject({errorCategory:e,errorCodes:n.join(",")}):(rt({[We.ACTION_NAME]:We.LOG_APPLICATION_ERROR,[We.ERROR_CATEGORY]:En,[We.INFO]:"api(forceTokenRefresh),data(missing_tokens,no_errors)"}),Promise.reject({errorCategory:En,errorCodes:_n})))))},actionName:We.API_FORCE_TOKEN_REFRESH}),getEditableProfileFields:Xr({preConditions:[qr,jr],method:function([e]){et(e);const t=On(),n=An().then(Gn).then((t=>t.profile&&0===Object.keys(t.profile).length?Promise.reject({errorCodes:cn}):new Promise((n=>{Ir({name:"GET_EDITABLE_AND_REQUIRED_FIELDS",workflowOptions:Nn(e,t),onComplete:n})})))).then((()=>{const e=Vt("editableFields");return e.error_codes&&e.error_codes.length>0?Promise.reject({errorCodes:e.error_codes}):Promise.resolve()}));return Promise.race([n,t]).then((()=>{t.cancel();const e=Vt("editableFields");return Promise.resolve(e)}))},actionName:We.API_GET_PPC}),getGuest:Xr({preConditions:[qr,jr],method:function(e){const[t=!1,n={}]=e,o=!0===t;et(n);const r=On(),s=An().then((()=>new Promise(((e,t)=>{const r={forceRefresh:(0,u.U2)(n,"forceRefresh")||!1,fullPayloadRequested:!!o};Ir({name:"GET_GUEST",workflowOptions:Nn(n,r),onComplete:()=>{const n=Vt("getGuestResponse");if(Mt("getGuestResponse"),n){const o=(0,u.U2)(n,"error.keyCategory")||"FAILURE_BY_DESIGN";let s=[];return(0,u.U2)(n,"error.errors")&&(0,u.U2)(n,"error.errors").forEach((function(e){-1===s.indexOf(e.code)&&s.push(e.code)})),s=s.length?s.join(","):"UNABLE_TO_RETRIEVE_GUEST_DATA",r.localCopyReturned=!1,Vt("logoutType")?t({errorCodes:s,errorCategory:o,[We.INFO]:r}):(0,u.U2)(n,"data.profile")?e(Vt("guest")||null):t({errorCodes:s,errorCategory:o,[We.INFO]:r})}e(Vt("guest")||null)}})}))));return Promise.race([s,r]).then((e=>(r.cancel(),Promise.resolve(e))))},actionName:We.API_GET_GUEST_DATA,logInfoKey:"fullPayload"}),getGuestNewsletters:Xr({preConditions:[qr,jr],method:function([e]){et(e);const t=On(),n=Gn().then((e=>(0,u.U2)(e,"marketing")||null));return Promise.race([n,t]).then((e=>(t.cancel(),Promise.resolve(e))))},actionName:We.API_GET_GUEST_NEWSLETTERS}),getInlineNewsletters:Xr({preConditions:[qr],method:function(e){const[t,n]=e;et(n);const o=On(),r=ct().then((e=>e?Tn(e,t)?Promise.resolve():Promise.reject({errorCodes:dn}):Promise.reject({errorCodes:ln}))).then((()=>new Promise((e=>{Ft("promotionID",t),Ir({name:"GET_INLINE_NEWSLETTERS",workflowOptions:Nn(n),onComplete:e})})))).then((()=>{const e=Vt("responsePayload");return e.error_codes&&e.error_codes.length>0?Promise.reject({errorCodes:e.error_codes}):Promise.resolve()})).finally((()=>{Mt("promotionID")}));return Promise.race([r,o]).then((()=>{o.cancel();const e=Vt("responsePayload");return Promise.resolve(e)}))},actionName:We.API_GET_INLINE_NEWSLETTERS,logInfoKey:"promotionId"}),getTrustStateStatus:Xr({preConditions:[qr,jr],method:function([e]){et(e);const t=On();let n;const o=_o().then((({state:e})=>n=e));return Promise.race([o,t]).then((()=>(t.cancel(),Promise.resolve(n))))},actionName:We.API_GET_TRUST_STATE_STATUS}),init:Lr,getConfig:function(){return xr},getLicensePlateDataBag:Xr({preConditions:[qr],method:function([e={},t]){et(t);const{pairingCode:n=""}=e;if(!n||0===n.length)return Promise.reject({errorCodes:on});return Ft("workflowOptions",Nn(t)),mn(n)},actionName:We.API_GET_LICENSE_PLATE_DATA_BAG}),getLoggedInStatus:Xr({preConditions:[()=>Cr],method:Wr,actionName:We.API_GET_LOGGED_IN_STATUS}),launchEmailVerification:Xr({preConditions:[qr,jr],method:function([e]){return et(e),new Promise(((t,n)=>{const o="EMAIL_ALREADY_VERIFIED";An().then(Gn).then((t=>{if(t.profile.emailVerified)throw new Error(o);return Re.then((n=>n.call("inner","runWorkflow",{apiCallback:{name:hr},guest:t,name:Oo,workflowOptions:Nn(e)})))})).then((()=>{v(hr,(({errorCategory:e,errorCodes:o,wasSuccess:r})=>{N(hr),r?t():n({errorCategory:e,errorCodes:o})})),Rn.showLightbox()})).catch((e=>{N(hr),e.message!==o?n(new Error(_n)):t()}))}))},actionName:We.API_LAUNCH_EMAILVERIFICATION,newRelicFlowName:(0,u.hK)(Oo)}),launchGuestFlow:Xr({preConditions:[qr,Br],method:function([e,t]){et(t);const n=On(),o=new Promise((n=>{Ir({name:"GUEST_FLOW",workflowOptions:Nn(t,{guestFlowEmail:e}),onComplete:n})}));return Promise.race([o,n]).then((()=>{const e=`SUCCESS_LAUNCH_${Vt("guestFlowName")}_${Vt("guestFlowEmail")?"WITH":"WITH_OUT"}_EMAIL`;return n.cancel(),Mt("guestFlowCode"),Mt("guestFlowName"),Mt("guestFlowEmail"),Promise.resolve(e)}))},actionName:We.API_LAUNCH_GUESTFLOW}),launchIdentityFlow:Xr({preConditions:[qr,Br],method:function([e,t]){et(t);const n=On(),o=An().then((()=>{const n=Nn(t),o={name:Ao,workflowOptions:n,workflowData:{isIdentityFlow:!0}};return e&&(o.workflowData.loginValue=e,o.workflowData.skipPrompt=!0),Re.then((e=>e.call("inner","runWorkflow",o)))}));return Promise.race([o,n]).then((()=>(n.cancel(),Rn.showLightbox(),Promise.resolve())))},actionName:We.API_LAUNCH_IDENTITYFLOW,newRelicFlowName:(0,u.hK)(Ao)}),launchLicensePlate:Xr({preConditions:[qr],method:function([e={}]){et(e);const{pairingCode:t="",authenticationFlow:n,deviceName:o,isLicensePlateLaunched:r=!0,showSuccessScreen:s}=e;if(!t||0===t.length)return Promise.reject({errorCodes:on});return new Promise(((i,a)=>{Or(),An().then(Gn).then((i=>Re.then((a=>a.call("inner","runWorkflow",{apiCallback:{name:Er},guest:i,name:vo,workflowData:{authenticationFlow:n,deviceName:o,isLicensePlateLaunched:r,pairingCode:t,showSuccessScreen:s},workflowOptions:Nn(e)}))))).then((()=>{v(Er,(({errorCodes:e=vt,wasSuccess:t=!1})=>{if(N(Er),Wr().then((e=>Tr(e))),t)return i();a({errorCategory:St,errorCodes:e})})),Rn.showLightbox()})).catch((()=>{Wr().then((e=>Tr(e))),a(new Error(_n))}))}))},actionName:We.API_LAUNCH_LICENSE_PLATE,sendAfterPreconditions:!0,newRelicFlowName:(0,u.hK)(vo)}),launchLogin:Xr({preConditions:[qr,Br],method:function([e]){et(e);const t=On(),n=An().then((()=>{const t=Nn(e),n={name:No,workflowOptions:t},o=(0,u.U2)(e,"optionalConfigs.email");return o&&(n.workflowData={loginValue:o}),Re.then((e=>e.call("inner","runWorkflow",n)))}));return Promise.race([n,t]).then((()=>(t.cancel(),Rn.showLightbox(),Promise.resolve())))},actionName:We.API_LAUNCH_LOGIN,newRelicFlowName:(0,u.hK)(No)}),launchNewsletters:Xr({preConditions:[qr],method:function(e){const[t,n]=e;et(n);const o=On();let r;const s=Gn().then((e=>(r=e,ct()))).then((e=>e?Tn(e,t)?Promise.resolve(t):Promise.reject({errorCodes:tn}):Promise.reject({errorCodes:ln}))).then((e=>Re.then((t=>{const o=Nn(n,{promotionId:e});t.call("inner","runWorkflow",{guest:r,name:Co,workflowOptions:o})}))));return Promise.race([s,o]).then((()=>(o.cancel(),Rn.showLightbox(),Promise.resolve())))},actionName:We.API_LAUNCH_NEWSLETTERS,logInfoKey:"promotionId",newRelicFlowName:(0,u.hK)(Co)}),launchProfile:Xr({preConditions:[qr,jr],method:function([e]){et(e);const t=On(),n=Nn(e),o=An().then(Gn).then((e=>Re.then((t=>t.call("inner","runWorkflow",{guest:e,name:Po,workflowOptions:n})))));return Promise.race([o,t]).then((()=>(t.cancel(),Rn.showLightbox(),Promise.resolve())))},actionName:We.API_LAUNCH_PROFILE,newRelicFlowName:(0,u.hK)(Po)}),launchReauth:Xr({preConditions:[qr,jr],method:function([e]){return et(e),new Promise(((t,n)=>{An().then(Gn).then((t=>Re.then((n=>n.call("inner","runWorkflow",{apiCallback:{name:_r},guest:t,name:So,workflowOptions:Nn(e)}))))).then((()=>{v(_r,(({errorCodes:e=vt,wasSuccess:o=!1})=>{if(N(_r),o)return Mt("tokenData"),Gn().then((e=>t(e)));n({errorCategory:St,errorCodes:e})})),Rn.showLightbox()})).catch((()=>n(new Error(_n))))}))},actionName:We.API_LAUNCH_REAUTH,sendAfterPreconditions:!0,newRelicFlowName:(0,u.hK)(So)}),launchRegistration:Xr({preConditions:[qr,Br],method:Qr,actionName:We.API_LAUNCH_REGISTRATION,newRelicFlowName:(0,u.hK)(bo)}),logout:Xr({preConditions:[qr,Wr],method:function(){const{clientId:e}=F(),t=be(),n=On();pr(),Or();const o=Gn().then((n=>{jt();const o=(0,u.U2)(n,"profile.swid"),r=(0,u.U2)(n,"token");return Un(),o&&r?(qt().then((e=>{const{s2CookieName:t,s2Domain:n}=e,o=w.getCookieDomain();I(t,n,"/"),o&&I(t,o,"/")})),zn(o,r).then((()=>Re.then((n=>(n.message("inner","guest.logout"),Z((0,u.Vj)()),n.call("responder","guest.logout",`${e}-${t}`))))))):(rt({[We.ACTION_NAME]:We.LOG_MISSING_GUEST_DATA_ON_LOGOUT,[We.INFO]:`swid(${o?"present":"missing"}),tokens(${r?"present":"missing"})`}),Re.then((n=>(n.message("inner","guest.logout"),Z((0,u.Vj)()),n.call("responder","guest.logout",`${e}-${t}`)))))}));return Promise.race([o,n]).then((()=>(Tr(!1),n.cancel(),no(Mn),Promise.resolve())))},actionName:We.API_LOGOUT}),on:v,off:N,setEditableProfileFields:Xr({preConditions:[qr,jr],method:function(e){const[t,n]=e;if(et(n),0===e.length||t&&0===Object.keys(t).length)return Promise.reject({errorCodes:an});const o=/^phone\.mobile/;if(Object.keys(t).find((e=>o.test(e))))return Promise.reject({errorCodes:fn});const r=On(),s=An().then(Gn).then((e=>e.profile&&0===Object.keys(e.profile).length?Promise.reject({errorCodes:cn}):(Ft("workflowData",{guestData:t,guest:e}),new Promise((e=>{Ir({name:"SET_PPC",onComplete:e})}))))).then((()=>{const e=Vt("workflowErrors")||[];return e.length?Promise.reject({errorCodes:e[0].code}):Promise.resolve()}));return Promise.race([s,r]).then((()=>{r.cancel();const{guest:e}=Vt("workflowData");return Fn({guest:e,token:e.token},!0),{data:e}})).finally((()=>{Mt("workflowErrors")}))},actionName:We.API_SET_PPC}),setInlineNewsletters:Xr({preConditions:[qr],method:function(e){const[t,n]=e;if(et(n),!e||!t)return Promise.reject({errorCodes:an});const o=On(),r=ct().then((e=>e?Tn(e,t.campaignId)?new Promise((e=>{Ir({name:"SET_INLINE_NEWSLETTERS",workflowOptions:Nn(n,{buData:t}),onComplete:e})})):Promise.reject({errorCodes:jo}):Promise.reject({errorCodes:ln}))).then((()=>{const e=Vt("responsePayload");return e.error_codes&&e.error_codes.length>0?Promise.reject({errorCodes:e.error_codes}):Promise.resolve(e)}));return Promise.race([r,o]).then((()=>(o.cancel(),Promise.resolve())))},actionName:We.API_SET_INLINE_NEWSLETTERS}),redeemSessionTransferKey:Xr({preConditions:[qr,Br],method:function([e,t]){if(et(t),!e)return Promise.reject({errorCodes:tn});return new Promise(((n,o)=>{An().then((()=>{Ft("workflowData",{sessionTransferKey:e});Ir({name:"REDEEM_SESSION_TRANSFER",workflowOptions:Nn(t),onComplete:()=>{const e=Vt("redeemSuccess")||!1,t=Vt("redeemResponse");if(!(0,u.U2)(t,"data.profile")){const e=(0,u.U2)(t,"error.keyCategory")||En;let n=[];return(0,u.U2)(t,"error.errors")&&(0,u.U2)(t,"error.errors").forEach((function(e){n.includes(e.code)||n.push(e.code)})),n=n.length?n.join(","):vt,o({errorCategory:e,errorCodes:n})}if(e)return n({data:t.data});o({errorCategory:En,errorCodes:vt})}})})).catch((()=>{o(new Error(_n))}))}))},actionName:We.API_REDEEM_SESSION_TRANSFER,newRelicFlowName:(0,u.hK)(Lo)}),launchOTP:Xr({preConditions:[qr,jr],method:function([e,t,n=!0]){return et(t),new Promise(((o,r)=>{An().then((()=>Re.then((o=>o.call("inner","runWorkflow",{apiCallback:{name:gr},name:ko,step:"chooseOTPMethod",workflowData:{onDemandOTP:{reason:e,forceOTP:n}},workflowOptions:Nn(t)}))))).then((()=>{v(gr,(({errorCodes:e=vt,wasSuccess:t=!1,recoveryToken:n})=>{if(N(gr),t&&n)return o(n);r({errorCategory:St,errorCodes:e})})),Rn.showLightbox()})).catch((()=>{r(new Error(_n))}))}))},actionName:We.API_LAUNCH_OTP_ONDEMAND,newRelicFlowName:(0,u.hK)(Do)}),setLogLevel:function(t,n){if("string"!==typeof t||!e[t.toUpperCase()])return void s.warn(tn);const o=e[t.toUpperCase()];i(o),Re.then((e=>e.broadcast("config.setLogLevel",o))),n&&o!==e.OFF?R(_,t,null,"/"):n&&o!==e.OFF||I(_,null,"/")}};let xr;const $r={get:Hr},Fr={get:(Vr=Hr,Mr=Jt,"function"===typeof Vr?function(...e){return s.warn(Mr),Vr.apply(this,e)}:Vr)};var Vr,Mr;function jr(){return new Promise(((e,t)=>{Wr().then((n=>{if(n)return e();t({errorCategory:En,errorCodes:gn})}))}))}function Br(){return new Promise(((e,t)=>{Wr().then((n=>{if(!n)return e();t({errorCategory:En,errorCodes:hn})}))}))}function qr(){return new Promise(((e,t)=>{if(Pr())return e();t({errorCategory:En,errorCodes:pn})}))}function Wr(){return Ve().then((e=>!!e&&!he(e))).catch((()=>!1))}function Kr(e){return"string"!==typeof e||!e.length}function Hr(e){s.debug("JS SDK get() was called with the following configuration:",e);const t=!!F(),n=(0,u.d9)(e),o=[];if(n&&t)throw new Error(Zt);if(!t){if(!n||!Object.keys(n).length)throw new Error(sn);if(!n.clientId||"string"!==typeof n.clientId)throw new Error(rn);if(!n.responderPage)throw new Error(un);let e="";try{e=new URL(n.responderPage)}catch(e){throw new Error(`${tn}: responderPage`)}const t=(0,u.KT)(window.location.hostname),c=(0,u.KT)(e.hostname);t!==c&&(s.warn("responder page domain does not match the top window domain. responder domain:",c),o.push("responderPage")),n.hasOwnProperty("langPref")&&(Kr(a=n.langPref)||!f.test(a))&&(s.warn("invalid config.langPref passed to get(config) - it is being ignored."),o.push("langPref"),delete n.langPref),n.hasOwnProperty("cssOverride")&&("string"!==typeof(i=n.cssOverride)||!i.startsWith("http")&&0!==i.length)&&(s.warn("invalid config.cssOverride passed to get(config) - it is being ignored."),o.push("cssOverride"),delete n.cssOverride),n.hasOwnProperty("experience")&&(Kr(r=n.experience)||!/^[A-Z0-9.\-_]+.EXP$/.test(r))&&(s.warn("invalid config.experience passed to get(config) - it is being ignored."),o.push("experience"),delete n.experience),g.test(n.clientId)&&(s.warn("passing environment as part of the Client ID is deprecated - it is being ignored."),o.push("clientId"),n.clientId=n.clientId.replace(g,"")),function(e){x=(0,u._A)((0,u.d9)({...$,...e}))}(n),xr=(0,u._A)((0,u.d9)(n)),function(e){let t=(0,u.U2)(e,"optionalConfigs.reporting"),n=(0,u.U2)(e,"experience");t&&!st(t)&&(s.warn("optionalConfigs.reporting does not pass validation, values will be ignored"),t=null),n&&!it(n)&&(s.warn("experience does not pass validation, values will be ignored"),n=null),(t||n)&&(Qe={reporting:t,...n&&{experience:n}})}(xr),n.initialize&&Lr(),o.length&&rt({[We.ACTION_NAME]:We.LOG_INVALID_OID_CONFIG,[We.INFO]:o.join(",")})}var r,i,a;window.ONEID_WEB_SDK_MIGRATION&&(Gr.launchSocialRegistration=Xr({preConditions:[qr,Br],method:Qr,actionName:We.API_LAUNCH_SOCIAL_REGISTRATION}),Gr.getInlineNewsletters=Yr,Gr.setInlineNewsletters=zr);const c=(0,u.d9)(Gr),{clientId:l}=F(),d=(0,u.U2)(F(),"debug.launchOTPEnabled")||!1;return s.debug(`Is LaunchOTP Enabled ${d} for client-id ${l}?`),d||delete c.launchOTP,v(Qn,(e=>s.error(e))),c}function Yr(e,t){const n=nt(We.API_GET_INLINE_NEWSLETTERS),o=`promotionId(${e})`;if(et(t),!Pr())return n.send({[We.ERROR_CATEGORY]:En,[We.ERROR_CODES]:pn,[We.INFO]:o}),at(Qn,pn),Promise.reject({data:{},error_codes:pn});const r=Jr(n,o,en),s=ct().then((t=>t?Tn(t,e)?Promise.resolve():(n.send({[We.ERROR_CATEGORY]:En,[We.ERROR_CODES]:dn,[We.INFO]:o}),at(Qn,dn),Promise.reject({data:{},error_codes:jo})):(n.send({[We.ERROR_CATEGORY]:En,[We.ERROR_CODES]:ln,[We.INFO]:o}),at(Qn,ln),Promise.reject({data:{},error_codes:ln})))).then((()=>new Promise((n=>{Ir({name:"GET_INLINE_NEWSLETTERS",workflowOptions:Nn(t,{promotionId:e}),onComplete:n})})))).then((()=>{const e=Vt("responsePayload");return e.error_codes&&e.error_codes.length>0?(n.send({[We.ERROR_CATEGORY]:En,[We.ERROR_CODES]:e.error_codes,[We.INFO]:o}),at(Qn,e.error_codes),e.data={},Promise.reject(e)):Promise.resolve()}));return Promise.race([s,r]).then((()=>{r.cancel(),n.send({[We.INFO]:o});const e=Vt("responsePayload");return Promise.resolve(e)}))}function zr(e,t){const n=nt(We.API_SET_INLINE_NEWSLETTERS);if(et(t),!Pr())return n.send({[We.ERROR_CATEGORY]:En,[We.ERROR_CODES]:pn}),at(Qn,pn),Promise.reject({data:{},error_codes:pn});if(!e)return n.send({[We.ERROR_CATEGORY]:En,[We.ERROR_CODES]:an}),at(Qn,an),Promise.reject({data:{},error_codes:Mo});const o=Jr(n,void 0,{data:{},error_codes:en}),r=ct().then((t=>t?Tn(t,e.campaignId)?Promise.resolve():(n.send({[We.ERROR_CATEGORY]:En,[We.ERROR_CODES]:jo}),Promise.reject({data:{},error_codes:jo})):(n.send({[We.ERROR_CATEGORY]:En,[We.ERROR_CODES]:ln}),at(Qn,ln),Promise.reject({data:{},error_codes:ln})))).then((()=>new Promise((n=>{Ir({name:"SET_INLINE_NEWSLETTERS",workflowOptions:Nn(t,{buData:e}),onComplete:n})})))).then((()=>{const e=Vt("responsePayload");return e.error_codes&&e.error_codes.length>0?(n.send({[We.ERROR_CATEGORY]:En,[We.ERROR_CODES]:e.error_codes}),at(Qn,e.error_codes),Promise.reject(e)):Promise.resolve(e)}));return Promise.race([r,o]).then((()=>{o.cancel();const e=Vt("responsePayload");return Promise.resolve(e)}))}function Qr(e){const[t]=e;et(t);const n=On(),o=Nn(t),r={name:bo,workflowOptions:o},s=(0,u.U2)(t,"optionalConfigs.providedProfile");s&&(r.guestChanges={profile:s});const i=An().then((()=>Re.then((e=>{e.call("inner","runWorkflow",r)}))));return Promise.race([i,n]).then((()=>(n.cancel(),Rn.showLightbox(),Promise.resolve())))}function Zr(e){return(0,e[0])().then((()=>{if(e.shift(),e.length)return Zr(e)}))}function Xr({preConditions:e=[()=>Promise.resolve()],method:t,actionName:n,newRelicFlowName:o,logInfoKey:r="",sendAfterPreconditions:s=!1}){return(...i)=>{const a=nt(n),c={};o&&(c[We.FLOW]=o),r&&(c[We.INFO]=`${r}(${i[0]})`);const l=new Promise(((n,o)=>{Zr((0,u.d9)(e)).then((()=>{s&&a.send(c),t(i).then((e=>{s||a.send(c),n(e)})).catch((({errorCategory:e,errorCodes:t})=>{s||a.send({[We.ERROR_CATEGORY]:e||En,[We.ERROR_CODES]:t,...c}),at(Qn,t),o(t)}))})).catch((({errorCategory:e,errorCodes:t})=>{a.send({[We.ERROR_CATEGORY]:e,[We.ERROR_CODES]:t,...c}),at(Qn,t),o(t)}))}));if(window.ONEID_WEB_SDK_MIGRATION){const e=Nr().defer();return l.then((t=>e.resolve(t))).catch((t=>e.reject(t))),e.promise}return l}}function Jr(e,t,n){let o;const r=new Promise(((r,s)=>{o=setTimeout((()=>{const o={[We.ERROR_CATEGORY]:En,[We.ERROR_CODES]:en};t&&(o[We.INFO]=t),e.send(o),s(n)}),Le)}));return r.cancel=()=>(clearTimeout(o),this),r}function es(e){if(!e)return null;const t=localStorage.getItem(e);try{const n=JSON.parse(t);if(!n._expiry)return n;const o=new Date(n._expiry);if(delete n._expiry,o>new Date)return n;localStorage.removeItem(e)}catch(e){return t}}function ts({key:e,value:t,expires:n}){const o=JSON.stringify({...t,_expiry:n},function(){const e=new Map;return(t,n)=>n?"object"!==typeof n?n:e.has(n)?void 0:(e.set(n,!0),n):n}());localStorage.setItem(e,o)}function ns(){Ft("loggedIn",!0),dr()}function os(){Ft("loggedIn",!1)}function rs({key:e,value:t,expires:n,secure:o=!1}){R(e,t,w.getCookieDomain(),"/",n,o)}window.ONEID_WEB_SDK_VERSION="4.2.110",window.ONEID_WEB_SDK_MIGRATION=!1,i(e[y(_)]||e.INFO),s.debug("MOUI (outer) initializing..."),Re.then((e=>{e.addHandler("ui.hideLightbox",Rn.hideLightbox),e.addHandler("ui.showLightbox",Rn.showLightbox),e.addHandler("init.setInitialized",br),e.addHandler("get.localStorage",es),e.addHandler("set.localStorage",ts),e.addHandler("get.cookie",y),e.addHandler("set.cookie",rs),e.addHandler("newRelic.send",(e=>{rt({...e,...He})})),e.addHandler("api.callback",(e=>{const{name:t,...n}=e;C(t,n)})),e.addHandler("api.emitEvent",(({eventName:e,eventPayload:t,additionalInfo:n})=>at(e,t,n))),e.addHandler("guest.write",(e=>Fn(e,!0))),e.addHandler("guest.read",Gn),e.addHandler("session.loggedIn",ns),e.addHandler("session.loggedOut",os),e.addHandler("set.s2cookie",Bt)})),window.OneID||(window.OneID=$r),window.DisneyID||(window.DisneyID=Fr),function(e="outer"){const t="outer"===e?(document.querySelector('script[src*="/OneID.js"]')||document.querySelector('script[src*="/OneIDMigrate.js"]')||document.querySelector('script[src*="/DisneyID.js"]')||{}).src:window.location.href,n=!!document.querySelector('script[src*="/DisneyID.js"]'),{href:o,host:r}=new URL(t);Se=n?"outer"===e?o.replace(/^(.*)\/v2\/outer\/DisneyID\.js(?:.+)?/,"$1/v4"):o.split("/bundle")[0]:"outer"===e?o.replace(/^(.*)\/OneID(?:Migrate)?\.js/,"$1"):o.split("/bundle")[0],Oe.test(r.toLowerCase())?ke=Ne:Te.test(r.toLowerCase())?ke=ve:Ae.test(r.toLowerCase())&&(ke=Ce)}()})()})();