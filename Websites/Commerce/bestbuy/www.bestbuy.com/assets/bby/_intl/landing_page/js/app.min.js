var buildUSLink=function(){var n=window.location.href;n.match(/\?/)?window.location.search?n+="&intl=nosplash":n+="intl=nosplash":n+="?intl=nosplash",$(".us-link").attr("href",n),$(".us-link").on("click",function(){window.location.href=n})},languageMenu=function(){var n=navigator.language.substring(0,2),a="en";a="fr"===n?"fr":"es"===n?"es":"en";var e=function(n){$(".language-menu button").removeClass("is-active"),$('.language-menu button[lang="'+n+'"]').addClass("is-active"),$(".content [lang]").addClass("hidden"),$('.content [lang="'+n+'"]').removeClass("hidden")};$(".language-menu").on("click","button",function(){a=$(this).prop("lang"),e(a),buildCanadaLink()}),e(a)},countrySelection=function(){$(".country-selection").on("click","a",function(){!function(n,a,e){var t=new Date;t.setTime(t.getTime()+24*e*60*60*1e3);var i="expires="+t.toUTCString();document.cookie=n+"="+a+";"+i+";path=/"}("intl_splash",!1,3)})},getRedirectJson=async function(){try{const n=await fetch("https://www.bestbuy.ca/bbyus-redirect-map/map.json");return await n.json().then(n=>n)}catch(n){return console.log(`There was an error with the fetch ${error}`),[]}},buildCanadaLink=async function(){const n=await getRedirectJson(),a="fr"===$(".language-menu .is-active")[0].lang?"fr":"en",e="fr"===a?"caFrPage":"caEnPage",t="https://www.bestbuy.ca/"+a+"-CA/home.aspx",i=document.referrer,o=window.location.href,r="?intlreferer="+i+"&intlredir="+o;let c;const l=n.findIndex(n=>n.usPage===o);l>-1?(c=n[l][e]+r,$(".canada-link").attr("href",c)):$(".canada-link").attr("href",t+r)};window.onload=function(){languageMenu(),countrySelection(),buildUSLink(),buildCanadaLink()};